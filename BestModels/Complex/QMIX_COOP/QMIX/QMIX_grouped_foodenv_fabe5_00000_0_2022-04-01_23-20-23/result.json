{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 25.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 60.0, 30.0, 0.0, 60.0, 0.0, 0.0, 30.0, 60.0, -30.0, 0.0, 30.0, 90.0, 30.0, 60.0, 0.0, 30.0, -30.0, 0.0, 60.0, 0.0, 30.0, -30.0, 30.0, -30.0, 60.0, 30.0, 30.0, 60.0, 30.0, 0.0, 30.0, 0.0, 60.0, 0.0, 30.0, 60.0, 0.0, 30.0, 30.0, 60.0, 0.0, 0.0, 0.0, 60.0, 30.0, 60.0, -30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 30.0, 120.0, 0.0, 0.0, 30.0, 0.0, 0.0, 30.0, 0.0, 60.0, 30.0, 30.0, 90.0, 0.0, 0.0, 30.0, 0.0, 60.0, 30.0, -30.0, 30.0, -30.0, 30.0, 0.0, 60.0, 30.0, 30.0, 30.0, 60.0, 60.0, 0.0, 0.0, 30.0, 30.0, -30.0, 0.0, 0.0, 60.0, 30.0, 30.0, 60.0, 30.0, 0.0, 30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7604225223282893, "mean_inference_ms": 56.695386708020195, "mean_action_processing_ms": 0.2383167050274244, "mean_env_wait_ms": 0.16844391347877533, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1000, "timesteps_this_iter": 40, "agent_timesteps_total": 1000, "timers": {"sample_time_ms": 3439.913, "sample_throughput": 11.628, "learn_time_ms": 2586.323, "learn_throughput": 15.466, "update_time_ms": 46.76}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 16.235393524169922, "grad_norm": 81.64793395996094, "td_error_abs": 2.854365030924479, "q_taken_mean": 5.323664855957031, "target_mean": 5.657325744628906}}}, "num_steps_sampled": 1000, "num_agent_steps_sampled": 1000, "num_steps_trained": 1000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 520, "num_target_updates": 1}, "done": false, "episodes_total": 100, "training_iteration": 1, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-21-57", "timestamp": 1648880517, "time_this_iter_s": 85.13441681861877, "time_total_s": 85.13441681861877, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 85.13441681861877, "timesteps_since_restore": 40, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.228688524590165, "ram_util_percent": 56.88852459016394}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 30.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 0.0, 60.0, -30.0, 0.0, 60.0, 30.0, 60.0, 30.0, 90.0, 0.0, 0.0, 60.0, 0.0, -30.0, 60.0, 60.0, 60.0, 30.0, 0.0, 60.0, 30.0, 0.0, 0.0, 0.0, 0.0, 90.0, 30.0, 30.0, 60.0, 30.0, 0.0, 0.0, 0.0, -30.0, 60.0, 90.0, 0.0, 60.0, 30.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 0.0, 30.0, 30.0, 30.0, 90.0, 30.0, 30.0, 30.0, 0.0, 60.0, 30.0, 60.0, 60.0, 0.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 0.0, -30.0, 30.0, 30.0, 30.0, 0.0, 0.0, -30.0, 120.0, 30.0, 30.0, 30.0, 0.0, 60.0, 0.0, 30.0, 90.0, 60.0, 30.0, 30.0, 30.0, 0.0, 0.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 0.0, 30.0, 30.0, 30.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7514068466460634, "mean_inference_ms": 57.317090843490014, "mean_action_processing_ms": 0.24105498414791515, "mean_env_wait_ms": 0.16988204148953068, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2000, "timesteps_this_iter": 40, "agent_timesteps_total": 2000, "timers": {"sample_time_ms": 3371.692, "sample_throughput": 11.863, "learn_time_ms": 2515.359, "learn_throughput": 15.902, "update_time_ms": 44.533}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 26.31475067138672, "grad_norm": 229.2081756591797, "td_error_abs": 4.102334849039713, "q_taken_mean": 13.424791463216145, "target_mean": 12.141133626302084}}}, "num_steps_sampled": 2000, "num_agent_steps_sampled": 2000, "num_steps_trained": 2000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 1560, "num_target_updates": 3}, "done": false, "episodes_total": 200, "training_iteration": 2, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-23-22", "timestamp": 1648880602, "time_this_iter_s": 84.80073475837708, "time_total_s": 169.93515157699585, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 169.93515157699585, "timesteps_since_restore": 80, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.297520661157026, "ram_util_percent": 57.34793388429752}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 28.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 60.0, 0.0, 60.0, 0.0, 30.0, 0.0, 0.0, 60.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 60.0, 30.0, 30.0, 60.0, 0.0, 90.0, 0.0, -30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 0.0, 60.0, 30.0, 30.0, 30.0, 0.0, 30.0, -30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 30.0, 0.0, 0.0, 60.0, 30.0, 0.0, 60.0, 30.0, 0.0, 60.0, 0.0, 60.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 60.0, 30.0, 0.0, 30.0, 60.0, 60.0, 30.0, 30.0, 30.0, 0.0, 60.0, 30.0, 90.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7472413675127908, "mean_inference_ms": 56.978556430450936, "mean_action_processing_ms": 0.23958217923079278, "mean_env_wait_ms": 0.16929290583543227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3000, "timesteps_this_iter": 40, "agent_timesteps_total": 3000, "timers": {"sample_time_ms": 3385.882, "sample_throughput": 11.814, "learn_time_ms": 2521.757, "learn_throughput": 15.862, "update_time_ms": 44.331}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 18.48719024658203, "grad_norm": 252.6947479248047, "td_error_abs": 3.4386472066243488, "q_taken_mean": 12.896193440755209, "target_mean": 15.374329630533854}}}, "num_steps_sampled": 3000, "num_agent_steps_sampled": 3000, "num_steps_trained": 3000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 2600, "num_target_updates": 5}, "done": false, "episodes_total": 300, "training_iteration": 3, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-24-47", "timestamp": 1648880687, "time_this_iter_s": 84.59144830703735, "time_total_s": 254.5265998840332, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 254.5265998840332, "timesteps_since_restore": 120, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.195833333333333, "ram_util_percent": 57.65833333333333}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 26.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 60.0, 0.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, 30.0, 0.0, 30.0, -30.0, 60.0, 0.0, 0.0, 30.0, 60.0, 30.0, 0.0, 30.0, 0.0, 120.0, 90.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 0.0, -30.0, -30.0, 30.0, 60.0, 90.0, 30.0, 30.0, 30.0, 30.0, 60.0, 0.0, 30.0, 30.0, -30.0, 30.0, 60.0, 60.0, 90.0, 30.0, 30.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 30.0, 60.0, 30.0, 30.0, -30.0, 30.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 0.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 30.0, 0.0, 0.0, 30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7531018881173762, "mean_inference_ms": 57.23491998819205, "mean_action_processing_ms": 0.24028186436061502, "mean_env_wait_ms": 0.17036889101956398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 4000, "timesteps_this_iter": 40, "agent_timesteps_total": 4000, "timers": {"sample_time_ms": 3380.841, "sample_throughput": 11.831, "learn_time_ms": 2519.125, "learn_throughput": 15.879, "update_time_ms": 44.812}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 17.355670928955078, "grad_norm": 257.39056396484375, "td_error_abs": 3.2822840372721354, "q_taken_mean": 13.726832071940104, "target_mean": 11.480397542317709}}}, "num_steps_sampled": 4000, "num_agent_steps_sampled": 4000, "num_steps_trained": 4000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 3640, "num_target_updates": 7}, "done": false, "episodes_total": 400, "training_iteration": 4, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-26-11", "timestamp": 1648880771, "time_this_iter_s": 84.18830609321594, "time_total_s": 338.71490597724915, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 338.71490597724915, "timesteps_since_restore": 160, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.201666666666664, "ram_util_percent": 57.955}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 28.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 60.0, 30.0, 30.0, 0.0, 0.0, 90.0, 90.0, 60.0, -30.0, 60.0, 30.0, 30.0, 60.0, 0.0, 60.0, 60.0, 90.0, 30.0, 60.0, 30.0, 60.0, -30.0, 90.0, 30.0, 60.0, 90.0, 30.0, 0.0, 0.0, 30.0, 30.0, 30.0, 60.0, 0.0, 30.0, 0.0, 30.0, 30.0, 60.0, 0.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 30.0, 0.0, 0.0, 0.0, -30.0, 0.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 0.0, 30.0, 30.0, -30.0, 60.0, 60.0, 30.0, 30.0, 30.0, 0.0, 30.0, 30.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 0.0, 30.0, -30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 0.0, 60.0, 30.0, 90.0, 60.0, 0.0, 60.0, 30.0, 0.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7539286697320605, "mean_inference_ms": 57.36737804923605, "mean_action_processing_ms": 0.24051484253576136, "mean_env_wait_ms": 0.1709394508319126, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 5000, "timesteps_this_iter": 40, "agent_timesteps_total": 5000, "timers": {"sample_time_ms": 3414.311, "sample_throughput": 11.715, "learn_time_ms": 2565.771, "learn_throughput": 15.59, "update_time_ms": 44.182}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 44.86872863769531, "grad_norm": 257.86431884765625, "td_error_abs": 4.402690124511719, "q_taken_mean": 13.883978271484375, "target_mean": 15.405753580729167}}}, "num_steps_sampled": 5000, "num_agent_steps_sampled": 5000, "num_steps_trained": 5000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 4680, "num_target_updates": 9}, "done": false, "episodes_total": 500, "training_iteration": 5, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-27-36", "timestamp": 1648880856, "time_this_iter_s": 84.61262369155884, "time_total_s": 423.327529668808, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 423.327529668808, "timesteps_since_restore": 200, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.23471074380165, "ram_util_percent": 58.17933884297521}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 27.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 60.0, 30.0, 0.0, 60.0, -30.0, 60.0, 60.0, 0.0, 0.0, 0.0, 30.0, 60.0, 30.0, 60.0, 30.0, 30.0, 30.0, 0.0, 30.0, 60.0, 60.0, 30.0, 0.0, 0.0, 60.0, 0.0, 60.0, 0.0, 30.0, 0.0, 60.0, 0.0, 30.0, 0.0, 30.0, 60.0, 0.0, 60.0, 0.0, 60.0, 30.0, 0.0, 0.0, 30.0, 60.0, 60.0, 30.0, -30.0, 0.0, 30.0, 0.0, 30.0, 30.0, 0.0, 60.0, 30.0, 60.0, 60.0, 30.0, 0.0, 90.0, 60.0, 60.0, 30.0, 30.0, 60.0, 0.0, 60.0, 60.0, 30.0, 0.0, 60.0, 0.0, 30.0, -30.0, -30.0, 60.0, 30.0, 30.0, 0.0, 30.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 60.0, 0.0, 0.0, 0.0, 60.0, 30.0, 0.0, 30.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7542448787193632, "mean_inference_ms": 57.419226735055965, "mean_action_processing_ms": 0.2403363714529465, "mean_env_wait_ms": 0.17073565844612706, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 6000, "timesteps_this_iter": 40, "agent_timesteps_total": 6000, "timers": {"sample_time_ms": 3373.19, "sample_throughput": 11.858, "learn_time_ms": 2496.989, "learn_throughput": 16.019, "update_time_ms": 44.908}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 34.59589767456055, "grad_norm": 353.0322265625, "td_error_abs": 4.323087565104166, "q_taken_mean": 20.98795166015625, "target_mean": 18.925443522135417}}}, "num_steps_sampled": 6000, "num_agent_steps_sampled": 6000, "num_steps_trained": 6000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 5720, "num_target_updates": 11}, "done": false, "episodes_total": 600, "training_iteration": 6, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-29-00", "timestamp": 1648880940, "time_this_iter_s": 84.6220269203186, "time_total_s": 507.9495565891266, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 507.9495565891266, "timesteps_since_restore": 240, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 23.388429752066116, "ram_util_percent": 58.53636363636363}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 27.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 30.0, 0.0, 0.0, 60.0, 0.0, 60.0, 0.0, 60.0, 90.0, 30.0, -30.0, 0.0, -30.0, 30.0, 30.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 60.0, 0.0, 0.0, 30.0, 0.0, 0.0, 30.0, 60.0, 0.0, -30.0, 30.0, 0.0, 0.0, 30.0, 30.0, 30.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 0.0, 30.0, 30.0, 0.0, 0.0, 30.0, 0.0, 90.0, 0.0, 30.0, 60.0, 0.0, 30.0, 60.0, -30.0, 30.0, 90.0, 30.0, 60.0, 90.0, 60.0, 30.0, 60.0, 0.0, 60.0, 60.0, 30.0, -30.0, 30.0, 60.0, 30.0, 60.0, 60.0, 30.0, 30.0, 0.0, 60.0, 30.0, 90.0, 30.0, 0.0, -30.0, 60.0, 60.0, -30.0, 60.0, 90.0, 0.0, 30.0, 30.0, 30.0, 0.0, 30.0, 60.0, 30.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.754903242426011, "mean_inference_ms": 57.493971185232134, "mean_action_processing_ms": 0.24076651192473933, "mean_env_wait_ms": 0.17131481219672395, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 7000, "timesteps_this_iter": 40, "agent_timesteps_total": 7000, "timers": {"sample_time_ms": 3404.166, "sample_throughput": 11.75, "learn_time_ms": 2543.288, "learn_throughput": 15.728, "update_time_ms": 43.387}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 35.6139030456543, "grad_norm": 322.4114990234375, "td_error_abs": 4.5627080281575525, "q_taken_mean": 18.702714029947916, "target_mean": 20.74250691731771}}}, "num_steps_sampled": 7000, "num_agent_steps_sampled": 7000, "num_steps_trained": 7000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 6760, "num_target_updates": 13}, "done": false, "episodes_total": 700, "training_iteration": 7, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-30-25", "timestamp": 1648881025, "time_this_iter_s": 84.9369387626648, "time_total_s": 592.8864953517914, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 592.8864953517914, "timesteps_since_restore": 280, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.16280991735537, "ram_util_percent": 58.87024793388429}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 24.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, 60.0, 30.0, -30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 0.0, 60.0, 90.0, 0.0, 0.0, 30.0, 60.0, -30.0, 60.0, 60.0, 30.0, 60.0, 30.0, 0.0, 30.0, 0.0, 90.0, 60.0, 0.0, 30.0, -30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 0.0, 30.0, 0.0, 60.0, 60.0, 30.0, 30.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 30.0, 60.0, 30.0, -30.0, 0.0, 30.0, 60.0, 30.0, 0.0, 60.0, 0.0, 30.0, 0.0, 0.0, 60.0, 0.0, 30.0, 30.0, 60.0, 0.0, 0.0, 0.0, 0.0, 30.0, 90.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, 30.0, 0.0, 0.0, 30.0, 0.0, 30.0, 30.0, 0.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7538140445634878, "mean_inference_ms": 57.4705205459347, "mean_action_processing_ms": 0.24033072351039142, "mean_env_wait_ms": 0.17100182370743958, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 8000, "timesteps_this_iter": 40, "agent_timesteps_total": 8000, "timers": {"sample_time_ms": 3375.059, "sample_throughput": 11.852, "learn_time_ms": 2540.616, "learn_throughput": 15.744, "update_time_ms": 44.202}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 14.44631290435791, "grad_norm": 206.17724609375, "td_error_abs": 3.049187978108724, "q_taken_mean": 16.121373494466145, "target_mean": 15.020037841796874}}}, "num_steps_sampled": 8000, "num_agent_steps_sampled": 8000, "num_steps_trained": 8000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 7800, "num_target_updates": 15}, "done": false, "episodes_total": 800, "training_iteration": 8, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-31-50", "timestamp": 1648881110, "time_this_iter_s": 84.58613228797913, "time_total_s": 677.4726276397705, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 677.4726276397705, "timesteps_since_restore": 320, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.138842975206614, "ram_util_percent": 59.17190082644628}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 27.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 60.0, 60.0, 90.0, 30.0, 30.0, 0.0, 30.0, 30.0, 60.0, 0.0, 30.0, 30.0, 30.0, 60.0, 30.0, 0.0, 0.0, 0.0, -30.0, 0.0, 30.0, 60.0, 30.0, 30.0, 0.0, 30.0, 60.0, 30.0, 0.0, 30.0, 30.0, 0.0, -30.0, 0.0, 30.0, 30.0, 90.0, 30.0, 30.0, 30.0, 60.0, 90.0, 60.0, 60.0, -30.0, 0.0, 30.0, 30.0, 0.0, 30.0, 60.0, 60.0, 0.0, 0.0, 0.0, 60.0, 60.0, 30.0, 30.0, 0.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 0.0, -30.0, 30.0, 60.0, 60.0, 0.0, 0.0, 30.0, 0.0, 60.0, 30.0, 60.0, 0.0, 30.0, 60.0, 60.0, 60.0, 60.0, 0.0, 30.0, 30.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 0.0, -30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7526968278550189, "mean_inference_ms": 57.41273204997506, "mean_action_processing_ms": 0.24020552688151234, "mean_env_wait_ms": 0.17085545648738368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 9000, "timesteps_this_iter": 40, "agent_timesteps_total": 9000, "timers": {"sample_time_ms": 3389.495, "sample_throughput": 11.801, "learn_time_ms": 2540.256, "learn_throughput": 15.746, "update_time_ms": 48.367}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 20.226600646972656, "grad_norm": 391.9281005859375, "td_error_abs": 3.5331804911295572, "q_taken_mean": 19.230836995442708, "target_mean": 16.86617228190104}}}, "num_steps_sampled": 9000, "num_agent_steps_sampled": 9000, "num_steps_trained": 9000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 8840, "num_target_updates": 17}, "done": false, "episodes_total": 900, "training_iteration": 9, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-33-15", "timestamp": 1648881195, "time_this_iter_s": 85.19467616081238, "time_total_s": 762.6673038005829, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 762.6673038005829, "timesteps_since_restore": 360, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.139669421487604, "ram_util_percent": 59.43140495867768}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 35.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 30.0, 30.0, 30.0, 0.0, -30.0, 30.0, 0.0, 60.0, 30.0, 90.0, 30.0, -30.0, 90.0, 60.0, 90.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 90.0, 90.0, 30.0, 0.0, 60.0, 30.0, 90.0, 60.0, 90.0, 30.0, 60.0, 60.0, 60.0, 0.0, 60.0, 30.0, 30.0, 0.0, 0.0, 60.0, 60.0, 0.0, 60.0, 60.0, 0.0, 0.0, 0.0, 60.0, 0.0, 60.0, 30.0, 30.0, 0.0, 60.0, 0.0, 30.0, 30.0, 60.0, 90.0, 90.0, 30.0, 30.0, 60.0, 0.0, 0.0, 30.0, 60.0, 60.0, 30.0, 60.0, 30.0, -30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 0.0, 30.0, 30.0, 30.0, 30.0, 0.0, 0.0, 0.0, 90.0, 60.0, 0.0, 90.0, 30.0, 30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7540171072989261, "mean_inference_ms": 57.453501825092424, "mean_action_processing_ms": 0.24069554326249246, "mean_env_wait_ms": 0.1710723610412402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 10000, "timesteps_this_iter": 40, "agent_timesteps_total": 10000, "timers": {"sample_time_ms": 3353.558, "sample_throughput": 11.928, "learn_time_ms": 2506.16, "learn_throughput": 15.961, "update_time_ms": 43.358}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.645583152770996, "grad_norm": 213.15565490722656, "td_error_abs": 2.6348030090332033, "q_taken_mean": 15.021671549479167, "target_mean": 13.639084879557291}}}, "num_steps_sampled": 10000, "num_agent_steps_sampled": 10000, "num_steps_trained": 10000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 9880, "num_target_updates": 19}, "done": false, "episodes_total": 1000, "training_iteration": 10, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-34-40", "timestamp": 1648881280, "time_this_iter_s": 84.3745744228363, "time_total_s": 847.0418782234192, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 847.0418782234192, "timesteps_since_restore": 400, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 23.650833333333335, "ram_util_percent": 59.73250000000001}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 26.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 30.0, 60.0, 30.0, 0.0, 0.0, 30.0, 0.0, 60.0, 0.0, 0.0, 90.0, 30.0, 30.0, 30.0, 30.0, 0.0, 60.0, 30.0, 0.0, 60.0, 60.0, 90.0, 60.0, 0.0, 0.0, 30.0, 60.0, 30.0, 30.0, 0.0, 60.0, 30.0, 60.0, 0.0, 30.0, 60.0, 0.0, 60.0, 60.0, 30.0, 60.0, 60.0, 30.0, 120.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 30.0, -30.0, 0.0, 30.0, 0.0, 60.0, 30.0, -30.0, 30.0, 30.0, -30.0, 0.0, 0.0, -30.0, -30.0, -30.0, 0.0, 0.0, 30.0, 30.0, 30.0, 0.0, 0.0, 90.0, 0.0, 30.0, 30.0, 60.0, 0.0, 90.0, 60.0, 30.0, 0.0, 0.0, 30.0, 60.0, 30.0, 30.0, 90.0, 0.0, 0.0, 60.0, 30.0, 0.0, 0.0, -30.0, 30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7529402377171244, "mean_inference_ms": 57.40766998032404, "mean_action_processing_ms": 0.2404329170967526, "mean_env_wait_ms": 0.17075448069126986, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 11000, "timesteps_this_iter": 40, "agent_timesteps_total": 11000, "timers": {"sample_time_ms": 3349.814, "sample_throughput": 11.941, "learn_time_ms": 2516.956, "learn_throughput": 15.892, "update_time_ms": 43.126}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.364326477050781, "grad_norm": 153.81109619140625, "td_error_abs": 2.319945780436198, "q_taken_mean": 14.233304850260417, "target_mean": 13.392085774739583}}}, "num_steps_sampled": 11000, "num_agent_steps_sampled": 11000, "num_steps_trained": 11000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 10920, "num_target_updates": 21}, "done": false, "episodes_total": 1100, "training_iteration": 11, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-36-04", "timestamp": 1648881364, "time_this_iter_s": 84.1487512588501, "time_total_s": 931.1906294822693, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 931.1906294822693, "timesteps_since_restore": 440, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 22.985950413223136, "ram_util_percent": 60.07355371900826}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 33.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 0.0, 0.0, 60.0, 60.0, 30.0, -30.0, 0.0, 60.0, 0.0, -30.0, 60.0, 30.0, 0.0, 120.0, 60.0, 60.0, 0.0, -30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 0.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 0.0, 30.0, 0.0, 30.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 30.0, 0.0, 0.0, 0.0, 0.0, 60.0, 30.0, 0.0, 30.0, 30.0, 90.0, 60.0, 60.0, 30.0, -30.0, 90.0, 30.0, 90.0, 0.0, 30.0, 60.0, 0.0, 30.0, 90.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 90.0, 60.0, 30.0, -30.0, 90.0, 30.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 90.0, 30.0, 90.0, 0.0, 0.0, 60.0, 30.0, 60.0, 0.0, 60.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.75313827269318, "mean_inference_ms": 57.442369221925986, "mean_action_processing_ms": 0.24072161041788553, "mean_env_wait_ms": 0.17083060618282675, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 12000, "timesteps_this_iter": 40, "agent_timesteps_total": 12000, "timers": {"sample_time_ms": 3399.647, "sample_throughput": 11.766, "learn_time_ms": 2519.043, "learn_throughput": 15.879, "update_time_ms": 43.795}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.998085021972656, "grad_norm": 130.27426147460938, "td_error_abs": 2.0681671142578124, "q_taken_mean": 12.797574869791667, "target_mean": 13.411185709635417}}}, "num_steps_sampled": 12000, "num_agent_steps_sampled": 12000, "num_steps_trained": 12000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 11960, "num_target_updates": 23}, "done": false, "episodes_total": 1200, "training_iteration": 12, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-37-28", "timestamp": 1648881448, "time_this_iter_s": 84.66739988327026, "time_total_s": 1015.8580293655396, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1015.8580293655396, "timesteps_since_restore": 480, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.09416666666667, "ram_util_percent": 60.405}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 39.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 30.0, -30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 60.0, -30.0, 60.0, 0.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 0.0, 60.0, 30.0, 60.0, 30.0, 30.0, 90.0, 30.0, 90.0, 90.0, -30.0, 30.0, 30.0, 90.0, 60.0, 60.0, 0.0, 60.0, 60.0, 0.0, 30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 30.0, 0.0, 0.0, 90.0, 60.0, 30.0, 60.0, 60.0, 90.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 0.0, 60.0, 60.0, 0.0, 30.0, 60.0, 30.0, 60.0, 30.0, 60.0, 60.0, -30.0, 30.0, 30.0, 90.0, 0.0, 60.0, 60.0, 0.0, 90.0, 60.0, 30.0, 0.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7535428386290454, "mean_inference_ms": 57.4166858720618, "mean_action_processing_ms": 0.24069043094654952, "mean_env_wait_ms": 0.17082742528525252, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 13000, "timesteps_this_iter": 40, "agent_timesteps_total": 13000, "timers": {"sample_time_ms": 3373.333, "sample_throughput": 11.858, "learn_time_ms": 2523.906, "learn_throughput": 15.848, "update_time_ms": 42.971}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.608064651489258, "grad_norm": 179.47328186035156, "td_error_abs": 2.2523905436197915, "q_taken_mean": 13.13115234375, "target_mean": 11.910638427734375}}}, "num_steps_sampled": 13000, "num_agent_steps_sampled": 13000, "num_steps_trained": 13000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 13000, "num_target_updates": 25}, "done": false, "episodes_total": 1300, "training_iteration": 13, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-38-53", "timestamp": 1648881533, "time_this_iter_s": 84.97712707519531, "time_total_s": 1100.8351564407349, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1100.8351564407349, "timesteps_since_restore": 520, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 22.69586776859504, "ram_util_percent": 60.64049586776859}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 30.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 30.0, 0.0, 60.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 90.0, 60.0, 0.0, 30.0, 0.0, 0.0, 60.0, 0.0, 30.0, 30.0, 0.0, 60.0, 120.0, 60.0, 0.0, 30.0, 30.0, -30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 60.0, 0.0, 30.0, 30.0, 60.0, 30.0, -30.0, 30.0, 60.0, 60.0, 30.0, 30.0, 0.0, 90.0, 30.0, 60.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 30.0, -30.0, 30.0, 60.0, 0.0, 30.0, 30.0, 30.0, 0.0, 30.0, 30.0, 30.0, 30.0, 90.0, 60.0, 30.0, 0.0, 60.0, 60.0, 0.0, 30.0, 30.0, 60.0, 90.0, 30.0, 30.0, 0.0, 30.0, 60.0, 0.0, 0.0, 30.0, 30.0, 30.0, 0.0, 60.0, 90.0, 0.0, 0.0, 0.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7540497974612582, "mean_inference_ms": 57.41714098153199, "mean_action_processing_ms": 0.24076507146683326, "mean_env_wait_ms": 0.17097749835387255, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 14000, "timesteps_this_iter": 40, "agent_timesteps_total": 14000, "timers": {"sample_time_ms": 3418.39, "sample_throughput": 11.701, "learn_time_ms": 2539.292, "learn_throughput": 15.752, "update_time_ms": 57.064}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 14.034910202026367, "grad_norm": 202.60491943359375, "td_error_abs": 2.840098571777344, "q_taken_mean": 12.660612996419271, "target_mean": 11.416879272460937}}}, "num_steps_sampled": 14000, "num_agent_steps_sampled": 14000, "num_steps_trained": 14000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 13520, "num_target_updates": 26}, "done": false, "episodes_total": 1400, "training_iteration": 14, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-40-18", "timestamp": 1648881618, "time_this_iter_s": 84.65674304962158, "time_total_s": 1185.4918994903564, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1185.4918994903564, "timesteps_since_restore": 560, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.152066115702482, "ram_util_percent": 60.94462809917355}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 30.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, 60.0, 30.0, 30.0, 0.0, 60.0, 90.0, 30.0, 0.0, 60.0, 0.0, 0.0, 90.0, 30.0, 0.0, 30.0, 0.0, 90.0, 90.0, 60.0, 30.0, 60.0, 0.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 120.0, 30.0, 0.0, 30.0, 60.0, 0.0, 30.0, 0.0, 60.0, 60.0, 30.0, 0.0, 60.0, -30.0, 30.0, 30.0, 30.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 0.0, 0.0, 60.0, 0.0, 30.0, 60.0, 30.0, 30.0, 60.0, 0.0, 60.0, 60.0, 90.0, 30.0, 90.0, 0.0, 0.0, 30.0, 60.0, 30.0, 30.0, 60.0, 0.0, 0.0, 30.0, 60.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 30.0, 90.0, 0.0, 0.0, 60.0, 0.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 90.0, 90.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7539728392730934, "mean_inference_ms": 57.41845798695827, "mean_action_processing_ms": 0.24081693907096777, "mean_env_wait_ms": 0.17102789287724762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 15000, "timesteps_this_iter": 40, "agent_timesteps_total": 15000, "timers": {"sample_time_ms": 3360.421, "sample_throughput": 11.903, "learn_time_ms": 2506.285, "learn_throughput": 15.96, "update_time_ms": 43.649}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.93351936340332, "grad_norm": 121.77948760986328, "td_error_abs": 2.0756361643473307, "q_taken_mean": 11.667550659179687, "target_mean": 10.735673014322916}}}, "num_steps_sampled": 15000, "num_agent_steps_sampled": 15000, "num_steps_trained": 15000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 14560, "num_target_updates": 28}, "done": false, "episodes_total": 1500, "training_iteration": 15, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-41-42", "timestamp": 1648881702, "time_this_iter_s": 84.05474352836609, "time_total_s": 1269.5466430187225, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1269.5466430187225, "timesteps_since_restore": 600, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 22.941666666666666, "ram_util_percent": 61.275000000000006}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 37.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 90.0, 30.0, 0.0, 90.0, 60.0, 30.0, 0.0, 30.0, 60.0, 30.0, 0.0, 30.0, 60.0, 0.0, 30.0, 30.0, 60.0, 90.0, 60.0, 60.0, 0.0, 30.0, 60.0, 0.0, 60.0, 30.0, 90.0, 30.0, 0.0, 30.0, 90.0, 30.0, 60.0, 30.0, 90.0, 0.0, 30.0, 0.0, 30.0, 30.0, 60.0, 30.0, 60.0, 0.0, 60.0, 0.0, 90.0, 0.0, 90.0, 60.0, 60.0, 60.0, 30.0, 0.0, 30.0, 60.0, 0.0, 60.0, 30.0, 30.0, 60.0, 30.0, 60.0, 30.0, 0.0, 0.0, 60.0, 30.0, 0.0, 30.0, 30.0, 60.0, 60.0, 60.0, 60.0, 0.0, 30.0, 60.0, 30.0, 60.0, 60.0, 30.0, 30.0, 60.0, 90.0, 30.0, 30.0, 60.0, 90.0, -30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 60.0, 0.0, 0.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7539210960704728, "mean_inference_ms": 57.43750963351691, "mean_action_processing_ms": 0.24090219038601254, "mean_env_wait_ms": 0.1711224472781951, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 16000, "timesteps_this_iter": 40, "agent_timesteps_total": 16000, "timers": {"sample_time_ms": 3376.317, "sample_throughput": 11.847, "learn_time_ms": 2519.541, "learn_throughput": 15.876, "update_time_ms": 43.3}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.987136840820312, "grad_norm": 92.89307403564453, "td_error_abs": 2.3390767415364584, "q_taken_mean": 12.752528889973958, "target_mean": 12.035337320963542}}}, "num_steps_sampled": 16000, "num_agent_steps_sampled": 16000, "num_steps_trained": 16000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 15600, "num_target_updates": 30}, "done": false, "episodes_total": 1600, "training_iteration": 16, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-43-07", "timestamp": 1648881787, "time_this_iter_s": 84.91990089416504, "time_total_s": 1354.4665439128876, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1354.4665439128876, "timesteps_since_restore": 640, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 23.142148760330578, "ram_util_percent": 61.63305785123967}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 35.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 60.0, 60.0, 30.0, 60.0, 30.0, 0.0, 30.0, 0.0, 30.0, 60.0, 30.0, 60.0, 60.0, 60.0, 30.0, 0.0, 60.0, 90.0, 60.0, 30.0, 0.0, 60.0, 30.0, 30.0, 60.0, 30.0, -30.0, 0.0, 60.0, 60.0, 0.0, 0.0, 0.0, 60.0, 90.0, 30.0, 0.0, 90.0, 60.0, 60.0, -30.0, 0.0, 30.0, -30.0, 60.0, 60.0, 60.0, 0.0, 60.0, 30.0, 90.0, 0.0, 60.0, 0.0, 30.0, 0.0, 30.0, 60.0, 60.0, 0.0, 60.0, 90.0, 30.0, 60.0, 0.0, 30.0, 0.0, 0.0, 60.0, 0.0, 60.0, 60.0, 30.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 60.0, 90.0, 60.0, 60.0, 30.0, 60.0, 0.0, 30.0, 30.0, 30.0, 0.0, 0.0, 30.0, -30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7544542811556831, "mean_inference_ms": 57.43979764136111, "mean_action_processing_ms": 0.24108651440947285, "mean_env_wait_ms": 0.17118824142423741, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 17000, "timesteps_this_iter": 40, "agent_timesteps_total": 17000, "timers": {"sample_time_ms": 3386.752, "sample_throughput": 11.811, "learn_time_ms": 2544.333, "learn_throughput": 15.721, "update_time_ms": 43.635}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 17.72870445251465, "grad_norm": 169.54673767089844, "td_error_abs": 3.1562795003255206, "q_taken_mean": 13.518936157226562, "target_mean": 14.802978515625}}}, "num_steps_sampled": 17000, "num_agent_steps_sampled": 17000, "num_steps_trained": 17000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 16640, "num_target_updates": 32}, "done": false, "episodes_total": 1700, "training_iteration": 17, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-44-32", "timestamp": 1648881872, "time_this_iter_s": 85.03031039237976, "time_total_s": 1439.4968543052673, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1439.4968543052673, "timesteps_since_restore": 680, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.340495867768592, "ram_util_percent": 61.94380165289255}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 36.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 90.0, 60.0, 30.0, 60.0, 30.0, -30.0, 30.0, 90.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 30.0, 90.0, 0.0, -30.0, 90.0, 30.0, 60.0, 0.0, 60.0, -30.0, 0.0, 30.0, 60.0, 0.0, 60.0, -30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 90.0, 60.0, 0.0, 60.0, 60.0, 30.0, 60.0, 60.0, 0.0, 0.0, 60.0, 90.0, 90.0, 90.0, 30.0, 0.0, 60.0, 0.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 0.0, 60.0, 30.0, 60.0, 0.0, 60.0, 60.0, 0.0, 30.0, 30.0, 0.0, 60.0, 0.0, -30.0, 30.0, 30.0, 30.0, 90.0, 60.0, 60.0, 30.0, 30.0, 30.0, 0.0, 30.0, 0.0, 0.0, 30.0, 60.0, 60.0, 60.0, 30.0, 60.0, 0.0, 30.0, 60.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7545119310797278, "mean_inference_ms": 57.435924107433536, "mean_action_processing_ms": 0.24115698943003572, "mean_env_wait_ms": 0.1711373831319481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 18000, "timesteps_this_iter": 40, "agent_timesteps_total": 18000, "timers": {"sample_time_ms": 3362.831, "sample_throughput": 11.895, "learn_time_ms": 2527.872, "learn_throughput": 15.824, "update_time_ms": 42.815}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 12.15176773071289, "grad_norm": 128.18643188476562, "td_error_abs": 2.883544667561849, "q_taken_mean": 13.693113199869792, "target_mean": 13.747427368164063}}}, "num_steps_sampled": 18000, "num_agent_steps_sampled": 18000, "num_steps_trained": 18000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 17680, "num_target_updates": 34}, "done": false, "episodes_total": 1800, "training_iteration": 18, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-45-57", "timestamp": 1648881957, "time_this_iter_s": 85.07314324378967, "time_total_s": 1524.569997549057, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1524.569997549057, "timesteps_since_restore": 720, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 23.424590163934432, "ram_util_percent": 62.17213114754099}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 40.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 0.0, 90.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 90.0, 30.0, 30.0, 120.0, 30.0, 30.0, 60.0, 30.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 0.0, 30.0, 60.0, 0.0, 60.0, 60.0, 30.0, 0.0, 30.0, 60.0, 90.0, 60.0, 30.0, 30.0, 90.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 30.0, 0.0, 60.0, 30.0, 60.0, 30.0, 0.0, 0.0, 30.0, 30.0, 0.0, 90.0, 90.0, 60.0, 30.0, 0.0, 30.0, 30.0, 90.0, 60.0, 0.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, -30.0, 30.0, 90.0, 30.0, 30.0, -30.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7543965681706749, "mean_inference_ms": 57.43942656433725, "mean_action_processing_ms": 0.2411522756900518, "mean_env_wait_ms": 0.17114241131730537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 19000, "timesteps_this_iter": 40, "agent_timesteps_total": 19000, "timers": {"sample_time_ms": 3384.184, "sample_throughput": 11.82, "learn_time_ms": 2530.825, "learn_throughput": 15.805, "update_time_ms": 44.75}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.546116828918457, "grad_norm": 139.39456176757812, "td_error_abs": 2.5562413533528647, "q_taken_mean": 15.737234497070313, "target_mean": 15.22352294921875}}}, "num_steps_sampled": 19000, "num_agent_steps_sampled": 19000, "num_steps_trained": 19000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 18720, "num_target_updates": 36}, "done": false, "episodes_total": 1900, "training_iteration": 19, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-47-21", "timestamp": 1648882041, "time_this_iter_s": 84.02480125427246, "time_total_s": 1608.5947988033295, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1608.5947988033295, "timesteps_since_restore": 760, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 23.32, "ram_util_percent": 62.497499999999995}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 42.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 30.0, 30.0, 0.0, 0.0, 60.0, 60.0, 60.0, 30.0, 0.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 90.0, 30.0, 120.0, 0.0, 60.0, 30.0, 30.0, 90.0, 0.0, 0.0, 0.0, 30.0, 60.0, 0.0, 30.0, 30.0, 30.0, 30.0, 90.0, 0.0, 30.0, 0.0, 30.0, 60.0, 30.0, 0.0, 90.0, 0.0, 30.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 90.0, 30.0, 60.0, 30.0, 30.0, 30.0, 60.0, 60.0, 60.0, 90.0, 0.0, 90.0, 0.0, 30.0, 90.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 30.0, 30.0, 30.0, 30.0, 120.0, 0.0, 30.0, 90.0, 60.0, 60.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7545061050427242, "mean_inference_ms": 57.45528694678009, "mean_action_processing_ms": 0.2413097678887989, "mean_env_wait_ms": 0.1713899201666014, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 20000, "timesteps_this_iter": 40, "agent_timesteps_total": 20000, "timers": {"sample_time_ms": 3356.82, "sample_throughput": 11.916, "learn_time_ms": 2511.888, "learn_throughput": 15.924, "update_time_ms": 43.552}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.230730056762695, "grad_norm": 191.0707550048828, "td_error_abs": 2.448328908284505, "q_taken_mean": 13.537415568033854, "target_mean": 12.147524007161458}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 20000, "num_steps_trained": 20000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 19760, "num_target_updates": 38}, "done": false, "episodes_total": 2000, "training_iteration": 20, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-48-46", "timestamp": 1648882126, "time_this_iter_s": 84.60825991630554, "time_total_s": 1693.203058719635, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1693.203058719635, "timesteps_since_restore": 800, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.149166666666666, "ram_util_percent": 62.76166666666667}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 39.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 0.0, 60.0, 30.0, 60.0, 60.0, 30.0, 0.0, 30.0, 90.0, 30.0, 90.0, 60.0, 60.0, 60.0, 60.0, 0.0, 30.0, 30.0, -30.0, 90.0, 60.0, 30.0, 60.0, 30.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 90.0, 60.0, 60.0, 0.0, 30.0, 30.0, 30.0, -30.0, 30.0, 30.0, 30.0, 30.0, -30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 30.0, 60.0, 30.0, 30.0, 30.0, 60.0, 90.0, 60.0, 0.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 30.0, 90.0, 60.0, 60.0, 30.0, 60.0, 30.0, 90.0, 30.0, 60.0, -30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 30.0, 60.0, 30.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.754287641994205, "mean_inference_ms": 57.44884776242731, "mean_action_processing_ms": 0.24131350779710467, "mean_env_wait_ms": 0.1713210822196035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 21000, "timesteps_this_iter": 40, "agent_timesteps_total": 21000, "timers": {"sample_time_ms": 3373.385, "sample_throughput": 11.858, "learn_time_ms": 2507.2, "learn_throughput": 15.954, "update_time_ms": 44.386}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 15.87401294708252, "grad_norm": 129.22691345214844, "td_error_abs": 3.364177958170573, "q_taken_mean": 16.616689046223957, "target_mean": 16.377180989583334}}}, "num_steps_sampled": 21000, "num_agent_steps_sampled": 21000, "num_steps_trained": 21000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 20800, "num_target_updates": 40}, "done": false, "episodes_total": 2100, "training_iteration": 21, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-50-10", "timestamp": 1648882210, "time_this_iter_s": 84.27791261672974, "time_total_s": 1777.4809713363647, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1777.4809713363647, "timesteps_since_restore": 840, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 23.195, "ram_util_percent": 63.09166666666667}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 32.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 30.0, 30.0, 90.0, -30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, -30.0, 0.0, 60.0, 30.0, 90.0, 0.0, 0.0, 30.0, 30.0, 90.0, 120.0, -30.0, 0.0, 60.0, 60.0, 90.0, 30.0, 0.0, 60.0, 60.0, 90.0, 30.0, 30.0, 0.0, 60.0, 30.0, 30.0, 30.0, 60.0, 30.0, 30.0, 0.0, 0.0, 30.0, 60.0, 90.0, -30.0, 60.0, 30.0, 60.0, 30.0, 30.0, 30.0, 90.0, 30.0, 30.0, 60.0, 30.0, 30.0, -30.0, 0.0, 0.0, 90.0, 60.0, 30.0, 0.0, 30.0, 30.0, 0.0, 30.0, 30.0, 90.0, 30.0, 60.0, 0.0, 30.0, 60.0, 0.0, 60.0, -30.0, 30.0, 60.0, 90.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 30.0, -30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7537864399181671, "mean_inference_ms": 57.43014889399674, "mean_action_processing_ms": 0.24110822108979002, "mean_env_wait_ms": 0.17115592393110596, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 22000, "timesteps_this_iter": 40, "agent_timesteps_total": 22000, "timers": {"sample_time_ms": 3415.986, "sample_throughput": 11.71, "learn_time_ms": 2512.636, "learn_throughput": 15.92, "update_time_ms": 47.868}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 12.720525741577148, "grad_norm": 220.74017333984375, "td_error_abs": 2.6672042846679687, "q_taken_mean": 9.366355387369792, "target_mean": 11.265037027994792}}}, "num_steps_sampled": 22000, "num_agent_steps_sampled": 22000, "num_steps_trained": 22000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 21840, "num_target_updates": 42}, "done": false, "episodes_total": 2200, "training_iteration": 22, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-51-35", "timestamp": 1648882295, "time_this_iter_s": 84.9066367149353, "time_total_s": 1862.3876080513, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1862.3876080513, "timesteps_since_restore": 880, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 23.289344262295085, "ram_util_percent": 63.383606557377036}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 32.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 0.0, 0.0, 60.0, 30.0, 60.0, 30.0, 60.0, 30.0, 60.0, -30.0, 30.0, 30.0, 30.0, 30.0, -30.0, 60.0, 60.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 0.0, 30.0, 90.0, 30.0, -30.0, 30.0, 30.0, 60.0, 30.0, 0.0, 60.0, 120.0, 0.0, 90.0, 30.0, 60.0, 60.0, 0.0, 0.0, 30.0, 60.0, 30.0, 30.0, 60.0, 90.0, 30.0, 30.0, 30.0, 30.0, 0.0, 30.0, 30.0, 0.0, 30.0, 30.0, 30.0, 30.0, 90.0, 30.0, 30.0, 0.0, 60.0, 30.0, 30.0, 0.0, 30.0, 60.0, 30.0, 30.0, 0.0, 30.0, 60.0, 0.0, 30.0, 0.0, 0.0, 30.0, 30.0, -30.0, 0.0, 60.0, 30.0, 30.0, 90.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 60.0, 0.0, 30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7535868718341792, "mean_inference_ms": 57.42325849728758, "mean_action_processing_ms": 0.24113032615116378, "mean_env_wait_ms": 0.17117455904845705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 23000, "timesteps_this_iter": 40, "agent_timesteps_total": 23000, "timers": {"sample_time_ms": 3354.272, "sample_throughput": 11.925, "learn_time_ms": 2495.557, "learn_throughput": 16.028, "update_time_ms": 44.027}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 20.89859390258789, "grad_norm": 288.585693359375, "td_error_abs": 3.792816162109375, "q_taken_mean": 14.95125223795573, "target_mean": 13.100071207682292}}}, "num_steps_sampled": 23000, "num_agent_steps_sampled": 23000, "num_steps_trained": 23000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 22880, "num_target_updates": 44}, "done": false, "episodes_total": 2300, "training_iteration": 23, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-53-00", "timestamp": 1648882380, "time_this_iter_s": 84.54120516777039, "time_total_s": 1946.9288132190704, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1946.9288132190704, "timesteps_since_restore": 920, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.55, "ram_util_percent": 63.70333333333334}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 41.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 90.0, 0.0, 30.0, 30.0, 30.0, 0.0, -30.0, 60.0, 60.0, 90.0, 60.0, 30.0, 30.0, 90.0, 30.0, 60.0, 30.0, 60.0, 30.0, 30.0, 60.0, 60.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 30.0, 90.0, 30.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 0.0, 60.0, 60.0, 60.0, 0.0, 60.0, 60.0, 0.0, 30.0, 60.0, 60.0, 90.0, 60.0, 0.0, 0.0, 60.0, 0.0, 90.0, 60.0, 0.0, 90.0, 30.0, 30.0, 30.0, 0.0, 30.0, 30.0, 30.0, 90.0, 60.0, 60.0, 30.0, 60.0, 0.0, 0.0, 60.0, 0.0, 30.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 120.0, 30.0, -30.0, 60.0, 60.0, 0.0, 60.0, 90.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7535500181573486, "mean_inference_ms": 57.39848358673644, "mean_action_processing_ms": 0.24111586557867304, "mean_env_wait_ms": 0.17119671698114003, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 24000, "timesteps_this_iter": 40, "agent_timesteps_total": 24000, "timers": {"sample_time_ms": 3380.408, "sample_throughput": 11.833, "learn_time_ms": 2548.585, "learn_throughput": 15.695, "update_time_ms": 44.268}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.298277854919434, "grad_norm": 108.59507751464844, "td_error_abs": 2.684217325846354, "q_taken_mean": 13.498810831705729, "target_mean": 13.962925211588542}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 24000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 23920, "num_target_updates": 46}, "done": false, "episodes_total": 2400, "training_iteration": 24, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-54-24", "timestamp": 1648882464, "time_this_iter_s": 84.53552770614624, "time_total_s": 2031.4643409252167, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2031.4643409252167, "timesteps_since_restore": 960, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.362809917355374, "ram_util_percent": 63.993388429752066}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 45.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, 60.0, 60.0, 30.0, 120.0, 30.0, 0.0, 0.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 90.0, 60.0, 0.0, 30.0, 0.0, 30.0, 90.0, 60.0, 30.0, 90.0, 0.0, 30.0, 60.0, 90.0, 60.0, 30.0, 60.0, 30.0, 60.0, 60.0, 30.0, 60.0, 30.0, 60.0, 0.0, 60.0, 0.0, 30.0, 30.0, 60.0, 60.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 0.0, 90.0, 90.0, 90.0, 0.0, 60.0, 60.0, 60.0, 30.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 90.0, 0.0, 90.0, 60.0, 120.0, 30.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 0.0, 120.0, 60.0, 0.0, 90.0, 30.0, 30.0, 0.0, 90.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.753628370418985, "mean_inference_ms": 57.38389085834644, "mean_action_processing_ms": 0.2411408360300779, "mean_env_wait_ms": 0.17122319556678542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 25000, "timesteps_this_iter": 40, "agent_timesteps_total": 25000, "timers": {"sample_time_ms": 3374.996, "sample_throughput": 11.852, "learn_time_ms": 2538.506, "learn_throughput": 15.757, "update_time_ms": 48.348}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 14.35775089263916, "grad_norm": 382.8805847167969, "td_error_abs": 3.0516281127929688, "q_taken_mean": 12.421531168619792, "target_mean": 15.11851298014323}}}, "num_steps_sampled": 25000, "num_agent_steps_sampled": 25000, "num_steps_trained": 25000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 24960, "num_target_updates": 48}, "done": false, "episodes_total": 2500, "training_iteration": 25, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-55-49", "timestamp": 1648882549, "time_this_iter_s": 84.72989463806152, "time_total_s": 2116.194235563278, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2116.194235563278, "timesteps_since_restore": 1000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 23.03884297520661, "ram_util_percent": 64.28429752066116}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 42.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 30.0, 90.0, 0.0, 60.0, 30.0, 30.0, 30.0, 120.0, 30.0, 30.0, 60.0, 30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 120.0, 60.0, 30.0, -30.0, 60.0, 90.0, 120.0, 90.0, 30.0, 60.0, 30.0, 60.0, 30.0, 60.0, 60.0, 30.0, 60.0, 90.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 90.0, 0.0, 0.0, 60.0, 30.0, 30.0, 30.0, 0.0, 30.0, 30.0, 30.0, 30.0, 0.0, 60.0, 30.0, 60.0, -30.0, 60.0, 30.0, 30.0, 90.0, 30.0, -30.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 0.0, 90.0, 30.0, 0.0, 30.0, 60.0, 60.0, 90.0, 60.0, 0.0, 0.0, 30.0, 0.0, 30.0, 60.0, 90.0, 90.0, 30.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7534681824679887, "mean_inference_ms": 57.3773368232673, "mean_action_processing_ms": 0.24105648575627123, "mean_env_wait_ms": 0.17117992802191437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 26000, "timesteps_this_iter": 40, "agent_timesteps_total": 26000, "timers": {"sample_time_ms": 3385.537, "sample_throughput": 11.815, "learn_time_ms": 2544.764, "learn_throughput": 15.719, "update_time_ms": 45.773}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.579813957214355, "grad_norm": 104.91952514648438, "td_error_abs": 2.2983774820963543, "q_taken_mean": 12.700730387369791, "target_mean": 12.476438395182292}}}, "num_steps_sampled": 26000, "num_agent_steps_sampled": 26000, "num_steps_trained": 26000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 26000, "num_target_updates": 50}, "done": false, "episodes_total": 2600, "training_iteration": 26, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-57-14", "timestamp": 1648882634, "time_this_iter_s": 84.97252106666565, "time_total_s": 2201.166756629944, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2201.166756629944, "timesteps_since_restore": 1040, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.62314049586777, "ram_util_percent": 64.60495867768594}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 41.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 30.0, 60.0, 30.0, 0.0, 90.0, 0.0, 60.0, 30.0, 60.0, 90.0, 30.0, 60.0, 90.0, 30.0, 90.0, 30.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 30.0, 0.0, 60.0, 90.0, 30.0, 30.0, 0.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 30.0, 60.0, 0.0, 0.0, 90.0, 0.0, 30.0, 30.0, 90.0, 120.0, 0.0, 60.0, 90.0, 0.0, -30.0, 30.0, 30.0, 30.0, 90.0, 30.0, 60.0, 30.0, 90.0, 30.0, 0.0, 0.0, 0.0, 60.0, 30.0, 60.0, 60.0, 30.0, 60.0, 90.0, 30.0, 0.0, 0.0, 120.0, 60.0, 60.0, 30.0, 90.0, -30.0, 60.0, 90.0, 0.0, 60.0, 60.0, 0.0, 30.0, 60.0, -30.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 30.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7536929195111921, "mean_inference_ms": 57.378158386045705, "mean_action_processing_ms": 0.24103015603851052, "mean_env_wait_ms": 0.1711905082055081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 27000, "timesteps_this_iter": 40, "agent_timesteps_total": 27000, "timers": {"sample_time_ms": 3405.41, "sample_throughput": 11.746, "learn_time_ms": 2535.952, "learn_throughput": 15.773, "update_time_ms": 57.412}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.868378639221191, "grad_norm": 144.3632354736328, "td_error_abs": 2.3349334716796877, "q_taken_mean": 17.248457845052084, "target_mean": 16.418589274088543}}}, "num_steps_sampled": 27000, "num_agent_steps_sampled": 27000, "num_steps_trained": 27000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 26520, "num_target_updates": 51}, "done": false, "episodes_total": 2700, "training_iteration": 27, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-01_23-58-39", "timestamp": 1648882719, "time_this_iter_s": 84.86171865463257, "time_total_s": 2286.0284752845764, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2286.0284752845764, "timesteps_since_restore": 1080, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 23.204958677685948, "ram_util_percent": 65.22809917355373}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 45.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 60.0, 30.0, 60.0, 0.0, 30.0, 30.0, 0.0, 60.0, 60.0, 90.0, 60.0, 60.0, 120.0, 30.0, 90.0, 60.0, 60.0, 60.0, 60.0, 60.0, 30.0, 90.0, 60.0, 60.0, 0.0, 60.0, 120.0, 90.0, 60.0, 90.0, 60.0, 30.0, 0.0, 90.0, 0.0, -30.0, 60.0, 0.0, 30.0, 30.0, -30.0, 0.0, 30.0, 30.0, 90.0, 90.0, 60.0, 0.0, 60.0, 30.0, 120.0, 60.0, 60.0, 30.0, 30.0, 90.0, 30.0, 60.0, 60.0, 30.0, 0.0, 30.0, 60.0, 0.0, 30.0, 60.0, 30.0, 0.0, 30.0, 60.0, 60.0, 30.0, 90.0, 60.0, 60.0, 30.0, 60.0, 60.0, 90.0, 0.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 60.0, 30.0, 0.0, 30.0, 30.0, 90.0, 30.0, 30.0, 30.0, 90.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7537370612835517, "mean_inference_ms": 57.362646209292905, "mean_action_processing_ms": 0.24093404665553153, "mean_env_wait_ms": 0.17120294648568102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 28000, "timesteps_this_iter": 40, "agent_timesteps_total": 28000, "timers": {"sample_time_ms": 3378.833, "sample_throughput": 11.838, "learn_time_ms": 2525.538, "learn_throughput": 15.838, "update_time_ms": 44.587}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.726287841796875, "grad_norm": 290.8778991699219, "td_error_abs": 2.872747294108073, "q_taken_mean": 14.957567342122395, "target_mean": 16.920296223958335}}}, "num_steps_sampled": 28000, "num_agent_steps_sampled": 28000, "num_steps_trained": 28000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 27560, "num_target_updates": 53}, "done": false, "episodes_total": 2800, "training_iteration": 28, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-00-03", "timestamp": 1648882803, "time_this_iter_s": 84.466965675354, "time_total_s": 2370.4954409599304, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2370.4954409599304, "timesteps_since_restore": 1120, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 23.223333333333336, "ram_util_percent": 65.47083333333333}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 46.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 30.0, 60.0, 0.0, 30.0, 30.0, 90.0, 30.0, 60.0, 60.0, 90.0, 30.0, 90.0, 120.0, 30.0, 30.0, 60.0, 0.0, 30.0, 120.0, 60.0, 120.0, 60.0, 30.0, 90.0, 90.0, 30.0, 0.0, 60.0, 0.0, 60.0, 0.0, 0.0, 60.0, 90.0, 60.0, 60.0, 30.0, 90.0, 60.0, 30.0, 60.0, 60.0, 0.0, 60.0, 90.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 0.0, 30.0, 30.0, 0.0, 60.0, 60.0, 90.0, 90.0, 30.0, 0.0, 30.0, 90.0, 0.0, 0.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 0.0, 90.0, 30.0, 90.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 60.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 30.0, 60.0, 90.0, 60.0, 0.0, 30.0, 30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7543420893556413, "mean_inference_ms": 57.36102798596332, "mean_action_processing_ms": 0.24109410509670576, "mean_env_wait_ms": 0.17128426721878273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 29000, "timesteps_this_iter": 40, "agent_timesteps_total": 29000, "timers": {"sample_time_ms": 3400.646, "sample_throughput": 11.762, "learn_time_ms": 2547.888, "learn_throughput": 15.699, "update_time_ms": 44.509}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.1870598793029785, "grad_norm": 141.65249633789062, "td_error_abs": 2.039886728922526, "q_taken_mean": 15.024320475260417, "target_mean": 14.072661336263021}}}, "num_steps_sampled": 29000, "num_agent_steps_sampled": 29000, "num_steps_trained": 29000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 28600, "num_target_updates": 55}, "done": false, "episodes_total": 2900, "training_iteration": 29, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-01-28", "timestamp": 1648882888, "time_this_iter_s": 84.93116426467896, "time_total_s": 2455.4266052246094, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2455.4266052246094, "timesteps_since_restore": 1160, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 22.96528925619835, "ram_util_percent": 65.84297520661157}}
{"episode_reward_max": 90.0, "episode_reward_min": 0.0, "episode_reward_mean": 47.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 30.0, 60.0, 30.0, 90.0, 90.0, 30.0, 90.0, 90.0, 60.0, 60.0, 60.0, 60.0, 30.0, 0.0, 0.0, 30.0, 90.0, 30.0, 60.0, 30.0, 60.0, 60.0, 90.0, 0.0, 90.0, 30.0, 30.0, 0.0, 90.0, 30.0, 30.0, 60.0, 90.0, 60.0, 60.0, 30.0, 30.0, 30.0, 90.0, 0.0, 30.0, 60.0, 60.0, 30.0, 0.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 0.0, 60.0, 60.0, 30.0, 90.0, 0.0, 30.0, 30.0, 30.0, 90.0, 60.0, 60.0, 0.0, 60.0, 60.0, 30.0, 60.0, 60.0, 0.0, 30.0, 30.0, 30.0, 30.0, 90.0, 60.0, 60.0, 60.0, 0.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 90.0, 60.0, 30.0, 0.0, 60.0, 90.0, 90.0, 60.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7543914668672229, "mean_inference_ms": 57.364282981822726, "mean_action_processing_ms": 0.24109794336737772, "mean_env_wait_ms": 0.1712834544220602, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 30000, "timesteps_this_iter": 40, "agent_timesteps_total": 30000, "timers": {"sample_time_ms": 3384.654, "sample_throughput": 11.818, "learn_time_ms": 2533.556, "learn_throughput": 15.788, "update_time_ms": 45.591}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 17.669843673706055, "grad_norm": 445.748291015625, "td_error_abs": 3.4940500895182294, "q_taken_mean": 17.992982991536458, "target_mean": 14.890812174479167}}}, "num_steps_sampled": 30000, "num_agent_steps_sampled": 30000, "num_steps_trained": 30000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 29640, "num_target_updates": 57}, "done": false, "episodes_total": 3000, "training_iteration": 30, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-02-53", "timestamp": 1648882973, "time_this_iter_s": 84.31163740158081, "time_total_s": 2539.73824262619, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2539.73824262619, "timesteps_since_restore": 1200, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 22.761666666666663, "ram_util_percent": 66.11583333333333}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 42.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 90.0, 90.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, -30.0, 60.0, 60.0, 30.0, 30.0, 60.0, 120.0, 30.0, 60.0, 30.0, 0.0, 0.0, -30.0, 30.0, 0.0, 0.0, 60.0, 60.0, 0.0, 90.0, 30.0, 30.0, 90.0, 30.0, 30.0, 0.0, 60.0, 60.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 60.0, 60.0, 0.0, 30.0, 30.0, 0.0, 120.0, 30.0, 0.0, 60.0, 30.0, 30.0, 0.0, 60.0, 30.0, 30.0, 90.0, 30.0, 30.0, 30.0, 60.0, 90.0, 30.0, 30.0, 30.0, 60.0, 30.0, 30.0, 90.0, 60.0, 60.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 0.0, 90.0, 30.0, 30.0, 60.0, 60.0, 120.0, 0.0, 60.0, 30.0, 60.0, 60.0, 0.0, 30.0, 60.0, 60.0, 60.0, 60.0, 90.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7545973482231618, "mean_inference_ms": 57.3656245395147, "mean_action_processing_ms": 0.24110312585507096, "mean_env_wait_ms": 0.17133336300358376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 31000, "timesteps_this_iter": 40, "agent_timesteps_total": 31000, "timers": {"sample_time_ms": 3449.232, "sample_throughput": 11.597, "learn_time_ms": 2544.6, "learn_throughput": 15.72, "update_time_ms": 71.235}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.177427768707275, "grad_norm": 143.77447509765625, "td_error_abs": 2.1200890858968098, "q_taken_mean": 13.669071451822917, "target_mean": 12.68375956217448}}}, "num_steps_sampled": 31000, "num_agent_steps_sampled": 31000, "num_steps_trained": 31000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 30680, "num_target_updates": 59}, "done": false, "episodes_total": 3100, "training_iteration": 31, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-04-18", "timestamp": 1648883058, "time_this_iter_s": 85.21167731285095, "time_total_s": 2624.949919939041, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2624.949919939041, "timesteps_since_restore": 1240, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 23.34098360655738, "ram_util_percent": 66.38032786885245}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 46.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, -30.0, 60.0, 60.0, 120.0, 0.0, 30.0, 60.0, 90.0, 30.0, 60.0, 60.0, 60.0, 30.0, 30.0, 60.0, 60.0, 0.0, 30.0, 60.0, 60.0, 60.0, 30.0, 90.0, 30.0, 60.0, 0.0, 90.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 60.0, 0.0, 60.0, 30.0, 30.0, 0.0, 90.0, 90.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 30.0, 0.0, 60.0, 60.0, 0.0, 60.0, 60.0, 30.0, 30.0, 30.0, 30.0, 0.0, 30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, 120.0, 30.0, 30.0, 90.0, 30.0, 90.0, 30.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 60.0, 90.0, 90.0, 30.0, 60.0, 0.0, 30.0, 60.0, 0.0, 90.0, 90.0, 30.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7546610004409314, "mean_inference_ms": 57.38160872724618, "mean_action_processing_ms": 0.24109763691476271, "mean_env_wait_ms": 0.1713184621420193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 32000, "timesteps_this_iter": 40, "agent_timesteps_total": 32000, "timers": {"sample_time_ms": 3430.435, "sample_throughput": 11.66, "learn_time_ms": 2542.853, "learn_throughput": 15.73, "update_time_ms": 47.006}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 14.07944107055664, "grad_norm": 166.77354431152344, "td_error_abs": 3.030705769856771, "q_taken_mean": 14.929707845052084, "target_mean": 15.690662638346355}}}, "num_steps_sampled": 32000, "num_agent_steps_sampled": 32000, "num_steps_trained": 32000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 31720, "num_target_updates": 61}, "done": false, "episodes_total": 3200, "training_iteration": 32, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-05-43", "timestamp": 1648883143, "time_this_iter_s": 85.47519826889038, "time_total_s": 2710.4251182079315, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2710.4251182079315, "timesteps_since_restore": 1280, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 23.140983606557377, "ram_util_percent": 66.71065573770493}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 45.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 30.0, 90.0, 90.0, 30.0, 0.0, 0.0, 30.0, 60.0, 0.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 90.0, 0.0, 60.0, 30.0, 30.0, 0.0, 90.0, 30.0, 90.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 60.0, 60.0, 90.0, 90.0, 30.0, 90.0, 60.0, 0.0, 60.0, 90.0, 60.0, 0.0, 0.0, 30.0, 30.0, 60.0, 30.0, 90.0, 30.0, 0.0, 60.0, 90.0, 30.0, -30.0, 30.0, 60.0, 30.0, 90.0, 90.0, 60.0, 90.0, 60.0, 90.0, 0.0, 30.0, 90.0, 30.0, 60.0, 60.0, 30.0, 30.0, 60.0, 60.0, 0.0, 60.0, 30.0, 30.0, 60.0, 60.0, 90.0, 30.0, 0.0, 60.0, 30.0, 60.0, 60.0, 30.0, 30.0, 60.0, 30.0, 60.0, 60.0, 30.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7545551579297057, "mean_inference_ms": 57.39283988640795, "mean_action_processing_ms": 0.2411807497954053, "mean_env_wait_ms": 0.17132005349403, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 33000, "timesteps_this_iter": 40, "agent_timesteps_total": 33000, "timers": {"sample_time_ms": 3510.688, "sample_throughput": 11.394, "learn_time_ms": 2601.645, "learn_throughput": 15.375, "update_time_ms": 44.334}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.070206642150879, "grad_norm": 166.24269104003906, "td_error_abs": 2.4490394592285156, "q_taken_mean": 12.116499837239584, "target_mean": 13.352437337239584}}}, "num_steps_sampled": 33000, "num_agent_steps_sampled": 33000, "num_steps_trained": 33000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 32760, "num_target_updates": 63}, "done": false, "episodes_total": 3300, "training_iteration": 33, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-07-10", "timestamp": 1648883230, "time_this_iter_s": 86.42575573921204, "time_total_s": 2796.8508739471436, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2796.8508739471436, "timesteps_since_restore": 1320, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.30569105691057, "ram_util_percent": 67.08130081300813}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 47.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 90.0, 60.0, 30.0, 30.0, 30.0, 30.0, 30.0, 90.0, 90.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 60.0, 90.0, 30.0, 60.0, 90.0, 90.0, 30.0, 60.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, -30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 30.0, 90.0, 60.0, 90.0, 30.0, 60.0, 30.0, 30.0, 60.0, 90.0, 90.0, 60.0, 30.0, 60.0, 30.0, 30.0, 0.0, 60.0, 60.0, 30.0, 30.0, 60.0, 60.0, 0.0, 60.0, 60.0, 30.0, 60.0, 30.0, 60.0, 30.0, 0.0, 60.0, 0.0, 60.0, 30.0, 30.0, 30.0, 0.0, 60.0, 90.0, 30.0, 90.0, 60.0, 30.0, 30.0, 30.0, 30.0, 30.0, 0.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7548114227247358, "mean_inference_ms": 57.410944687480175, "mean_action_processing_ms": 0.24116054701392833, "mean_env_wait_ms": 0.1712823009479748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 34000, "timesteps_this_iter": 40, "agent_timesteps_total": 34000, "timers": {"sample_time_ms": 3368.636, "sample_throughput": 11.874, "learn_time_ms": 2526.985, "learn_throughput": 15.829, "update_time_ms": 44.545}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 16.68014144897461, "grad_norm": 206.25120544433594, "td_error_abs": 3.106861623128255, "q_taken_mean": 13.209076944986979, "target_mean": 13.950851440429688}}}, "num_steps_sampled": 34000, "num_agent_steps_sampled": 34000, "num_steps_trained": 34000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 33800, "num_target_updates": 65}, "done": false, "episodes_total": 3400, "training_iteration": 34, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-08-34", "timestamp": 1648883314, "time_this_iter_s": 84.54247546195984, "time_total_s": 2881.3933494091034, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2881.3933494091034, "timesteps_since_restore": 1360, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 23.430833333333336, "ram_util_percent": 67.425}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 42.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 60.0, 90.0, 30.0, 60.0, 30.0, 30.0, 60.0, 90.0, 60.0, 0.0, 60.0, 30.0, 90.0, 60.0, 0.0, 30.0, 30.0, 60.0, 90.0, 90.0, 90.0, 30.0, 30.0, 60.0, 0.0, 60.0, 60.0, 0.0, 60.0, 60.0, 30.0, 0.0, 60.0, 30.0, 60.0, 90.0, 60.0, 60.0, 0.0, 0.0, 30.0, 60.0, 0.0, 0.0, 60.0, 60.0, 30.0, 30.0, 90.0, 30.0, 30.0, 90.0, 60.0, 0.0, 0.0, 60.0, 0.0, 30.0, 60.0, -30.0, 60.0, 30.0, 60.0, 30.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 60.0, 60.0, 60.0, -30.0, 60.0, 30.0, 60.0, 0.0, 30.0, 90.0, 30.0, 30.0, 90.0, 30.0, 0.0, 60.0, 60.0, 30.0, 0.0, 30.0, 30.0, 0.0, 90.0, 60.0, 60.0, 30.0, 0.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.754537078097621, "mean_inference_ms": 57.39293426339958, "mean_action_processing_ms": 0.24108007531508818, "mean_env_wait_ms": 0.1712396218155251, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 35000, "timesteps_this_iter": 40, "agent_timesteps_total": 35000, "timers": {"sample_time_ms": 3355.507, "sample_throughput": 11.921, "learn_time_ms": 2533.644, "learn_throughput": 15.788, "update_time_ms": 44.256}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.367769241333008, "grad_norm": 152.8482666015625, "td_error_abs": 2.937078603108724, "q_taken_mean": 14.586308797200521, "target_mean": 13.991839599609374}}}, "num_steps_sampled": 35000, "num_agent_steps_sampled": 35000, "num_steps_trained": 35000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 34840, "num_target_updates": 67}, "done": false, "episodes_total": 3500, "training_iteration": 35, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-09-59", "timestamp": 1648883399, "time_this_iter_s": 84.69011116027832, "time_total_s": 2966.0834605693817, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2966.0834605693817, "timesteps_since_restore": 1400, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 23.04876033057851, "ram_util_percent": 67.63801652892563}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 44.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 30.0, 30.0, 60.0, 0.0, 60.0, 60.0, 0.0, 30.0, 30.0, 60.0, 60.0, 30.0, 90.0, 0.0, 30.0, 30.0, 60.0, 90.0, 30.0, 60.0, 60.0, 30.0, 0.0, -30.0, 0.0, 60.0, 0.0, 90.0, 60.0, 60.0, 60.0, 90.0, 0.0, 30.0, 90.0, 90.0, 60.0, 60.0, 0.0, 0.0, 30.0, 30.0, 60.0, 90.0, 60.0, 60.0, 60.0, 30.0, 90.0, 60.0, 60.0, 30.0, 60.0, 60.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 60.0, 30.0, 0.0, 60.0, 90.0, 0.0, 60.0, 0.0, 90.0, 60.0, 60.0, 60.0, -30.0, 60.0, 30.0, 60.0, 30.0, 30.0, 90.0, 60.0, 60.0, 30.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 30.0, -30.0, 0.0, 30.0, 90.0, 120.0, 60.0, 60.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7583379824947432, "mean_inference_ms": 57.630564845703596, "mean_action_processing_ms": 0.24218298887997228, "mean_env_wait_ms": 0.171853136902398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 36000, "timesteps_this_iter": 40, "agent_timesteps_total": 36000, "timers": {"sample_time_ms": 3992.306, "sample_throughput": 10.019, "learn_time_ms": 2955.596, "learn_throughput": 13.534, "update_time_ms": 49.501}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.626089096069336, "grad_norm": 162.83248901367188, "td_error_abs": 2.4733184814453124, "q_taken_mean": 16.083315022786458, "target_mean": 15.004548136393229}}}, "num_steps_sampled": 36000, "num_agent_steps_sampled": 36000, "num_steps_trained": 36000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 35880, "num_target_updates": 69}, "done": false, "episodes_total": 3600, "training_iteration": 36, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-11-36", "timestamp": 1648883496, "time_this_iter_s": 97.16682887077332, "time_total_s": 3063.250289440155, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3063.250289440155, "timesteps_since_restore": 1440, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 23.90071942446043, "ram_util_percent": 67.92733812949642}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 43.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 30.0, 60.0, 60.0, 30.0, 90.0, 30.0, 0.0, 60.0, 30.0, 60.0, 60.0, 60.0, 30.0, 0.0, 60.0, 0.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 0.0, 0.0, 90.0, 90.0, 60.0, 0.0, 60.0, 30.0, 60.0, 0.0, 60.0, 30.0, 30.0, 60.0, 90.0, 90.0, 0.0, 30.0, 30.0, 60.0, 0.0, 90.0, 30.0, 30.0, 60.0, 30.0, 30.0, 0.0, 60.0, 60.0, 30.0, -30.0, 0.0, 60.0, 90.0, 90.0, 60.0, 0.0, 30.0, 0.0, 60.0, 30.0, 60.0, 30.0, 60.0, 90.0, 60.0, 60.0, 60.0, 90.0, 60.0, 0.0, 0.0, 60.0, 30.0, 120.0, 30.0, 30.0, 30.0, 0.0, 30.0, 30.0, 90.0, 60.0, 90.0, 30.0, 30.0, 60.0, 60.0, 30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7647243387285997, "mean_inference_ms": 58.014708581505275, "mean_action_processing_ms": 0.24368966312591947, "mean_env_wait_ms": 0.17299931470206867, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 37000, "timesteps_this_iter": 40, "agent_timesteps_total": 37000, "timers": {"sample_time_ms": 4233.465, "sample_throughput": 9.449, "learn_time_ms": 3105.198, "learn_throughput": 12.882, "update_time_ms": 51.195}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 16.758708953857422, "grad_norm": 304.88775634765625, "td_error_abs": 3.351563008626302, "q_taken_mean": 17.791560872395834, "target_mean": 18.104012044270835}}}, "num_steps_sampled": 37000, "num_agent_steps_sampled": 37000, "num_steps_trained": 37000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 36920, "num_target_updates": 71}, "done": false, "episodes_total": 3700, "training_iteration": 37, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-13-20", "timestamp": 1648883600, "time_this_iter_s": 103.24592900276184, "time_total_s": 3166.496218442917, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3166.496218442917, "timesteps_since_restore": 1480, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.220408163265304, "ram_util_percent": 68.25646258503401}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 46.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 0.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 30.0, 30.0, 60.0, 90.0, 90.0, 30.0, 60.0, 30.0, 60.0, 30.0, 30.0, 0.0, 30.0, 30.0, 90.0, 30.0, 60.0, 30.0, 90.0, 60.0, 30.0, 60.0, 0.0, 30.0, 90.0, 60.0, 60.0, 90.0, 30.0, 30.0, 90.0, 0.0, 60.0, 60.0, 90.0, 60.0, 0.0, 30.0, 30.0, 60.0, 120.0, 30.0, 30.0, 30.0, 60.0, 90.0, 60.0, 90.0, 30.0, 30.0, 60.0, 120.0, 60.0, 30.0, 60.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 60.0, 60.0, 0.0, 30.0, 60.0, 0.0, 30.0, 30.0, 30.0, 90.0, 60.0, 60.0, 30.0, 60.0, 90.0, 60.0, 60.0, 30.0, 60.0, 0.0, 60.0, 60.0, 60.0, 90.0, 30.0, 30.0, 0.0, 30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7693381475631899, "mean_inference_ms": 58.28247783861841, "mean_action_processing_ms": 0.2446755737069405, "mean_env_wait_ms": 0.1737613726159094, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 38000, "timesteps_this_iter": 40, "agent_timesteps_total": 38000, "timers": {"sample_time_ms": 3668.703, "sample_throughput": 10.903, "learn_time_ms": 2753.855, "learn_throughput": 14.525, "update_time_ms": 47.441}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.604292869567871, "grad_norm": 157.37344360351562, "td_error_abs": 2.758162180582682, "q_taken_mean": 20.868764241536457, "target_mean": 20.3760009765625}}}, "num_steps_sampled": 38000, "num_agent_steps_sampled": 38000, "num_steps_trained": 38000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 37960, "num_target_updates": 73}, "done": false, "episodes_total": 3800, "training_iteration": 38, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-14-58", "timestamp": 1648883698, "time_this_iter_s": 98.39275240898132, "time_total_s": 3264.888970851898, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3264.888970851898, "timesteps_since_restore": 1520, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 23.857142857142858, "ram_util_percent": 68.54357142857141}}
{"episode_reward_max": 150.0, "episode_reward_min": -30.0, "episode_reward_mean": 47.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 30.0, 90.0, 30.0, 30.0, 0.0, 30.0, 30.0, 0.0, 60.0, 0.0, 60.0, 90.0, 120.0, 30.0, 60.0, 90.0, 60.0, 90.0, 90.0, 0.0, 30.0, 0.0, 60.0, 60.0, 30.0, 0.0, 60.0, 60.0, 90.0, 0.0, 30.0, 90.0, 60.0, 0.0, 0.0, 90.0, 60.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 0.0, 0.0, 0.0, 30.0, 90.0, 90.0, 0.0, 30.0, 60.0, 60.0, 120.0, -30.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 60.0, 60.0, 60.0, 90.0, 30.0, 30.0, 90.0, 0.0, 90.0, 0.0, 30.0, 60.0, 30.0, 30.0, 120.0, 90.0, 30.0, 30.0, 0.0, 90.0, -30.0, 30.0, 30.0, 60.0, 30.0, 30.0, 0.0, 60.0, 90.0, 60.0, 30.0, 150.0, 30.0, 30.0, 90.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7727347805663604, "mean_inference_ms": 58.521192271383555, "mean_action_processing_ms": 0.2456252152657413, "mean_env_wait_ms": 0.1744137899825028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 39000, "timesteps_this_iter": 40, "agent_timesteps_total": 39000, "timers": {"sample_time_ms": 3928.701, "sample_throughput": 10.181, "learn_time_ms": 2884.487, "learn_throughput": 13.867, "update_time_ms": 49.939}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 15.2744140625, "grad_norm": 294.68243408203125, "td_error_abs": 3.025469970703125, "q_taken_mean": 18.781905110677084, "target_mean": 20.22330118815104}}}, "num_steps_sampled": 39000, "num_agent_steps_sampled": 39000, "num_steps_trained": 39000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 39000, "num_target_updates": 75}, "done": false, "episodes_total": 3900, "training_iteration": 39, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-16-34", "timestamp": 1648883794, "time_this_iter_s": 95.76766347885132, "time_total_s": 3360.6566343307495, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3360.6566343307495, "timesteps_since_restore": 1560, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 24.116058394160586, "ram_util_percent": 68.86934306569341}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 43.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 90.0, 0.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 0.0, 30.0, 60.0, 60.0, 60.0, 30.0, 60.0, 60.0, 30.0, 0.0, 90.0, 30.0, 0.0, 60.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 0.0, 60.0, 30.0, 30.0, 30.0, 60.0, 60.0, 0.0, 60.0, 30.0, 30.0, 90.0, 60.0, 90.0, 60.0, 30.0, 30.0, 90.0, 0.0, 30.0, 90.0, 60.0, 30.0, 30.0, 0.0, 30.0, 30.0, 60.0, 30.0, 90.0, 30.0, -30.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7765741303448391, "mean_inference_ms": 58.78419220393901, "mean_action_processing_ms": 0.24652176529821684, "mean_env_wait_ms": 0.17511199777239064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 40000, "timesteps_this_iter": 40, "agent_timesteps_total": 40000, "timers": {"sample_time_ms": 3966.232, "sample_throughput": 10.085, "learn_time_ms": 2945.248, "learn_throughput": 13.581, "update_time_ms": 57.721}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.284444808959961, "grad_norm": 155.30645751953125, "td_error_abs": 2.2917686462402345, "q_taken_mean": 16.018680826822916, "target_mean": 15.003411865234375}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 40000, "num_steps_trained": 40000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 39520, "num_target_updates": 76}, "done": false, "episodes_total": 4000, "training_iteration": 40, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-18-11", "timestamp": 1648883891, "time_this_iter_s": 97.59056735038757, "time_total_s": 3458.247201681137, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3458.247201681137, "timesteps_since_restore": 1600, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 24.16690647482014, "ram_util_percent": 69.12014388489209}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 48.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 90.0, 60.0, 0.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 0.0, 90.0, 60.0, 30.0, 30.0, 30.0, 60.0, 30.0, 90.0, 90.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 90.0, 0.0, 30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 90.0, 30.0, 90.0, 60.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 90.0, 60.0, 90.0, 30.0, 30.0, 30.0, 90.0, 30.0, 60.0, 90.0, 60.0, 0.0, 30.0, 30.0, 60.0, 0.0, 60.0, 120.0, 30.0, 90.0, 60.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 90.0, 30.0, 90.0, 30.0, 0.0, 90.0, 30.0, 90.0, 30.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7800702792402012, "mean_inference_ms": 59.03428205105515, "mean_action_processing_ms": 0.24727751785180074, "mean_env_wait_ms": 0.1756984447225829, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 41000, "timesteps_this_iter": 40, "agent_timesteps_total": 41000, "timers": {"sample_time_ms": 3853.5, "sample_throughput": 10.38, "learn_time_ms": 2836.006, "learn_throughput": 14.104, "update_time_ms": 48.655}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 16.447023391723633, "grad_norm": 254.9403839111328, "td_error_abs": 3.2156394958496093, "q_taken_mean": 18.159611002604166, "target_mean": 19.57356160481771}}}, "num_steps_sampled": 41000, "num_agent_steps_sampled": 41000, "num_steps_trained": 41000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 40560, "num_target_updates": 78}, "done": false, "episodes_total": 4100, "training_iteration": 41, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-19-48", "timestamp": 1648883988, "time_this_iter_s": 96.76488304138184, "time_total_s": 3555.012084722519, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3555.012084722519, "timesteps_since_restore": 1640, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 23.946376811594206, "ram_util_percent": 69.3768115942029}}
{"episode_reward_max": 90.0, "episode_reward_min": -30.0, "episode_reward_mean": 48.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 60.0, 30.0, 60.0, 30.0, 90.0, 0.0, 90.0, 60.0, 60.0, 60.0, 30.0, 60.0, 30.0, 60.0, 30.0, 30.0, 30.0, 0.0, 90.0, 30.0, 60.0, 30.0, 60.0, 90.0, 60.0, 60.0, 30.0, 60.0, 90.0, 60.0, 0.0, 30.0, 60.0, 30.0, 90.0, 30.0, 0.0, 60.0, 90.0, 30.0, 30.0, 90.0, 30.0, 30.0, 30.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 30.0, 30.0, 60.0, 0.0, 30.0, 60.0, 30.0, 30.0, 60.0, 60.0, 90.0, 60.0, -30.0, 90.0, 0.0, -30.0, 90.0, 60.0, 60.0, 30.0, 60.0, 60.0, 60.0, 30.0, 0.0, 30.0, -30.0, 90.0, 60.0, 90.0, 0.0, 90.0, 60.0, 60.0, 60.0, 30.0, 30.0, 90.0, 60.0, 90.0, 30.0, 90.0, 30.0, 60.0, 90.0, 90.0, 90.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7830222678540971, "mean_inference_ms": 59.25815321810871, "mean_action_processing_ms": 0.24798825495289165, "mean_env_wait_ms": 0.1761992991895815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 42000, "timesteps_this_iter": 40, "agent_timesteps_total": 42000, "timers": {"sample_time_ms": 3791.84, "sample_throughput": 10.549, "learn_time_ms": 2802.312, "learn_throughput": 14.274, "update_time_ms": 49.905}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 14.942307472229004, "grad_norm": 180.9961700439453, "td_error_abs": 3.273545328776042, "q_taken_mean": 18.5311767578125, "target_mean": 17.313765462239584}}}, "num_steps_sampled": 42000, "num_agent_steps_sampled": 42000, "num_steps_trained": 42000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 41600, "num_target_updates": 80}, "done": false, "episodes_total": 4200, "training_iteration": 42, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-21-25", "timestamp": 1648884085, "time_this_iter_s": 96.26526308059692, "time_total_s": 3651.277347803116, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3651.277347803116, "timesteps_since_restore": 1680, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 23.936496350364962, "ram_util_percent": 69.75766423357663}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 51.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 90.0, 30.0, 60.0, 60.0, 30.0, 90.0, 90.0, 0.0, 30.0, 60.0, 60.0, 30.0, 30.0, 60.0, 30.0, 60.0, 30.0, 120.0, 60.0, 30.0, 90.0, 30.0, 90.0, 60.0, 60.0, 30.0, 120.0, 30.0, 30.0, 0.0, 30.0, 0.0, 30.0, 60.0, 90.0, 0.0, 30.0, 30.0, 30.0, 90.0, 90.0, 60.0, 30.0, 60.0, 90.0, 30.0, 30.0, 60.0, 90.0, 90.0, 60.0, 30.0, 30.0, 60.0, 60.0, 0.0, 90.0, 90.0, 60.0, 30.0, 30.0, 30.0, 90.0, 60.0, 120.0, 30.0, 0.0, 90.0, 90.0, 90.0, 0.0, 30.0, 30.0, 60.0, 60.0, 0.0, 90.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 30.0, 0.0, 30.0, 90.0, 30.0, 90.0, 90.0, 60.0, 60.0, 60.0, 30.0, 0.0, 60.0, 30.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7864741234100319, "mean_inference_ms": 59.4704449592596, "mean_action_processing_ms": 0.2488581072662101, "mean_env_wait_ms": 0.17677943724918874, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 43000, "timesteps_this_iter": 40, "agent_timesteps_total": 43000, "timers": {"sample_time_ms": 3846.945, "sample_throughput": 10.398, "learn_time_ms": 2825.62, "learn_throughput": 14.156, "update_time_ms": 62.403}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 12.229948997497559, "grad_norm": 213.72003173828125, "td_error_abs": 2.690743001302083, "q_taken_mean": 18.41970011393229, "target_mean": 19.368180338541666}}}, "num_steps_sampled": 43000, "num_agent_steps_sampled": 43000, "num_steps_trained": 43000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 42640, "num_target_updates": 82}, "done": false, "episodes_total": 4300, "training_iteration": 43, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-23-02", "timestamp": 1648884182, "time_this_iter_s": 97.3032329082489, "time_total_s": 3748.5805807113647, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3748.5805807113647, "timesteps_since_restore": 1720, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 23.841726618705035, "ram_util_percent": 70.04964028776979}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 53.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 0.0, 60.0, 90.0, 120.0, 90.0, 30.0, 90.0, 60.0, 90.0, 120.0, 30.0, 30.0, 90.0, 60.0, 60.0, 60.0, 90.0, 60.0, 60.0, 60.0, 30.0, 90.0, 60.0, 90.0, 30.0, 60.0, 30.0, 90.0, 60.0, 30.0, 60.0, 60.0, 30.0, -30.0, 60.0, 30.0, 30.0, 0.0, 60.0, 90.0, 30.0, 0.0, 90.0, 30.0, 60.0, 30.0, 90.0, 30.0, 90.0, 60.0, 90.0, 30.0, 90.0, 60.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 90.0, 0.0, 30.0, 30.0, 90.0, 60.0, 30.0, 30.0, 60.0, 60.0, 90.0, 60.0, 60.0, 30.0, 60.0, 90.0, 60.0, 90.0, 30.0, 90.0, 30.0, 30.0, 60.0, 60.0, 90.0, 0.0, 60.0, 60.0, 60.0, 60.0, 0.0, 30.0, 30.0, 30.0, 60.0, 30.0, 30.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7892426778247017, "mean_inference_ms": 59.68357910731524, "mean_action_processing_ms": 0.2496127713410359, "mean_env_wait_ms": 0.17727910253245469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 44000, "timesteps_this_iter": 40, "agent_timesteps_total": 44000, "timers": {"sample_time_ms": 3917.731, "sample_throughput": 10.21, "learn_time_ms": 2859.695, "learn_throughput": 13.988, "update_time_ms": 50.241}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.778496742248535, "grad_norm": 70.14535522460938, "td_error_abs": 1.8599402109781902, "q_taken_mean": 15.500782267252605, "target_mean": 15.628780110677083}}}, "num_steps_sampled": 44000, "num_agent_steps_sampled": 44000, "num_steps_trained": 44000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 43680, "num_target_updates": 84}, "done": false, "episodes_total": 4400, "training_iteration": 44, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-24-39", "timestamp": 1648884279, "time_this_iter_s": 96.63249492645264, "time_total_s": 3845.2130756378174, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3845.2130756378174, "timesteps_since_restore": 1760, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 24.001449275362326, "ram_util_percent": 70.30362318840581}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 51.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 90.0, 60.0, 60.0, 30.0, 30.0, 90.0, 0.0, 30.0, 0.0, 60.0, 30.0, 30.0, 30.0, 0.0, 60.0, 0.0, 30.0, 90.0, 0.0, 30.0, 30.0, 60.0, 90.0, 30.0, 60.0, 90.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 90.0, 90.0, 30.0, 60.0, 90.0, 60.0, 60.0, 60.0, 60.0, 30.0, 30.0, 60.0, 30.0, 90.0, 60.0, 90.0, 90.0, 60.0, 90.0, 90.0, 60.0, 90.0, -30.0, 30.0, 90.0, 30.0, 90.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 60.0, 30.0, 90.0, 60.0, 60.0, 0.0, 30.0, 60.0, 30.0, 60.0, 90.0, 30.0, 90.0, 30.0, 60.0, 90.0, 60.0, 30.0, 30.0, 60.0, 60.0, 90.0, 0.0, 90.0, 60.0, 30.0, 30.0, 60.0, 90.0, 120.0, 30.0, 60.0, 60.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7919697388152358, "mean_inference_ms": 59.86238495952426, "mean_action_processing_ms": 0.25021539837633194, "mean_env_wait_ms": 0.17766530922111662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 45000, "timesteps_this_iter": 40, "agent_timesteps_total": 45000, "timers": {"sample_time_ms": 3870.686, "sample_throughput": 10.334, "learn_time_ms": 2840.385, "learn_throughput": 14.083, "update_time_ms": 52.948}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.072908401489258, "grad_norm": 227.59083557128906, "td_error_abs": 2.6006754557291667, "q_taken_mean": 20.808835856119792, "target_mean": 19.54135945638021}}}, "num_steps_sampled": 45000, "num_agent_steps_sampled": 45000, "num_steps_trained": 45000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 44720, "num_target_updates": 86}, "done": false, "episodes_total": 4500, "training_iteration": 45, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-26-14", "timestamp": 1648884374, "time_this_iter_s": 95.94662189483643, "time_total_s": 3941.159697532654, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3941.159697532654, "timesteps_since_restore": 1800, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 24.06934306569343, "ram_util_percent": 70.61532846715328}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 56.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 90.0, 60.0, 90.0, 120.0, 60.0, 90.0, 30.0, 90.0, 60.0, 60.0, 0.0, 60.0, 60.0, 60.0, 0.0, 30.0, 120.0, 60.0, 60.0, 30.0, 60.0, 60.0, 90.0, 90.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 90.0, 30.0, 60.0, 90.0, 30.0, 60.0, 60.0, 30.0, 60.0, 0.0, 0.0, 30.0, 60.0, 60.0, 60.0, 30.0, 30.0, 30.0, 30.0, 60.0, 90.0, 60.0, 30.0, 60.0, 90.0, 60.0, 0.0, 30.0, 90.0, 90.0, 60.0, 90.0, 30.0, 60.0, 0.0, 60.0, 60.0, 90.0, 30.0, 60.0, 0.0, 60.0, 60.0, 30.0, 90.0, 60.0, 30.0, 60.0, 60.0, 0.0, 90.0, 0.0, 90.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 60.0, 90.0, 30.0, 60.0, 90.0, 90.0, 90.0, 30.0, 90.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7954854859900305, "mean_inference_ms": 60.0953954228649, "mean_action_processing_ms": 0.2510282187117316, "mean_env_wait_ms": 0.17824400280799138, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 46000, "timesteps_this_iter": 40, "agent_timesteps_total": 46000, "timers": {"sample_time_ms": 3941.802, "sample_throughput": 10.148, "learn_time_ms": 2897.37, "learn_throughput": 13.806, "update_time_ms": 49.467}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 13.107722282409668, "grad_norm": 184.97817993164062, "td_error_abs": 2.627013651529948, "q_taken_mean": 17.430635579427083, "target_mean": 18.70169881184896}}}, "num_steps_sampled": 46000, "num_agent_steps_sampled": 46000, "num_steps_trained": 46000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 45760, "num_target_updates": 88}, "done": false, "episodes_total": 4600, "training_iteration": 46, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-27-52", "timestamp": 1648884472, "time_this_iter_s": 97.74465537071228, "time_total_s": 4038.904352903366, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4038.904352903366, "timesteps_since_restore": 1840, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 24.20863309352518, "ram_util_percent": 70.85611510791367}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 57.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 30.0, 60.0, 60.0, 30.0, 90.0, 90.0, 90.0, 30.0, 90.0, 0.0, 90.0, 90.0, 90.0, 60.0, 30.0, 90.0, 120.0, 60.0, 30.0, 90.0, 90.0, 60.0, 90.0, 60.0, 30.0, 30.0, 30.0, 90.0, 60.0, 30.0, 60.0, 60.0, 0.0, 60.0, 0.0, 0.0, 30.0, 60.0, 90.0, 30.0, 30.0, 120.0, 60.0, 30.0, 30.0, 0.0, 90.0, 30.0, 60.0, 90.0, 90.0, 0.0, 120.0, 90.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 90.0, 30.0, 0.0, 30.0, 30.0, 60.0, 60.0, 60.0, 90.0, 90.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 120.0, 60.0, 90.0, 90.0, 60.0, 60.0, 90.0, 90.0, 90.0, 30.0, 60.0, 60.0, 0.0, 60.0, 90.0, 60.0, 30.0, 90.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7981766224840773, "mean_inference_ms": 60.2808840406082, "mean_action_processing_ms": 0.25171983922738106, "mean_env_wait_ms": 0.17871686057145209, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 47000, "timesteps_this_iter": 40, "agent_timesteps_total": 47000, "timers": {"sample_time_ms": 3876.486, "sample_throughput": 10.319, "learn_time_ms": 2895.552, "learn_throughput": 13.814, "update_time_ms": 61.603}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 16.73361587524414, "grad_norm": 242.5756072998047, "td_error_abs": 2.9428743998209637, "q_taken_mean": 21.670560709635417, "target_mean": 20.98626708984375}}}, "num_steps_sampled": 47000, "num_agent_steps_sampled": 47000, "num_steps_trained": 47000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 46800, "num_target_updates": 90}, "done": false, "episodes_total": 4700, "training_iteration": 47, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-29-30", "timestamp": 1648884570, "time_this_iter_s": 97.3403422832489, "time_total_s": 4136.244695186615, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4136.244695186615, "timesteps_since_restore": 1880, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.358992805755395, "ram_util_percent": 71.2115107913669}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 55.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 120.0, 60.0, 60.0, 0.0, 60.0, 0.0, 60.0, 90.0, 60.0, 90.0, 60.0, 90.0, 30.0, 60.0, 60.0, 90.0, 60.0, 0.0, 60.0, 30.0, 90.0, 60.0, 30.0, 30.0, 90.0, 60.0, 60.0, 60.0, 90.0, 30.0, 60.0, 60.0, 90.0, 60.0, 120.0, 60.0, 30.0, 60.0, 30.0, 60.0, 60.0, 60.0, 90.0, 0.0, 90.0, 0.0, 30.0, 60.0, 90.0, 90.0, 30.0, 90.0, 60.0, 90.0, 30.0, 30.0, 60.0, 90.0, 30.0, 60.0, 0.0, 60.0, 30.0, 0.0, 30.0, 30.0, 60.0, 60.0, 90.0, 60.0, 90.0, 30.0, 60.0, 60.0, 90.0, 60.0, 0.0, 60.0, 60.0, 0.0, 60.0, 60.0, 30.0, 30.0, 90.0, 60.0, 60.0, 60.0, 30.0, 60.0, 60.0, 90.0, 30.0, 90.0, 60.0, 0.0, 60.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.800716858110411, "mean_inference_ms": 60.46823293663505, "mean_action_processing_ms": 0.25239884083533876, "mean_env_wait_ms": 0.1792968208517057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 48000, "timesteps_this_iter": 40, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 3842.505, "sample_throughput": 10.41, "learn_time_ms": 2804.9, "learn_throughput": 14.261, "update_time_ms": 51.944}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.735197067260742, "grad_norm": 89.74702453613281, "td_error_abs": 1.741729736328125, "q_taken_mean": 15.833350626627604, "target_mean": 15.654410807291667}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 48000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 47840, "num_target_updates": 92}, "done": false, "episodes_total": 4800, "training_iteration": 48, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-31-05", "timestamp": 1648884665, "time_this_iter_s": 95.77252340316772, "time_total_s": 4232.017218589783, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4232.017218589783, "timesteps_since_restore": 1920, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 23.777205882352945, "ram_util_percent": 71.48088235294118}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 58.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 60.0, 90.0, 90.0, 90.0, 60.0, 30.0, 60.0, 60.0, 120.0, 30.0, 60.0, 90.0, 90.0, 30.0, 0.0, 60.0, 60.0, 90.0, 30.0, 90.0, 60.0, 30.0, 60.0, 90.0, 90.0, 90.0, 90.0, 60.0, 0.0, 30.0, 60.0, 30.0, 60.0, 60.0, 30.0, 30.0, 30.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 90.0, 90.0, 60.0, 60.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 30.0, 30.0, 60.0, 90.0, 30.0, 60.0, 30.0, 90.0, 30.0, 90.0, 60.0, 60.0, 90.0, 120.0, 60.0, 90.0, 60.0, 60.0, 30.0, 90.0, 60.0, 90.0, 60.0, 90.0, 30.0, 60.0, 60.0, 60.0, 90.0, 90.0, 90.0, 30.0, 60.0, 30.0, 60.0, 60.0, 90.0, 90.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8031137524191369, "mean_inference_ms": 60.64972067626581, "mean_action_processing_ms": 0.25298582097577343, "mean_env_wait_ms": 0.1796496059444815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 49000, "timesteps_this_iter": 40, "agent_timesteps_total": 49000, "timers": {"sample_time_ms": 3807.019, "sample_throughput": 10.507, "learn_time_ms": 2790.317, "learn_throughput": 14.335, "update_time_ms": 53.199}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.108986854553223, "grad_norm": 119.89480590820312, "td_error_abs": 2.594677225748698, "q_taken_mean": 18.33814697265625, "target_mean": 18.702272542317708}}}, "num_steps_sampled": 49000, "num_agent_steps_sampled": 49000, "num_steps_trained": 49000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 48880, "num_target_updates": 94}, "done": false, "episodes_total": 4900, "training_iteration": 49, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-32-42", "timestamp": 1648884762, "time_this_iter_s": 96.14562654495239, "time_total_s": 4328.162845134735, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4328.162845134735, "timesteps_since_restore": 1960, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 24.230656934306566, "ram_util_percent": 71.84233576642336}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 58.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 60.0, 60.0, 60.0, 30.0, 60.0, 90.0, 60.0, 90.0, 30.0, 30.0, 90.0, 60.0, 0.0, 90.0, 60.0, 60.0, 0.0, 90.0, 60.0, 90.0, 90.0, 60.0, 30.0, 30.0, 90.0, 60.0, 60.0, 60.0, 60.0, 0.0, 90.0, 30.0, 60.0, 90.0, 60.0, 90.0, 30.0, 120.0, 60.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 90.0, 90.0, 90.0, 60.0, 0.0, 90.0, 30.0, 90.0, 90.0, 30.0, 90.0, 60.0, 60.0, 90.0, 60.0, 90.0, 60.0, -30.0, 90.0, 60.0, 120.0, 60.0, 60.0, -30.0, 60.0, 90.0, 90.0, 30.0, 60.0, 30.0, 90.0, 30.0, 0.0, 60.0, 30.0, 60.0, 90.0, 30.0, 30.0, 60.0, 60.0, 90.0, 60.0, 90.0, 60.0, 90.0, 90.0, 30.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8062452433080864, "mean_inference_ms": 60.868387255284524, "mean_action_processing_ms": 0.25386062586520175, "mean_env_wait_ms": 0.1801539684198311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 50000, "timesteps_this_iter": 40, "agent_timesteps_total": 50000, "timers": {"sample_time_ms": 4145.12, "sample_throughput": 9.65, "learn_time_ms": 3025.521, "learn_throughput": 13.221, "update_time_ms": 60.272}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.232237815856934, "grad_norm": 185.638916015625, "td_error_abs": 2.67187983194987, "q_taken_mean": 18.02186482747396, "target_mean": 17.226090494791666}}}, "num_steps_sampled": 50000, "num_agent_steps_sampled": 50000, "num_steps_trained": 50000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 49920, "num_target_updates": 96}, "done": false, "episodes_total": 5000, "training_iteration": 50, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-34-22", "timestamp": 1648884862, "time_this_iter_s": 100.29791283607483, "time_total_s": 4428.46075797081, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4428.46075797081, "timesteps_since_restore": 2000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 24.67902097902098, "ram_util_percent": 72.13006993006992}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 58.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 60.0, 90.0, 30.0, 30.0, 30.0, 30.0, 60.0, 60.0, 0.0, 0.0, 60.0, 120.0, 30.0, 60.0, 120.0, 30.0, 60.0, 60.0, 90.0, 60.0, 90.0, 60.0, 90.0, 60.0, 60.0, 30.0, 90.0, 0.0, 30.0, 60.0, 60.0, 90.0, 120.0, 60.0, 60.0, 120.0, 60.0, 0.0, 60.0, 60.0, 30.0, 60.0, 60.0, 90.0, 90.0, 60.0, 60.0, 90.0, 30.0, 120.0, 30.0, 90.0, 60.0, 60.0, 60.0, 90.0, 30.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 30.0, 60.0, 30.0, 90.0, 90.0, 30.0, 60.0, 120.0, 90.0, 90.0, 60.0, 60.0, 60.0, 60.0, 60.0, 90.0, 60.0, 0.0, 60.0, 0.0, 30.0, 90.0, 0.0, 60.0, 60.0, 60.0, 90.0, 90.0, 60.0, 30.0, 30.0, 90.0, 90.0, 60.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8097514761409501, "mean_inference_ms": 61.07306380373256, "mean_action_processing_ms": 0.2546701587589944, "mean_env_wait_ms": 0.18074046246314196, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 51000, "timesteps_this_iter": 40, "agent_timesteps_total": 51000, "timers": {"sample_time_ms": 4015.431, "sample_throughput": 9.962, "learn_time_ms": 2980.947, "learn_throughput": 13.419, "update_time_ms": 55.703}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.81669807434082, "grad_norm": 128.09957885742188, "td_error_abs": 2.3358993530273438, "q_taken_mean": 18.141988118489582, "target_mean": 18.43412882486979}}}, "num_steps_sampled": 51000, "num_agent_steps_sampled": 51000, "num_steps_trained": 51000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 50960, "num_target_updates": 98}, "done": false, "episodes_total": 5100, "training_iteration": 51, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-36-01", "timestamp": 1648884961, "time_this_iter_s": 99.0315809249878, "time_total_s": 4527.492338895798, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4527.492338895798, "timesteps_since_restore": 2040, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.78723404255319, "ram_util_percent": 72.4886524822695}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 59.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 60.0, 30.0, 60.0, 0.0, 30.0, 0.0, 30.0, 60.0, 90.0, 60.0, 60.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 30.0, 30.0, 60.0, 90.0, 60.0, 30.0, 60.0, 90.0, 120.0, 60.0, 90.0, 90.0, 90.0, 60.0, 30.0, 0.0, 90.0, 30.0, 30.0, 90.0, 30.0, 60.0, 60.0, 30.0, 60.0, 90.0, 90.0, 60.0, 60.0, 60.0, 30.0, 90.0, 60.0, 60.0, 30.0, 60.0, 30.0, 90.0, 90.0, 60.0, 60.0, 90.0, 30.0, 90.0, 90.0, 90.0, 60.0, 120.0, 90.0, 30.0, 30.0, 30.0, 60.0, 60.0, 60.0, 90.0, 0.0, 60.0, 60.0, 90.0, 30.0, 60.0, 60.0, 90.0, 90.0, 90.0, 60.0, 60.0, 60.0, 60.0, 60.0, 90.0, 30.0, 60.0, 90.0, 60.0, 60.0, 60.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8118266912985099, "mean_inference_ms": 61.22031890193404, "mean_action_processing_ms": 0.2552008740709943, "mean_env_wait_ms": 0.1812171417056171, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 52000, "timesteps_this_iter": 40, "agent_timesteps_total": 52000, "timers": {"sample_time_ms": 3880.689, "sample_throughput": 10.307, "learn_time_ms": 2832.362, "learn_throughput": 14.122, "update_time_ms": 52.754}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.418285369873047, "grad_norm": 175.3048858642578, "td_error_abs": 2.3523760477701825, "q_taken_mean": 15.31752217610677, "target_mean": 16.234241739908853}}}, "num_steps_sampled": 52000, "num_agent_steps_sampled": 52000, "num_steps_trained": 52000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 52000, "num_target_updates": 100}, "done": false, "episodes_total": 5200, "training_iteration": 52, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-37-36", "timestamp": 1648885056, "time_this_iter_s": 94.87623190879822, "time_total_s": 4622.368570804596, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4622.368570804596, "timesteps_since_restore": 2080, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 24.08, "ram_util_percent": 72.76148148148148}}
{"episode_reward_max": 150.0, "episode_reward_min": -30.0, "episode_reward_mean": 59.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 60.0, 90.0, 150.0, 120.0, 90.0, 90.0, 30.0, 60.0, 120.0, 60.0, 60.0, 30.0, 60.0, 60.0, 90.0, 0.0, 30.0, 0.0, 30.0, 60.0, 90.0, 60.0, 90.0, 60.0, 30.0, 60.0, 90.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 90.0, 30.0, 90.0, 60.0, 90.0, 90.0, 60.0, 60.0, 90.0, 30.0, 60.0, 90.0, 90.0, 90.0, 60.0, 60.0, 30.0, 30.0, 60.0, 90.0, 30.0, 30.0, 60.0, 60.0, 90.0, 0.0, 60.0, 60.0, 30.0, 60.0, 30.0, 90.0, 90.0, 60.0, 60.0, 60.0, 90.0, 60.0, 60.0, 120.0, 60.0, -30.0, 30.0, 30.0, 60.0, 90.0, 30.0, 60.0, 0.0, 60.0, 30.0, 90.0, 30.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 90.0, 0.0, 60.0, 90.0, 90.0, 60.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8140414510166574, "mean_inference_ms": 61.38888857659909, "mean_action_processing_ms": 0.2558704331527339, "mean_env_wait_ms": 0.1816129191453821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 53000, "timesteps_this_iter": 40, "agent_timesteps_total": 53000, "timers": {"sample_time_ms": 3880.147, "sample_throughput": 10.309, "learn_time_ms": 2847.528, "learn_throughput": 14.047, "update_time_ms": 62.816}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.427072525024414, "grad_norm": 220.0098876953125, "td_error_abs": 2.737835184733073, "q_taken_mean": 18.784358723958334, "target_mean": 16.980665079752605}}}, "num_steps_sampled": 53000, "num_agent_steps_sampled": 53000, "num_steps_trained": 53000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 52520, "num_target_updates": 101}, "done": false, "episodes_total": 5300, "training_iteration": 53, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-39-14", "timestamp": 1648885154, "time_this_iter_s": 97.89853310585022, "time_total_s": 4720.267103910446, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4720.267103910446, "timesteps_since_restore": 2120, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 24.634285714285713, "ram_util_percent": 73.10214285714285}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 63.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 60.0, 30.0, 90.0, 90.0, 30.0, 30.0, 90.0, 60.0, 90.0, 30.0, 90.0, 30.0, 30.0, 30.0, 90.0, 30.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 60.0, 120.0, 30.0, 90.0, 30.0, 60.0, 60.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 120.0, 120.0, 30.0, 60.0, 90.0, 90.0, 90.0, 90.0, 60.0, 60.0, 30.0, 30.0, 90.0, 60.0, 60.0, 30.0, 30.0, 120.0, 30.0, 60.0, 60.0, 30.0, 60.0, 30.0, 30.0, 120.0, 90.0, 60.0, 60.0, 60.0, 90.0, 90.0, 90.0, 30.0, 60.0, 90.0, 60.0, 60.0, 60.0, 90.0, 30.0, 60.0, 60.0, 60.0, 60.0, 90.0, 120.0, 30.0, 90.0, 90.0, 90.0, 60.0, 60.0, 150.0, 0.0, 30.0, 120.0, 60.0, 30.0, 120.0, 90.0, 90.0, 30.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.81596857229433, "mean_inference_ms": 61.542462361370156, "mean_action_processing_ms": 0.2563698593223283, "mean_env_wait_ms": 0.18200674513323853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 54000, "timesteps_this_iter": 40, "agent_timesteps_total": 54000, "timers": {"sample_time_ms": 3842.203, "sample_throughput": 10.411, "learn_time_ms": 2802.86, "learn_throughput": 14.271, "update_time_ms": 60.975}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 14.116427421569824, "grad_norm": 253.5311279296875, "td_error_abs": 3.05580317179362, "q_taken_mean": 22.538810221354165, "target_mean": 21.04627888997396}}}, "num_steps_sampled": 54000, "num_agent_steps_sampled": 54000, "num_steps_trained": 54000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 53560, "num_target_updates": 103}, "done": false, "episodes_total": 5400, "training_iteration": 54, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-40-51", "timestamp": 1648885251, "time_this_iter_s": 96.77829933166504, "time_total_s": 4817.045403242111, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4817.045403242111, "timesteps_since_restore": 2160, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 24.408695652173915, "ram_util_percent": 73.4108695652174}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 63.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 0.0, 30.0, 90.0, 90.0, 60.0, 60.0, 30.0, 30.0, 120.0, 120.0, 60.0, 30.0, 90.0, 90.0, 60.0, 60.0, 90.0, 120.0, 60.0, 60.0, 90.0, 60.0, 60.0, 60.0, 60.0, 60.0, 90.0, 0.0, 60.0, 60.0, -30.0, 60.0, 90.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 30.0, 90.0, 30.0, 90.0, 120.0, 30.0, 60.0, 60.0, 120.0, 90.0, 60.0, 30.0, 60.0, 60.0, 90.0, 30.0, 60.0, 60.0, 60.0, 30.0, 30.0, 60.0, 120.0, 60.0, 90.0, 90.0, 60.0, 30.0, 90.0, 120.0, 30.0, 60.0, 90.0, 120.0, 90.0, 60.0, 30.0, 60.0, 60.0, 90.0, 90.0, 30.0, 0.0, 30.0, 60.0, 90.0, 90.0, 60.0, 30.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 60.0, 90.0, 60.0, 60.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8178875191620364, "mean_inference_ms": 61.69135054625836, "mean_action_processing_ms": 0.25695038746854687, "mean_env_wait_ms": 0.18233540240014456, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 55000, "timesteps_this_iter": 40, "agent_timesteps_total": 55000, "timers": {"sample_time_ms": 3992.002, "sample_throughput": 10.02, "learn_time_ms": 2892.67, "learn_throughput": 13.828, "update_time_ms": 76.742}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.82975435256958, "grad_norm": 187.7539825439453, "td_error_abs": 2.140455881754557, "q_taken_mean": 20.44718017578125, "target_mean": 21.550181070963543}}}, "num_steps_sampled": 55000, "num_agent_steps_sampled": 55000, "num_steps_trained": 55000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 54600, "num_target_updates": 105}, "done": false, "episodes_total": 5500, "training_iteration": 55, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-42-29", "timestamp": 1648885349, "time_this_iter_s": 98.31699895858765, "time_total_s": 4915.362402200699, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4915.362402200699, "timesteps_since_restore": 2200, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 24.580714285714286, "ram_util_percent": 73.66857142857144}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 64.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 60.0, 60.0, 90.0, 90.0, 90.0, 30.0, 60.0, 60.0, 120.0, 60.0, 90.0, 60.0, 90.0, 60.0, 60.0, 30.0, 30.0, 90.0, 90.0, 90.0, 90.0, 30.0, 90.0, 90.0, 30.0, 120.0, 60.0, 60.0, 60.0, 60.0, 30.0, 60.0, 60.0, 120.0, 30.0, 60.0, 60.0, 90.0, 30.0, 90.0, 30.0, 60.0, 60.0, 30.0, 30.0, 90.0, 120.0, 30.0, 60.0, 90.0, 60.0, 90.0, 60.0, 30.0, 120.0, 120.0, 0.0, 90.0, 30.0, 120.0, 90.0, 120.0, 60.0, 30.0, 60.0, 0.0, 30.0, 90.0, 30.0, 0.0, 60.0, 120.0, 120.0, 30.0, 60.0, 90.0, 30.0, 30.0, 60.0, 60.0, 60.0, 90.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 60.0, 90.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 120.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8199129451318228, "mean_inference_ms": 61.83362505655784, "mean_action_processing_ms": 0.2575003285977119, "mean_env_wait_ms": 0.18268324683269568, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 56000, "timesteps_this_iter": 40, "agent_timesteps_total": 56000, "timers": {"sample_time_ms": 3864.7, "sample_throughput": 10.35, "learn_time_ms": 2831.906, "learn_throughput": 14.125, "update_time_ms": 62.755}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.937755584716797, "grad_norm": 113.74503326416016, "td_error_abs": 2.677290344238281, "q_taken_mean": 19.550311279296874, "target_mean": 19.686737060546875}}}, "num_steps_sampled": 56000, "num_agent_steps_sampled": 56000, "num_steps_trained": 56000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 55640, "num_target_updates": 107}, "done": false, "episodes_total": 5600, "training_iteration": 56, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-44-07", "timestamp": 1648885447, "time_this_iter_s": 98.04611229896545, "time_total_s": 5013.408514499664, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5013.408514499664, "timesteps_since_restore": 2240, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 24.54857142857143, "ram_util_percent": 73.99071428571428}}
{"episode_reward_max": 150.0, "episode_reward_min": -30.0, "episode_reward_mean": 63.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 90.0, 30.0, 30.0, 120.0, 60.0, 90.0, 90.0, 90.0, 60.0, 90.0, 30.0, 60.0, 90.0, 30.0, 60.0, 60.0, 60.0, 60.0, 90.0, 90.0, 60.0, 60.0, 60.0, 60.0, 150.0, 30.0, 60.0, 0.0, 90.0, 60.0, 90.0, 60.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 30.0, 90.0, 60.0, 90.0, 60.0, 120.0, 30.0, 60.0, 90.0, 0.0, 30.0, 60.0, 90.0, 30.0, 90.0, 30.0, 120.0, 60.0, 90.0, 90.0, 30.0, 60.0, 120.0, 30.0, 60.0, 60.0, 60.0, -30.0, 90.0, 90.0, 120.0, 60.0, 60.0, 90.0, 90.0, 30.0, 60.0, 90.0, 60.0, 30.0, 30.0, 60.0, 30.0, 30.0, 0.0, 60.0, 60.0, 60.0, 60.0, 30.0, 60.0, 60.0, 0.0, 90.0, 30.0, 60.0, 60.0, 90.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8216878044656286, "mean_inference_ms": 61.980134746031396, "mean_action_processing_ms": 0.25798329871358816, "mean_env_wait_ms": 0.18301973191656717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 57000, "timesteps_this_iter": 40, "agent_timesteps_total": 57000, "timers": {"sample_time_ms": 3954.232, "sample_throughput": 10.116, "learn_time_ms": 2841.121, "learn_throughput": 14.079, "update_time_ms": 103.42}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 12.511675834655762, "grad_norm": 192.12152099609375, "td_error_abs": 2.7153920491536456, "q_taken_mean": 16.74248758951823, "target_mean": 17.25345458984375}}}, "num_steps_sampled": 57000, "num_agent_steps_sampled": 57000, "num_steps_trained": 57000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 56680, "num_target_updates": 109}, "done": false, "episodes_total": 5700, "training_iteration": 57, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-45-45", "timestamp": 1648885545, "time_this_iter_s": 98.2664589881897, "time_total_s": 5111.674973487854, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5111.674973487854, "timesteps_since_restore": 2280, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 24.732142857142858, "ram_util_percent": 74.33571428571429}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 65.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 60.0, 90.0, 30.0, 60.0, 30.0, 0.0, 60.0, 60.0, 30.0, 90.0, 90.0, 60.0, 30.0, 30.0, 30.0, 90.0, 60.0, 60.0, 30.0, 90.0, 30.0, 60.0, 60.0, 30.0, 90.0, 90.0, 60.0, 30.0, 60.0, 90.0, 120.0, 90.0, 60.0, 90.0, 120.0, 120.0, 60.0, 120.0, 30.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 60.0, 60.0, 60.0, 90.0, 90.0, 60.0, 60.0, 30.0, 60.0, 90.0, 30.0, 60.0, 60.0, 60.0, 30.0, 90.0, 60.0, 120.0, 120.0, 60.0, 60.0, 90.0, 60.0, 60.0, 90.0, 60.0, 30.0, 90.0, 90.0, 120.0, 90.0, 120.0, 60.0, 30.0, 60.0, 60.0, 30.0, 90.0, 30.0, 30.0, 120.0, 30.0, 120.0, 60.0, 0.0, 90.0, 0.0, 60.0, 60.0, 60.0, 90.0, 60.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8238318270465014, "mean_inference_ms": 62.129188645223905, "mean_action_processing_ms": 0.2585612743544205, "mean_env_wait_ms": 0.18343841377665004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 58000, "timesteps_this_iter": 40, "agent_timesteps_total": 58000, "timers": {"sample_time_ms": 3952.337, "sample_throughput": 10.121, "learn_time_ms": 2837.642, "learn_throughput": 14.096, "update_time_ms": 93.509}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 16.226856231689453, "grad_norm": 211.7335205078125, "td_error_abs": 3.0689488728841146, "q_taken_mean": 18.030521647135416, "target_mean": 19.371293131510416}}}, "num_steps_sampled": 58000, "num_agent_steps_sampled": 58000, "num_steps_trained": 58000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 57720, "num_target_updates": 111}, "done": false, "episodes_total": 5800, "training_iteration": 58, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-47-23", "timestamp": 1648885643, "time_this_iter_s": 97.33240509033203, "time_total_s": 5209.007378578186, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5209.007378578186, "timesteps_since_restore": 2320, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 24.796402877697844, "ram_util_percent": 74.62374100719425}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 68.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 90.0, 90.0, 90.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 30.0, 90.0, 90.0, 90.0, 30.0, 90.0, 30.0, 30.0, 30.0, 60.0, 90.0, 60.0, 60.0, 90.0, 30.0, 60.0, 60.0, 90.0, 60.0, 120.0, 120.0, 30.0, 60.0, 60.0, 90.0, 90.0, 30.0, 90.0, 30.0, 90.0, 30.0, 90.0, 60.0, 90.0, 90.0, 60.0, 60.0, 0.0, 30.0, 90.0, 120.0, 60.0, 30.0, 90.0, 60.0, 90.0, 60.0, 0.0, 30.0, 60.0, 90.0, 60.0, 120.0, 30.0, 60.0, 60.0, 60.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 60.0, 90.0, 60.0, 60.0, 0.0, 60.0, 90.0, 30.0, 30.0, 60.0, 30.0, 90.0, 90.0, 60.0, 90.0, 60.0, 90.0, 60.0, 90.0, 60.0, 60.0, 90.0, 90.0, 120.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8258465855543949, "mean_inference_ms": 62.26211528472276, "mean_action_processing_ms": 0.2590391637672691, "mean_env_wait_ms": 0.18373140843631727, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 59000, "timesteps_this_iter": 40, "agent_timesteps_total": 59000, "timers": {"sample_time_ms": 3872.215, "sample_throughput": 10.33, "learn_time_ms": 2808.809, "learn_throughput": 14.241, "update_time_ms": 62.934}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.978890895843506, "grad_norm": 141.5279998779297, "td_error_abs": 2.1746287027994793, "q_taken_mean": 19.371065266927083, "target_mean": 18.401918538411458}}}, "num_steps_sampled": 59000, "num_agent_steps_sampled": 59000, "num_steps_trained": 59000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 58760, "num_target_updates": 113}, "done": false, "episodes_total": 5900, "training_iteration": 59, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-49-00", "timestamp": 1648885740, "time_this_iter_s": 97.75171756744385, "time_total_s": 5306.75909614563, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5306.75909614563, "timesteps_since_restore": 2360, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 24.778417266187052, "ram_util_percent": 74.96474820143884}}
{"episode_reward_max": 120.0, "episode_reward_min": -30.0, "episode_reward_mean": 68.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 60.0, 90.0, 60.0, 30.0, 90.0, 0.0, 60.0, 60.0, 90.0, 60.0, 120.0, 60.0, 60.0, 30.0, 90.0, 90.0, 60.0, 60.0, 90.0, 90.0, 90.0, 60.0, 60.0, 60.0, 90.0, 60.0, 90.0, 90.0, 30.0, 60.0, 60.0, 30.0, 120.0, 30.0, 30.0, 90.0, 90.0, 90.0, 120.0, 60.0, 30.0, 90.0, 60.0, 90.0, 30.0, 30.0, 0.0, 60.0, 90.0, 90.0, 90.0, 30.0, 30.0, 60.0, 60.0, 30.0, 60.0, 90.0, 120.0, 90.0, 90.0, 120.0, 120.0, 60.0, 90.0, 60.0, 90.0, 30.0, 90.0, 90.0, 90.0, 60.0, 90.0, 90.0, 30.0, 60.0, 90.0, 60.0, 90.0, 60.0, 30.0, 60.0, 90.0, 30.0, 90.0, 60.0, 90.0, 90.0, 90.0, 30.0, 60.0, 90.0, 90.0, 60.0, -30.0, 60.0, 60.0, 120.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8273435810328911, "mean_inference_ms": 62.39669776012099, "mean_action_processing_ms": 0.25946971504110217, "mean_env_wait_ms": 0.18400860567043942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 60000, "timesteps_this_iter": 40, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 3964.564, "sample_throughput": 10.089, "learn_time_ms": 2892.85, "learn_throughput": 13.827, "update_time_ms": 85.769}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 22.72732162475586, "grad_norm": 393.9800109863281, "td_error_abs": 3.657445271809896, "q_taken_mean": 22.394759114583334, "target_mean": 23.229390462239582}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 59800, "num_target_updates": 115}, "done": false, "episodes_total": 6000, "training_iteration": 60, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-50-38", "timestamp": 1648885838, "time_this_iter_s": 97.78545832633972, "time_total_s": 5404.54455447197, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5404.54455447197, "timesteps_since_restore": 2400, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 24.619285714285716, "ram_util_percent": 75.24785714285714}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 69.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 60.0, 90.0, 60.0, 30.0, 90.0, 30.0, 60.0, 60.0, 0.0, 30.0, 60.0, 30.0, 60.0, 90.0, 60.0, 90.0, 0.0, 120.0, 120.0, 120.0, 60.0, 120.0, 60.0, 90.0, 90.0, 60.0, 90.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 30.0, 90.0, 30.0, 60.0, 30.0, 30.0, 60.0, 60.0, 60.0, 30.0, 120.0, 90.0, 30.0, 60.0, 90.0, 120.0, 60.0, 90.0, 30.0, 120.0, 90.0, 60.0, 90.0, 90.0, 60.0, 150.0, 60.0, 60.0, 90.0, 30.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 60.0, 90.0, 90.0, 30.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 90.0, 120.0, 90.0, 60.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 30.0, 60.0, 60.0, 0.0, 90.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8291528307956192, "mean_inference_ms": 62.505890772652386, "mean_action_processing_ms": 0.25976445978019724, "mean_env_wait_ms": 0.18425354308186578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 61000, "timesteps_this_iter": 40, "agent_timesteps_total": 61000, "timers": {"sample_time_ms": 3898.433, "sample_throughput": 10.261, "learn_time_ms": 2804.955, "learn_throughput": 14.26, "update_time_ms": 65.721}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.303000450134277, "grad_norm": 170.706298828125, "td_error_abs": 2.7029940287272134, "q_taken_mean": 24.35560506184896, "target_mean": 23.806355794270832}}}, "num_steps_sampled": 61000, "num_agent_steps_sampled": 61000, "num_steps_trained": 61000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 60840, "num_target_updates": 117}, "done": false, "episodes_total": 6100, "training_iteration": 61, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-52-16", "timestamp": 1648885936, "time_this_iter_s": 97.47484850883484, "time_total_s": 5502.019402980804, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5502.019402980804, "timesteps_since_restore": 2440, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 24.560431654676258, "ram_util_percent": 75.60791366906474}}
{"episode_reward_max": 120.0, "episode_reward_min": 0.0, "episode_reward_mean": 73.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 120.0, 120.0, 90.0, 30.0, 90.0, 60.0, 60.0, 60.0, 90.0, 30.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 30.0, 90.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 60.0, 90.0, 60.0, 120.0, 120.0, 60.0, 30.0, 90.0, 30.0, 120.0, 90.0, 60.0, 30.0, 60.0, 60.0, 60.0, 60.0, 90.0, 120.0, 60.0, 30.0, 90.0, 90.0, 120.0, 90.0, 90.0, 60.0, 60.0, 60.0, 120.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 90.0, 120.0, 0.0, 60.0, 0.0, 90.0, 60.0, 60.0, 30.0, 0.0, 30.0, 90.0, 90.0, 120.0, 90.0, 30.0, 60.0, 60.0, 90.0, 60.0, 90.0, 0.0, 90.0, 30.0, 60.0, 60.0, 30.0, 30.0, 90.0, 30.0, 30.0, 90.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8278062217320624, "mean_inference_ms": 62.40736766443216, "mean_action_processing_ms": 0.25942347355945883, "mean_env_wait_ms": 0.18401894521101098, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 62000, "timesteps_this_iter": 40, "agent_timesteps_total": 62000, "timers": {"sample_time_ms": 3417.305, "sample_throughput": 11.705, "learn_time_ms": 2528.163, "learn_throughput": 15.822, "update_time_ms": 75.209}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 23.650897979736328, "grad_norm": 336.4555358886719, "td_error_abs": 3.8261011759440104, "q_taken_mean": 23.519246419270832, "target_mean": 24.9242431640625}}}, "num_steps_sampled": 62000, "num_agent_steps_sampled": 62000, "num_steps_trained": 62000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 61880, "num_target_updates": 119}, "done": false, "episodes_total": 6200, "training_iteration": 62, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-53-41", "timestamp": 1648886021, "time_this_iter_s": 84.90673923492432, "time_total_s": 5586.926142215729, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5586.926142215729, "timesteps_since_restore": 2480, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 23.665289256198346, "ram_util_percent": 76.06033057851239}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 74.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 90.0, 60.0, 60.0, 0.0, 0.0, 90.0, 120.0, 60.0, 90.0, 60.0, 150.0, 60.0, 60.0, 60.0, 90.0, 30.0, 120.0, 60.0, 60.0, 60.0, 0.0, 30.0, 60.0, 90.0, 120.0, 60.0, 90.0, 60.0, 30.0, 90.0, 60.0, 120.0, 90.0, 120.0, 60.0, 60.0, 90.0, 90.0, 60.0, 120.0, 120.0, 60.0, 90.0, 90.0, 60.0, 90.0, 90.0, 60.0, 90.0, 120.0, 60.0, 60.0, 30.0, 120.0, 60.0, 30.0, 120.0, 90.0, 90.0, 60.0, 90.0, 90.0, 120.0, 60.0, 90.0, 90.0, 30.0, 60.0, 0.0, 120.0, 60.0, 60.0, 60.0, 30.0, 60.0, 90.0, 60.0, 120.0, 60.0, 30.0, 90.0, 90.0, 90.0, 90.0, 60.0, 30.0, 90.0, 30.0, 60.0, 60.0, 60.0, 60.0, 90.0, 90.0, 60.0, 120.0, 90.0, 120.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8263355678592016, "mean_inference_ms": 62.303653717585945, "mean_action_processing_ms": 0.2590472240628428, "mean_env_wait_ms": 0.18375427425796964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 63000, "timesteps_this_iter": 40, "agent_timesteps_total": 63000, "timers": {"sample_time_ms": 3346.3, "sample_throughput": 11.954, "learn_time_ms": 2475.964, "learn_throughput": 16.155, "update_time_ms": 57.869}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.279115676879883, "grad_norm": 221.9273681640625, "td_error_abs": 2.8983500162760416, "q_taken_mean": 23.881351725260416, "target_mean": 23.241288248697916}}}, "num_steps_sampled": 63000, "num_agent_steps_sampled": 63000, "num_steps_trained": 63000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 62920, "num_target_updates": 121}, "done": false, "episodes_total": 6300, "training_iteration": 63, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-55-05", "timestamp": 1648886105, "time_this_iter_s": 84.307941198349, "time_total_s": 5671.234083414078, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5671.234083414078, "timesteps_since_restore": 2520, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 23.2225, "ram_util_percent": 76.39166666666667}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 71.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 60.0, 60.0, 120.0, 60.0, 60.0, 60.0, 90.0, 60.0, 90.0, 60.0, 60.0, 120.0, 60.0, 90.0, 120.0, 60.0, 30.0, 90.0, 60.0, 90.0, 30.0, 120.0, 90.0, 120.0, 60.0, 60.0, 90.0, 60.0, 30.0, 60.0, 60.0, 90.0, 60.0, 90.0, 30.0, 120.0, 90.0, 90.0, 30.0, 60.0, 60.0, 90.0, 90.0, 60.0, 90.0, 30.0, 60.0, 90.0, 60.0, 60.0, 90.0, 60.0, 90.0, 120.0, 90.0, 120.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 60.0, 60.0, 60.0, 90.0, 90.0, 90.0, 60.0, 60.0, 60.0, 90.0, 60.0, 0.0, 60.0, 60.0, 90.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 30.0, 60.0, 120.0, 90.0, 30.0, 30.0, 90.0, 90.0, 60.0, 90.0, 60.0, 60.0, 60.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8249622897411629, "mean_inference_ms": 62.200282880734086, "mean_action_processing_ms": 0.25873438327523, "mean_env_wait_ms": 0.1835185701746798, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 64000, "timesteps_this_iter": 40, "agent_timesteps_total": 64000, "timers": {"sample_time_ms": 3370.919, "sample_throughput": 11.866, "learn_time_ms": 2500.122, "learn_throughput": 15.999, "update_time_ms": 84.71}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.656020164489746, "grad_norm": 127.24394226074219, "td_error_abs": 2.4745992024739585, "q_taken_mean": 23.771834309895834, "target_mean": 23.474849446614584}}}, "num_steps_sampled": 64000, "num_agent_steps_sampled": 64000, "num_steps_trained": 64000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 63960, "num_target_updates": 123}, "done": false, "episodes_total": 6400, "training_iteration": 64, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-56-29", "timestamp": 1648886189, "time_this_iter_s": 84.2122962474823, "time_total_s": 5755.44637966156, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5755.44637966156, "timesteps_since_restore": 2560, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 23.772499999999997, "ram_util_percent": 76.63333333333335}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 73.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 90.0, 90.0, 60.0, 90.0, 60.0, 30.0, 30.0, 90.0, 90.0, 90.0, 60.0, 120.0, 60.0, 60.0, 90.0, 60.0, 60.0, 90.0, 60.0, 90.0, 60.0, 30.0, 90.0, 120.0, 150.0, 60.0, 90.0, 60.0, 30.0, 0.0, 90.0, 60.0, 120.0, 0.0, 90.0, 60.0, 60.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 60.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 30.0, 60.0, 30.0, 90.0, 90.0, 90.0, 90.0, 60.0, 60.0, 120.0, 90.0, 90.0, 30.0, 60.0, 60.0, 0.0, 60.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 60.0, 120.0, 90.0, 60.0, 60.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 90.0, 30.0, 90.0, 90.0, 60.0, 60.0, 90.0, 60.0, 60.0, 60.0, 30.0, 90.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.823778406626393, "mean_inference_ms": 62.10664747443672, "mean_action_processing_ms": 0.25844499519235, "mean_env_wait_ms": 0.18332381372004022, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 65000, "timesteps_this_iter": 40, "agent_timesteps_total": 65000, "timers": {"sample_time_ms": 3368.707, "sample_throughput": 11.874, "learn_time_ms": 2499.438, "learn_throughput": 16.004, "update_time_ms": 75.901}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 13.605338096618652, "grad_norm": 327.2391662597656, "td_error_abs": 2.865118662516276, "q_taken_mean": 20.59449462890625, "target_mean": 22.406313069661458}}}, "num_steps_sampled": 65000, "num_agent_steps_sampled": 65000, "num_steps_trained": 65000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 65000, "num_target_updates": 125}, "done": false, "episodes_total": 6500, "training_iteration": 65, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-57-54", "timestamp": 1648886274, "time_this_iter_s": 84.44283485412598, "time_total_s": 5839.889214515686, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5839.889214515686, "timesteps_since_restore": 2600, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 23.79669421487603, "ram_util_percent": 77.03884297520662}}
{"episode_reward_max": 150.0, "episode_reward_min": -30.0, "episode_reward_mean": 75.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 90.0, 30.0, 30.0, 120.0, 90.0, 90.0, 60.0, 90.0, 60.0, 30.0, 60.0, 30.0, 60.0, 90.0, 90.0, 120.0, 120.0, 90.0, 60.0, 150.0, 90.0, 60.0, 120.0, 60.0, 30.0, 90.0, 90.0, 60.0, 60.0, 90.0, 120.0, 30.0, 120.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 30.0, 60.0, 60.0, 60.0, 120.0, 0.0, 90.0, 30.0, 120.0, 60.0, 90.0, 60.0, 120.0, 90.0, 90.0, 90.0, 120.0, 30.0, 60.0, 120.0, 60.0, 90.0, 60.0, 30.0, 90.0, 90.0, -30.0, 120.0, 60.0, 90.0, 120.0, 60.0, 30.0, 90.0, 90.0, 90.0, 60.0, 90.0, 90.0, 30.0, 90.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 60.0, 90.0, 60.0, 60.0, 120.0, 30.0, 150.0, 60.0, 60.0, 90.0, 30.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8225146513781064, "mean_inference_ms": 62.032229267794456, "mean_action_processing_ms": 0.2581665323875968, "mean_env_wait_ms": 0.18310707617178815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 66000, "timesteps_this_iter": 40, "agent_timesteps_total": 66000, "timers": {"sample_time_ms": 3370.853, "sample_throughput": 11.866, "learn_time_ms": 2496.813, "learn_throughput": 16.02, "update_time_ms": 66.484}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.494077682495117, "grad_norm": 179.33055114746094, "td_error_abs": 2.3813262939453126, "q_taken_mean": 18.89810791015625, "target_mean": 19.354217529296875}}}, "num_steps_sampled": 66000, "num_agent_steps_sampled": 66000, "num_steps_trained": 66000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 65520, "num_target_updates": 126}, "done": false, "episodes_total": 6600, "training_iteration": 66, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_00-59-18", "timestamp": 1648886358, "time_this_iter_s": 84.51215171813965, "time_total_s": 5924.401366233826, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5924.401366233826, "timesteps_since_restore": 2640, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 23.782499999999995, "ram_util_percent": 77.36}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 76.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 60.0, 60.0, 120.0, 60.0, 60.0, 90.0, 90.0, 150.0, 90.0, 90.0, 90.0, 60.0, 90.0, 30.0, 30.0, 30.0, 30.0, 60.0, 90.0, 90.0, 60.0, 90.0, 120.0, 60.0, 30.0, 90.0, 90.0, 60.0, 90.0, 120.0, 90.0, 90.0, 150.0, 0.0, 90.0, 90.0, 60.0, 90.0, 60.0, 90.0, 30.0, 30.0, 90.0, 60.0, 30.0, 90.0, 60.0, 60.0, 60.0, 120.0, 60.0, 60.0, 90.0, 60.0, 90.0, 60.0, 60.0, 60.0, 60.0, 60.0, 120.0, 60.0, 60.0, 60.0, 90.0, 90.0, 90.0, 90.0, 120.0, 30.0, 90.0, 60.0, 90.0, 90.0, 60.0, 90.0, 60.0, 60.0, 60.0, 90.0, 90.0, 60.0, 90.0, 30.0, 90.0, 90.0, 90.0, 90.0, 120.0, 90.0, 90.0, 90.0, 60.0, 120.0, 120.0, 60.0, 60.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.821142429793374, "mean_inference_ms": 61.93616944820831, "mean_action_processing_ms": 0.25780853118677866, "mean_env_wait_ms": 0.18284468641993348, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 67000, "timesteps_this_iter": 40, "agent_timesteps_total": 67000, "timers": {"sample_time_ms": 3331.931, "sample_throughput": 12.005, "learn_time_ms": 2473.406, "learn_throughput": 16.172, "update_time_ms": 59.328}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 14.20337963104248, "grad_norm": 227.57620239257812, "td_error_abs": 2.6790196736653646, "q_taken_mean": 19.85831298828125, "target_mean": 21.548954264322916}}}, "num_steps_sampled": 67000, "num_agent_steps_sampled": 67000, "num_steps_trained": 67000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 66560, "num_target_updates": 128}, "done": false, "episodes_total": 6700, "training_iteration": 67, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-00-42", "timestamp": 1648886442, "time_this_iter_s": 83.73079419136047, "time_total_s": 6008.132160425186, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6008.132160425186, "timesteps_since_restore": 2680, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 23.169747899159663, "ram_util_percent": 77.68655462184876}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 80.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 90.0, 60.0, 60.0, 90.0, 120.0, 90.0, 90.0, 60.0, 90.0, 120.0, 60.0, 90.0, 90.0, 60.0, 90.0, 90.0, 120.0, 30.0, 60.0, 90.0, 90.0, 30.0, 90.0, 60.0, 120.0, 90.0, 150.0, 90.0, 60.0, 150.0, 120.0, 90.0, 60.0, 60.0, 30.0, 90.0, 90.0, 120.0, 60.0, 60.0, 60.0, 30.0, 120.0, 90.0, 90.0, 30.0, 60.0, 120.0, 60.0, 60.0, 60.0, 60.0, 90.0, 120.0, 90.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 60.0, 90.0, 120.0, 90.0, 90.0, 60.0, 60.0, 60.0, 90.0, 90.0, 30.0, 60.0, 90.0, 90.0, 120.0, 120.0, 90.0, 90.0, 90.0, 60.0, 30.0, 90.0, 30.0, 90.0, 120.0, 90.0, 90.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 60.0, 30.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8198163536154348, "mean_inference_ms": 61.83533077485126, "mean_action_processing_ms": 0.2574007915444994, "mean_env_wait_ms": 0.18257795659999732, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 68000, "timesteps_this_iter": 40, "agent_timesteps_total": 68000, "timers": {"sample_time_ms": 3351.519, "sample_throughput": 11.935, "learn_time_ms": 2497.364, "learn_throughput": 16.017, "update_time_ms": 61.697}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.1951799392700195, "grad_norm": 141.97894287109375, "td_error_abs": 2.125659942626953, "q_taken_mean": 20.627547200520834, "target_mean": 21.000567626953124}}}, "num_steps_sampled": 68000, "num_agent_steps_sampled": 68000, "num_steps_trained": 68000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 67600, "num_target_updates": 130}, "done": false, "episodes_total": 6800, "training_iteration": 68, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-02-06", "timestamp": 1648886526, "time_this_iter_s": 83.9412784576416, "time_total_s": 6092.073438882828, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6092.073438882828, "timesteps_since_restore": 2720, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 23.64333333333333, "ram_util_percent": 77.93583333333332}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 75.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 60.0, 120.0, 60.0, 90.0, 90.0, 90.0, 60.0, 30.0, 60.0, 90.0, 60.0, 150.0, 120.0, 60.0, 60.0, 150.0, 60.0, 60.0, 30.0, 150.0, 30.0, 90.0, 90.0, 90.0, 30.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 60.0, 120.0, 90.0, 60.0, 60.0, 90.0, 60.0, 30.0, 90.0, 60.0, 60.0, 60.0, 90.0, 90.0, 0.0, 150.0, 60.0, 60.0, 30.0, 60.0, 90.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 60.0, 60.0, 60.0, 120.0, 60.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 60.0, 90.0, 60.0, 90.0, 120.0, 120.0, 90.0, 60.0, 120.0, 90.0, 60.0, 90.0, 120.0, 60.0, 30.0, 90.0, 60.0, 30.0, 90.0, 60.0, 30.0, 60.0, 60.0, 90.0, 60.0, 60.0, 90.0, 90.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8186088645709065, "mean_inference_ms": 61.75143413215876, "mean_action_processing_ms": 0.2570990361819633, "mean_env_wait_ms": 0.18236556748888902, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 69000, "timesteps_this_iter": 40, "agent_timesteps_total": 69000, "timers": {"sample_time_ms": 3374.171, "sample_throughput": 11.855, "learn_time_ms": 2509.198, "learn_throughput": 15.941, "update_time_ms": 62.434}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.720550537109375, "grad_norm": 286.23095703125, "td_error_abs": 2.432728576660156, "q_taken_mean": 23.698612467447916, "target_mean": 22.264990234375}}}, "num_steps_sampled": 69000, "num_agent_steps_sampled": 69000, "num_steps_trained": 69000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 68640, "num_target_updates": 132}, "done": false, "episodes_total": 6900, "training_iteration": 69, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-03-31", "timestamp": 1648886611, "time_this_iter_s": 84.82739877700806, "time_total_s": 6176.900837659836, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6176.900837659836, "timesteps_since_restore": 2760, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 23.654545454545453, "ram_util_percent": 78.36198347107437}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 76.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 90.0, 30.0, 120.0, 90.0, 90.0, 60.0, 120.0, 60.0, 90.0, 90.0, 60.0, 30.0, 90.0, 60.0, 60.0, 90.0, 90.0, 60.0, 120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 90.0, 60.0, 60.0, 90.0, 120.0, 60.0, 60.0, 150.0, 60.0, 30.0, 90.0, 120.0, 120.0, 60.0, 60.0, 60.0, 60.0, 90.0, 60.0, 90.0, 60.0, 60.0, 90.0, 30.0, 90.0, 90.0, 60.0, 120.0, 90.0, 60.0, 30.0, 30.0, 60.0, 90.0, 90.0, 60.0, 30.0, 90.0, 90.0, 60.0, 150.0, 30.0, 90.0, 90.0, 90.0, 90.0, 90.0, 30.0, 60.0, 60.0, 60.0, 120.0, 30.0, 90.0, 30.0, 120.0, 60.0, 60.0, 60.0, 120.0, 90.0, 90.0, 90.0, 60.0, 30.0, 90.0, 60.0, 90.0, 90.0, 120.0, 60.0, 90.0, 60.0, 60.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8173740684601262, "mean_inference_ms": 61.66331106019385, "mean_action_processing_ms": 0.2567812882997698, "mean_env_wait_ms": 0.1821539400781974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 70000, "timesteps_this_iter": 40, "agent_timesteps_total": 70000, "timers": {"sample_time_ms": 3353.207, "sample_throughput": 11.929, "learn_time_ms": 2492.517, "learn_throughput": 16.048, "update_time_ms": 62.277}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.414015769958496, "grad_norm": 146.90061950683594, "td_error_abs": 2.3715337117513022, "q_taken_mean": 21.77851765950521, "target_mean": 21.1197998046875}}}, "num_steps_sampled": 70000, "num_agent_steps_sampled": 70000, "num_steps_trained": 70000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 69680, "num_target_updates": 134}, "done": false, "episodes_total": 7000, "training_iteration": 70, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-04-55", "timestamp": 1648886695, "time_this_iter_s": 84.11269021034241, "time_total_s": 6261.013527870178, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6261.013527870178, "timesteps_since_restore": 2800, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 23.33666666666667, "ram_util_percent": 78.65250000000002}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 75.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 60.0, 30.0, 90.0, 90.0, 90.0, 30.0, 60.0, 30.0, 90.0, 30.0, 30.0, 60.0, 60.0, 90.0, 60.0, 60.0, 120.0, 60.0, 90.0, 30.0, 90.0, 90.0, 150.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 60.0, 150.0, 60.0, 90.0, 90.0, 120.0, 60.0, 120.0, 30.0, 90.0, 60.0, 60.0, 120.0, 120.0, 90.0, 90.0, 120.0, 60.0, 90.0, 90.0, 60.0, 60.0, 60.0, 90.0, 60.0, 90.0, 90.0, 60.0, 30.0, 90.0, 60.0, 60.0, 90.0, 90.0, 60.0, 120.0, 30.0, 60.0, 90.0, 60.0, 60.0, 120.0, 90.0, 60.0, 60.0, 150.0, 60.0, 90.0, 90.0, 60.0, 60.0, 90.0, 90.0, 30.0, 90.0, 60.0, 60.0, 30.0, 90.0, 60.0, 90.0, 0.0, 30.0, 90.0, 60.0, 60.0, 120.0, 90.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8160026232885054, "mean_inference_ms": 61.572055730421596, "mean_action_processing_ms": 0.2564654223489516, "mean_env_wait_ms": 0.18192069589987617, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 71000, "timesteps_this_iter": 40, "agent_timesteps_total": 71000, "timers": {"sample_time_ms": 3376.903, "sample_throughput": 11.845, "learn_time_ms": 2493.743, "learn_throughput": 16.04, "update_time_ms": 63.849}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.257826328277588, "grad_norm": 84.18939208984375, "td_error_abs": 1.87174072265625, "q_taken_mean": 19.561751302083334, "target_mean": 19.783024088541666}}}, "num_steps_sampled": 71000, "num_agent_steps_sampled": 71000, "num_steps_trained": 71000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 70720, "num_target_updates": 136}, "done": false, "episodes_total": 7100, "training_iteration": 71, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-06-19", "timestamp": 1648886779, "time_this_iter_s": 84.03395581245422, "time_total_s": 6345.047483682632, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6345.047483682632, "timesteps_since_restore": 2840, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 23.575833333333332, "ram_util_percent": 79.00583333333334}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 80.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 120.0, 60.0, 30.0, 60.0, 150.0, 90.0, 120.0, 120.0, 90.0, 90.0, 30.0, 90.0, 120.0, 90.0, 60.0, 60.0, 90.0, 60.0, 90.0, 90.0, 120.0, 30.0, 60.0, 60.0, 0.0, 150.0, 120.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 120.0, 60.0, 60.0, 120.0, 90.0, 60.0, 60.0, 90.0, 90.0, 90.0, 0.0, 60.0, 90.0, 90.0, 60.0, 60.0, 90.0, 60.0, 90.0, 30.0, 60.0, 120.0, 90.0, 60.0, 60.0, 60.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 90.0, 30.0, 120.0, 90.0, 90.0, 30.0, 30.0, 90.0, 30.0, 60.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 120.0, 90.0, 90.0, 150.0, 120.0, 60.0, 150.0, 60.0, 60.0, 60.0, 90.0, 90.0, 60.0, 120.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.814899654032409, "mean_inference_ms": 61.49235074238397, "mean_action_processing_ms": 0.2561785613064712, "mean_env_wait_ms": 0.1817291514435501, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 72000, "timesteps_this_iter": 40, "agent_timesteps_total": 72000, "timers": {"sample_time_ms": 3432.232, "sample_throughput": 11.654, "learn_time_ms": 2538.999, "learn_throughput": 15.754, "update_time_ms": 63.114}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.577709197998047, "grad_norm": 118.32801818847656, "td_error_abs": 2.3605575561523438, "q_taken_mean": 23.0994873046875, "target_mean": 22.779435221354166}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 72000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 71760, "num_target_updates": 138}, "done": false, "episodes_total": 7200, "training_iteration": 72, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-07-44", "timestamp": 1648886864, "time_this_iter_s": 84.62994194030762, "time_total_s": 6429.67742562294, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6429.67742562294, "timesteps_since_restore": 2880, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 23.505, "ram_util_percent": 79.30833333333335}}
{"episode_reward_max": 180.0, "episode_reward_min": -30.0, "episode_reward_mean": 86.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 60.0, 60.0, 60.0, 120.0, 60.0, 90.0, 30.0, 60.0, 120.0, 120.0, 90.0, 90.0, 60.0, 120.0, 90.0, 120.0, 90.0, 90.0, 60.0, 90.0, 90.0, 60.0, 90.0, 120.0, -30.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 120.0, 60.0, 90.0, 120.0, 120.0, 60.0, 90.0, 60.0, 90.0, 60.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 120.0, 90.0, 30.0, 90.0, 120.0, 90.0, 90.0, 90.0, 30.0, 120.0, 90.0, 120.0, 90.0, 0.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 60.0, 60.0, 150.0, 120.0, 90.0, 120.0, 120.0, 30.0, 60.0, 120.0, 180.0, 60.0, 60.0, 90.0, 120.0, 60.0, 90.0, 90.0, 90.0, 120.0, 90.0, 60.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8138141353308919, "mean_inference_ms": 61.416821769541706, "mean_action_processing_ms": 0.25590831146169174, "mean_env_wait_ms": 0.181546871462663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 73000, "timesteps_this_iter": 40, "agent_timesteps_total": 73000, "timers": {"sample_time_ms": 3340.157, "sample_throughput": 11.975, "learn_time_ms": 2474.001, "learn_throughput": 16.168, "update_time_ms": 61.829}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 18.102617263793945, "grad_norm": 367.75408935546875, "td_error_abs": 3.3016209920247395, "q_taken_mean": 24.786639404296874, "target_mean": 25.023396809895832}}}, "num_steps_sampled": 73000, "num_agent_steps_sampled": 73000, "num_steps_trained": 73000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 72800, "num_target_updates": 140}, "done": false, "episodes_total": 7300, "training_iteration": 73, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-09-08", "timestamp": 1648886948, "time_this_iter_s": 84.24598455429077, "time_total_s": 6513.923410177231, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6513.923410177231, "timesteps_since_restore": 2920, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 23.630000000000003, "ram_util_percent": 79.55583333333334}}
{"episode_reward_max": 180.0, "episode_reward_min": 30.0, "episode_reward_mean": 86.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 90.0, 60.0, 90.0, 90.0, 60.0, 90.0, 60.0, 60.0, 60.0, 60.0, 90.0, 90.0, 60.0, 120.0, 60.0, 120.0, 90.0, 90.0, 90.0, 120.0, 180.0, 120.0, 90.0, 60.0, 60.0, 90.0, 120.0, 90.0, 120.0, 120.0, 60.0, 60.0, 90.0, 120.0, 60.0, 90.0, 90.0, 90.0, 90.0, 60.0, 90.0, 60.0, 90.0, 90.0, 60.0, 60.0, 60.0, 60.0, 90.0, 60.0, 120.0, 90.0, 90.0, 120.0, 30.0, 120.0, 120.0, 90.0, 90.0, 60.0, 30.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 120.0, 60.0, 60.0, 60.0, 120.0, 60.0, 120.0, 90.0, 120.0, 90.0, 90.0, 60.0, 90.0, 90.0, 30.0, 30.0, 120.0, 90.0, 60.0, 90.0, 150.0, 90.0, 120.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129366932221476, "mean_inference_ms": 61.35667772152883, "mean_action_processing_ms": 0.25566590360020136, "mean_env_wait_ms": 0.18135529068069045, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 74000, "timesteps_this_iter": 40, "agent_timesteps_total": 74000, "timers": {"sample_time_ms": 3361.353, "sample_throughput": 11.9, "learn_time_ms": 2454.297, "learn_throughput": 16.298, "update_time_ms": 71.525}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 14.580962181091309, "grad_norm": 348.9799499511719, "td_error_abs": 2.792095184326172, "q_taken_mean": 26.291432698567707, "target_mean": 27.948541259765626}}}, "num_steps_sampled": 74000, "num_agent_steps_sampled": 74000, "num_steps_trained": 74000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 73840, "num_target_updates": 142}, "done": false, "episodes_total": 7400, "training_iteration": 74, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-10-32", "timestamp": 1648887032, "time_this_iter_s": 83.78191494941711, "time_total_s": 6597.705325126648, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6597.705325126648, "timesteps_since_restore": 2960, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 23.885833333333334, "ram_util_percent": 79.8625}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 83.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 60.0, 30.0, 120.0, 30.0, 30.0, 120.0, 90.0, 60.0, 90.0, 120.0, 60.0, 30.0, 120.0, 60.0, 90.0, 60.0, 30.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 120.0, 90.0, 90.0, 30.0, 60.0, 90.0, 60.0, 90.0, 120.0, 90.0, 120.0, 60.0, 90.0, 60.0, 60.0, 60.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 90.0, 120.0, 90.0, 90.0, 90.0, 90.0, 120.0, 60.0, 90.0, 120.0, 120.0, 60.0, 120.0, 90.0, 150.0, 90.0, 60.0, 120.0, 60.0, 90.0, 90.0, 60.0, 90.0, 60.0, 90.0, 30.0, 120.0, 90.0, 90.0, 60.0, 90.0, 60.0, 60.0, 120.0, 30.0, 120.0, 60.0, 60.0, 120.0, 120.0, 30.0, 60.0, 120.0, 60.0, 60.0, 120.0, 90.0, 90.0, 90.0, 120.0, 90.0, 90.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.811723965109841, "mean_inference_ms": 61.267373752710974, "mean_action_processing_ms": 0.2553072123710368, "mean_env_wait_ms": 0.18110120018655973, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 75000, "timesteps_this_iter": 40, "agent_timesteps_total": 75000, "timers": {"sample_time_ms": 3356.954, "sample_throughput": 11.916, "learn_time_ms": 2512.148, "learn_throughput": 15.923, "update_time_ms": 62.684}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.33609390258789, "grad_norm": 295.9615173339844, "td_error_abs": 2.463983917236328, "q_taken_mean": 26.399849446614585, "target_mean": 24.889754231770834}}}, "num_steps_sampled": 75000, "num_agent_steps_sampled": 75000, "num_steps_trained": 75000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 74880, "num_target_updates": 144}, "done": false, "episodes_total": 7500, "training_iteration": 75, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-11-56", "timestamp": 1648887116, "time_this_iter_s": 83.8643593788147, "time_total_s": 6681.569684505463, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6681.569684505463, "timesteps_since_restore": 3000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 23.557142857142853, "ram_util_percent": 80.2336134453782}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 89.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 90.0, 150.0, 90.0, 60.0, 120.0, 60.0, 60.0, 90.0, 60.0, 90.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 150.0, 60.0, 90.0, 60.0, 120.0, 90.0, 60.0, 60.0, 30.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 120.0, 90.0, 60.0, 60.0, 90.0, 30.0, 60.0, 30.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 30.0, 90.0, 90.0, 90.0, 90.0, 120.0, 120.0, 90.0, 60.0, 90.0, 60.0, 150.0, 60.0, 90.0, 90.0, 0.0, 60.0, 90.0, 90.0, 90.0, 120.0, 120.0, 60.0, 120.0, 90.0, 90.0, 90.0, 120.0, 150.0, 90.0, 90.0, 0.0, 120.0, 150.0, 30.0, 90.0, 90.0, 60.0, 90.0, 150.0, 120.0, 90.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8104766057005783, "mean_inference_ms": 61.18384889976381, "mean_action_processing_ms": 0.25500671078447207, "mean_env_wait_ms": 0.18088298812363504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 76000, "timesteps_this_iter": 40, "agent_timesteps_total": 76000, "timers": {"sample_time_ms": 3440.789, "sample_throughput": 11.625, "learn_time_ms": 2531.958, "learn_throughput": 15.798, "update_time_ms": 111.64}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.043309211730957, "grad_norm": 231.0516815185547, "td_error_abs": 2.8252474466959634, "q_taken_mean": 28.175288899739584, "target_mean": 27.288775634765624}}}, "num_steps_sampled": 76000, "num_agent_steps_sampled": 76000, "num_steps_trained": 76000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 75920, "num_target_updates": 146}, "done": false, "episodes_total": 7600, "training_iteration": 76, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-13-20", "timestamp": 1648887200, "time_this_iter_s": 84.80982065200806, "time_total_s": 6766.379505157471, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6766.379505157471, "timesteps_since_restore": 3040, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 23.983471074380166, "ram_util_percent": 80.46115702479338}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 84.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 120.0, 60.0, 30.0, 90.0, 90.0, 60.0, 90.0, 60.0, 90.0, 60.0, 120.0, 120.0, 150.0, 60.0, 0.0, 60.0, 90.0, 90.0, 90.0, 120.0, 90.0, 60.0, 90.0, 0.0, 120.0, 90.0, 90.0, 90.0, 60.0, 90.0, 120.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 60.0, 120.0, 150.0, 90.0, 30.0, 90.0, 60.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 30.0, 60.0, 120.0, 90.0, 90.0, 60.0, 60.0, 30.0, 90.0, 60.0, 90.0, 120.0, 60.0, 60.0, 120.0, 60.0, 30.0, 120.0, 90.0, 90.0, 60.0, 120.0, 0.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 60.0, 60.0, 90.0, 60.0, 120.0, 120.0, 60.0, 60.0, 90.0, 120.0, 30.0, 150.0, 120.0, 60.0, 60.0, 90.0, 90.0, 90.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8093436429001596, "mean_inference_ms": 61.109877627804075, "mean_action_processing_ms": 0.2547606394684882, "mean_env_wait_ms": 0.180693680475572, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 77000, "timesteps_this_iter": 40, "agent_timesteps_total": 77000, "timers": {"sample_time_ms": 3367.298, "sample_throughput": 11.879, "learn_time_ms": 2496.175, "learn_throughput": 16.025, "update_time_ms": 64.412}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 12.088675498962402, "grad_norm": 192.6485595703125, "td_error_abs": 2.7013214111328123, "q_taken_mean": 28.098236083984375, "target_mean": 28.95755615234375}}}, "num_steps_sampled": 77000, "num_agent_steps_sampled": 77000, "num_steps_trained": 77000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 76960, "num_target_updates": 148}, "done": false, "episodes_total": 7700, "training_iteration": 77, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-14-44", "timestamp": 1648887284, "time_this_iter_s": 83.93609833717346, "time_total_s": 6850.315603494644, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6850.315603494644, "timesteps_since_restore": 3080, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 23.375, "ram_util_percent": 80.77500000000002}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 82.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 60.0, 60.0, 120.0, 90.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 60.0, 150.0, 60.0, 90.0, 90.0, 0.0, 90.0, 90.0, 90.0, 90.0, 90.0, 60.0, 90.0, 60.0, 150.0, 90.0, 90.0, 30.0, 60.0, 90.0, 90.0, 60.0, 60.0, 90.0, 120.0, 120.0, 30.0, 90.0, 120.0, 30.0, 90.0, 60.0, 60.0, 60.0, 30.0, 90.0, 120.0, 60.0, 30.0, 90.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 120.0, 30.0, 60.0, 60.0, 120.0, 90.0, 90.0, 60.0, 90.0, 120.0, 120.0, 30.0, 30.0, 120.0, 60.0, 30.0, 90.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 120.0, 120.0, 60.0, 150.0, 60.0, 120.0, 120.0, 90.0, 60.0, 60.0, 90.0, 90.0, 90.0, 90.0, 60.0, 60.0, 60.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8085851430660653, "mean_inference_ms": 61.04776981971025, "mean_action_processing_ms": 0.2545645362774192, "mean_env_wait_ms": 0.18058792211283087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 78000, "timesteps_this_iter": 40, "agent_timesteps_total": 78000, "timers": {"sample_time_ms": 3364.16, "sample_throughput": 11.89, "learn_time_ms": 2474.533, "learn_throughput": 16.165, "update_time_ms": 65.786}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.558660507202148, "grad_norm": 254.12564086914062, "td_error_abs": 2.6626731872558596, "q_taken_mean": 28.751277669270834, "target_mean": 27.929610188802084}}}, "num_steps_sampled": 78000, "num_agent_steps_sampled": 78000, "num_steps_trained": 78000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 78000, "num_target_updates": 150}, "done": false, "episodes_total": 7800, "training_iteration": 78, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-16-08", "timestamp": 1648887368, "time_this_iter_s": 83.95011067390442, "time_total_s": 6934.265714168549, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6934.265714168549, "timesteps_since_restore": 3120, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 23.91166666666667, "ram_util_percent": 81.17083333333333}}
{"episode_reward_max": 180.0, "episode_reward_min": 30.0, "episode_reward_mean": 84.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 90.0, 120.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 30.0, 60.0, 90.0, 90.0, 120.0, 90.0, 90.0, 60.0, 120.0, 60.0, 90.0, 60.0, 30.0, 90.0, 150.0, 60.0, 120.0, 60.0, 60.0, 30.0, 90.0, 90.0, 60.0, 90.0, 90.0, 120.0, 120.0, 90.0, 90.0, 90.0, 60.0, 60.0, 60.0, 30.0, 60.0, 90.0, 90.0, 60.0, 90.0, 60.0, 90.0, 60.0, 150.0, 60.0, 60.0, 120.0, 90.0, 90.0, 90.0, 90.0, 60.0, 60.0, 90.0, 30.0, 120.0, 60.0, 120.0, 90.0, 90.0, 90.0, 90.0, 60.0, 90.0, 60.0, 90.0, 30.0, 90.0, 60.0, 90.0, 90.0, 150.0, 90.0, 60.0, 90.0, 60.0, 60.0, 60.0, 120.0, 120.0, 90.0, 30.0, 180.0, 90.0, 120.0, 120.0, 120.0, 90.0, 60.0, 150.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8078324065064301, "mean_inference_ms": 60.99251105654879, "mean_action_processing_ms": 0.254365189046137, "mean_env_wait_ms": 0.18046208378224604, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 79000, "timesteps_this_iter": 40, "agent_timesteps_total": 79000, "timers": {"sample_time_ms": 3380.051, "sample_throughput": 11.834, "learn_time_ms": 2511.096, "learn_throughput": 15.929, "update_time_ms": 66.174}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 12.552457809448242, "grad_norm": 229.68588256835938, "td_error_abs": 2.7591936747233072, "q_taken_mean": 26.246282958984374, "target_mean": 26.44380900065104}}}, "num_steps_sampled": 79000, "num_agent_steps_sampled": 79000, "num_steps_trained": 79000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 78520, "num_target_updates": 151}, "done": false, "episodes_total": 7900, "training_iteration": 79, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-17-33", "timestamp": 1648887453, "time_this_iter_s": 84.4871199131012, "time_total_s": 7018.75283408165, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7018.75283408165, "timesteps_since_restore": 3160, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 23.836666666666666, "ram_util_percent": 81.40416666666667}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 84.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 120.0, 90.0, 120.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 60.0, 120.0, 90.0, 90.0, 150.0, 60.0, 90.0, 90.0, 120.0, 90.0, 120.0, 60.0, 120.0, 120.0, 60.0, 30.0, 30.0, 60.0, 90.0, 60.0, 60.0, 60.0, 90.0, 90.0, 90.0, 150.0, 90.0, 60.0, 90.0, 120.0, 60.0, 120.0, 150.0, 90.0, 60.0, 90.0, 90.0, 60.0, 90.0, 90.0, 120.0, 90.0, 60.0, 90.0, 90.0, 90.0, 30.0, 90.0, 30.0, 120.0, 60.0, 120.0, 60.0, 90.0, 90.0, 120.0, 120.0, 30.0, 90.0, 90.0, 120.0, 90.0, 60.0, 60.0, 60.0, 60.0, 90.0, 120.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 90.0, 120.0, 30.0, 90.0, 60.0, 90.0, 120.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 90.0, 60.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8068772371003259, "mean_inference_ms": 60.93600160044125, "mean_action_processing_ms": 0.25412414820276147, "mean_env_wait_ms": 0.18028926327254652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 80000, "timesteps_this_iter": 40, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 3349.214, "sample_throughput": 11.943, "learn_time_ms": 2487.492, "learn_throughput": 16.08, "update_time_ms": 74.433}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.27797794342041, "grad_norm": 224.6095428466797, "td_error_abs": 2.62200927734375, "q_taken_mean": 26.63285115559896, "target_mean": 25.9294189453125}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 80000, "num_steps_trained": 80000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 79560, "num_target_updates": 153}, "done": false, "episodes_total": 8000, "training_iteration": 80, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-18-57", "timestamp": 1648887537, "time_this_iter_s": 84.29478740692139, "time_total_s": 7103.047621488571, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7103.047621488571, "timesteps_since_restore": 3200, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 23.941666666666666, "ram_util_percent": 81.73416666666667}}
{"episode_reward_max": 183.0, "episode_reward_min": 0.0, "episode_reward_mean": 88.00961538461539, "episode_len_mean": 9.990384615384615, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 120.0, 90.0, 90.0, 90.0, 90.0, 60.0, 90.0, 90.0, 120.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 183.0, 60.0, 120.0, 90.0, 60.0, 90.0, 60.0, 60.0, 90.0, 90.0, 120.0, 30.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 30.0, 60.0, 90.0, 150.0, 60.0, 60.0, 60.0, 90.0, 90.0, 90.0, 30.0, 120.0, 60.0, 90.0, 90.0, 90.0, 120.0, 90.0, 60.0, 30.0, 90.0, 120.0, 120.0, 60.0, 90.0, 120.0, 60.0, 60.0, 60.0, 90.0, 90.0, 90.0, 120.0, 120.0, 90.0, 90.0, 90.0, 0.0, 60.0, 90.0, 120.0, 120.0, 90.0, 90.0, 150.0, 30.0, 120.0, 120.0, 90.0, 60.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 120.0, 90.0, 60.0, 60.0, 90.0, 90.0, 90.0, 120.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8059560934244956, "mean_inference_ms": 60.87209995363667, "mean_action_processing_ms": 0.25387609177459186, "mean_env_wait_ms": 0.18011439427863435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 81039, "timesteps_this_iter": 40, "agent_timesteps_total": 81039, "timers": {"sample_time_ms": 3346.654, "sample_throughput": 11.952, "learn_time_ms": 2470.626, "learn_throughput": 16.19, "update_time_ms": 68.436}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.149598121643066, "grad_norm": 213.33828735351562, "td_error_abs": 2.4958463033040363, "q_taken_mean": 26.244903564453125, "target_mean": 26.394895426432292}}}, "num_steps_sampled": 81039, "num_agent_steps_sampled": 81039, "num_steps_trained": 81040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 80600, "num_target_updates": 155}, "done": false, "episodes_total": 8104, "training_iteration": 81, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-20-25", "timestamp": 1648887625, "time_this_iter_s": 87.54256701469421, "time_total_s": 7190.590188503265, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7190.590188503265, "timesteps_since_restore": 3240, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 23.6528, "ram_util_percent": 82.0048}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 90.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 30.0, 120.0, 30.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 60.0, 30.0, 120.0, 60.0, 90.0, 90.0, 60.0, 120.0, 90.0, 120.0, 120.0, 60.0, 90.0, 120.0, 90.0, 60.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 60.0, 90.0, 90.0, 120.0, 90.0, 90.0, 60.0, 60.0, 60.0, 90.0, 90.0, 60.0, 60.0, 60.0, 90.0, 90.0, 120.0, 90.0, 30.0, 90.0, 120.0, 60.0, 150.0, 120.0, 60.0, 120.0, 90.0, 90.0, 120.0, 120.0, 60.0, 90.0, 90.0, 60.0, 90.0, 120.0, 120.0, 90.0, 120.0, 150.0, 90.0, 90.0, 90.0, 90.0, 120.0, 60.0, 60.0, 60.0, 120.0, 60.0, 90.0, 120.0, 60.0, 120.0, 120.0, 90.0, 60.0, 60.0, 90.0, 60.0, 150.0, 120.0, 60.0, 60.0, 90.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8051328479205836, "mean_inference_ms": 60.8210273108312, "mean_action_processing_ms": 0.2536998745565377, "mean_env_wait_ms": 0.17998509255272474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 82039, "timesteps_this_iter": 40, "agent_timesteps_total": 82039, "timers": {"sample_time_ms": 3388.393, "sample_throughput": 11.805, "learn_time_ms": 2495.333, "learn_throughput": 16.03, "update_time_ms": 67.691}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 14.977828025817871, "grad_norm": 257.1609802246094, "td_error_abs": 2.9398152669270834, "q_taken_mean": 27.763995361328124, "target_mean": 27.625655110677084}}}, "num_steps_sampled": 82039, "num_agent_steps_sampled": 82039, "num_steps_trained": 82040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 81639, "num_target_updates": 157}, "done": false, "episodes_total": 8204, "training_iteration": 82, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-21-49", "timestamp": 1648887709, "time_this_iter_s": 84.67616581916809, "time_total_s": 7275.2663543224335, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7275.2663543224335, "timesteps_since_restore": 3280, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 23.71157024793389, "ram_util_percent": 82.33884297520662}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 86.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 60.0, 120.0, 90.0, 30.0, 120.0, 120.0, 30.0, 60.0, 120.0, 90.0, 120.0, 120.0, 90.0, 60.0, 60.0, 150.0, 90.0, 90.0, 90.0, 60.0, 90.0, 90.0, 120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 30.0, 60.0, 120.0, 90.0, 90.0, 90.0, 90.0, 60.0, 60.0, 90.0, 90.0, 90.0, 120.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 150.0, 90.0, 120.0, 60.0, 30.0, 60.0, 60.0, 60.0, 30.0, 90.0, 90.0, 60.0, 90.0, 90.0, 120.0, 120.0, 60.0, 90.0, 90.0, 30.0, 90.0, 120.0, 90.0, 90.0, 30.0, 90.0, 60.0, 90.0, 90.0, 90.0, 30.0, 60.0, 90.0, 90.0, 60.0, 90.0, 60.0, 120.0, 90.0, 60.0, 90.0, 90.0, 60.0, 150.0, 120.0, 60.0, 60.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8044097196538896, "mean_inference_ms": 60.770012469813736, "mean_action_processing_ms": 0.25351124362272676, "mean_env_wait_ms": 0.1798577245113613, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 83039, "timesteps_this_iter": 40, "agent_timesteps_total": 83039, "timers": {"sample_time_ms": 3394.987, "sample_throughput": 11.782, "learn_time_ms": 2501.027, "learn_throughput": 15.993, "update_time_ms": 76.864}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 16.096420288085938, "grad_norm": 304.7958984375, "td_error_abs": 2.9920453389485675, "q_taken_mean": 25.77589111328125, "target_mean": 27.296954345703124}}}, "num_steps_sampled": 83039, "num_agent_steps_sampled": 83039, "num_steps_trained": 83040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 82679, "num_target_updates": 159}, "done": false, "episodes_total": 8304, "training_iteration": 83, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-23-14", "timestamp": 1648887794, "time_this_iter_s": 84.84683012962341, "time_total_s": 7360.113184452057, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7360.113184452057, "timesteps_since_restore": 3320, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 23.763333333333332, "ram_util_percent": 82.66583333333331}}
{"episode_reward_max": 180.0, "episode_reward_min": 30.0, "episode_reward_mean": 92.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 150.0, 90.0, 60.0, 90.0, 90.0, 120.0, 60.0, 60.0, 120.0, 90.0, 120.0, 120.0, 60.0, 90.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 90.0, 90.0, 90.0, 120.0, 60.0, 180.0, 120.0, 60.0, 120.0, 90.0, 30.0, 120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 120.0, 60.0, 90.0, 60.0, 30.0, 90.0, 90.0, 90.0, 60.0, 120.0, 90.0, 120.0, 90.0, 90.0, 90.0, 60.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 60.0, 120.0, 60.0, 90.0, 90.0, 120.0, 120.0, 60.0, 90.0, 30.0, 60.0, 90.0, 120.0, 90.0, 90.0, 60.0, 60.0, 120.0, 90.0, 90.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 150.0, 60.0, 60.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8035402697178898, "mean_inference_ms": 60.7116724202616, "mean_action_processing_ms": 0.2532852924337419, "mean_env_wait_ms": 0.17968917481323776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 84039, "timesteps_this_iter": 40, "agent_timesteps_total": 84039, "timers": {"sample_time_ms": 3379.22, "sample_throughput": 11.837, "learn_time_ms": 2486.671, "learn_throughput": 16.086, "update_time_ms": 72.284}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.229929447174072, "grad_norm": 220.77830505371094, "td_error_abs": 2.016335296630859, "q_taken_mean": 30.18404541015625, "target_mean": 29.147782389322916}}}, "num_steps_sampled": 84039, "num_agent_steps_sampled": 84039, "num_steps_trained": 84040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 83719, "num_target_updates": 161}, "done": false, "episodes_total": 8404, "training_iteration": 84, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-24-38", "timestamp": 1648887878, "time_this_iter_s": 84.09778237342834, "time_total_s": 7444.210966825485, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7444.210966825485, "timesteps_since_restore": 3360, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 23.710833333333333, "ram_util_percent": 82.89083333333333}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 93.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 90.0, 150.0, 120.0, 60.0, 90.0, 60.0, 120.0, 120.0, 90.0, 120.0, 90.0, 60.0, 0.0, 150.0, 90.0, 120.0, 120.0, 60.0, 120.0, 120.0, 90.0, 120.0, 60.0, 150.0, 60.0, 120.0, 60.0, 90.0, 60.0, 30.0, 90.0, 90.0, 120.0, 150.0, 120.0, 90.0, 120.0, 60.0, 120.0, 60.0, 60.0, 90.0, 120.0, 150.0, 120.0, 90.0, 60.0, 120.0, 120.0, 60.0, 60.0, 0.0, 150.0, 120.0, 120.0, 60.0, 60.0, 90.0, 120.0, 90.0, 150.0, 60.0, 120.0, 30.0, 60.0, 120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 90.0, 30.0, 90.0, 60.0, 150.0, 60.0, 120.0, 90.0, 60.0, 120.0, 90.0, 60.0, 120.0, 30.0, 60.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 60.0, 90.0, 120.0, 120.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8028374420762057, "mean_inference_ms": 60.665138171516794, "mean_action_processing_ms": 0.25313582772925, "mean_env_wait_ms": 0.1795948086744978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 85039, "timesteps_this_iter": 40, "agent_timesteps_total": 85039, "timers": {"sample_time_ms": 3398.852, "sample_throughput": 11.769, "learn_time_ms": 2503.996, "learn_throughput": 15.974, "update_time_ms": 73.601}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.79311466217041, "grad_norm": 181.218505859375, "td_error_abs": 2.1960962931315104, "q_taken_mean": 24.90411376953125, "target_mean": 25.24749755859375}}}, "num_steps_sampled": 85039, "num_agent_steps_sampled": 85039, "num_steps_trained": 85040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 84759, "num_target_updates": 163}, "done": false, "episodes_total": 8504, "training_iteration": 85, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-26-04", "timestamp": 1648887964, "time_this_iter_s": 85.03002047538757, "time_total_s": 7529.240987300873, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7529.240987300873, "timesteps_since_restore": 3400, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 24.15785123966942, "ram_util_percent": 83.20743801652891}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 95.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 120.0, 150.0, 150.0, 90.0, 120.0, 120.0, 90.0, 60.0, 150.0, 120.0, 120.0, 30.0, 60.0, 60.0, 120.0, 30.0, 120.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 150.0, 120.0, 120.0, 30.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 90.0, 60.0, 90.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 90.0, 90.0, 90.0, 60.0, 90.0, 120.0, 90.0, 90.0, 60.0, 120.0, 150.0, 120.0, 90.0, 120.0, 90.0, 30.0, 120.0, 90.0, 90.0, 60.0, 150.0, 90.0, 90.0, 90.0, 90.0, 90.0, 60.0, 120.0, 120.0, 60.0, 90.0, 120.0, 120.0, 60.0, 120.0, 60.0, 150.0, 30.0, 150.0, 90.0, 30.0, 60.0, 120.0, 150.0, 60.0, 30.0, 30.0, 60.0, 120.0, 120.0, 60.0, 90.0, 120.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8020025490364842, "mean_inference_ms": 60.610476753210314, "mean_action_processing_ms": 0.2529191702000036, "mean_env_wait_ms": 0.17940713042068354, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 86039, "timesteps_this_iter": 40, "agent_timesteps_total": 86039, "timers": {"sample_time_ms": 3414.179, "sample_throughput": 11.716, "learn_time_ms": 2504.217, "learn_throughput": 15.973, "update_time_ms": 73.238}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.301852226257324, "grad_norm": 160.3899383544922, "td_error_abs": 1.8542772928873699, "q_taken_mean": 28.750028483072917, "target_mean": 28.881341552734376}}}, "num_steps_sampled": 86039, "num_agent_steps_sampled": 86039, "num_steps_trained": 86040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 85799, "num_target_updates": 165}, "done": false, "episodes_total": 8604, "training_iteration": 86, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-27-28", "timestamp": 1648888048, "time_this_iter_s": 84.66526675224304, "time_total_s": 7613.906254053116, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7613.906254053116, "timesteps_since_restore": 3440, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 23.65702479338843, "ram_util_percent": 83.50661157024793}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 92.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 120.0, 120.0, 90.0, 60.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 60.0, 60.0, 90.0, 60.0, 120.0, 120.0, 60.0, 60.0, 120.0, 60.0, 60.0, 90.0, 120.0, 60.0, 90.0, 90.0, 150.0, 90.0, 90.0, 90.0, 150.0, 60.0, 120.0, 120.0, 120.0, 30.0, 120.0, 90.0, 60.0, 150.0, 90.0, 90.0, 150.0, 60.0, 90.0, 90.0, 60.0, 90.0, 90.0, 60.0, 120.0, 30.0, 150.0, 120.0, 120.0, 30.0, 90.0, 60.0, 90.0, 60.0, 90.0, 60.0, 150.0, 60.0, 60.0, 120.0, 90.0, 30.0, 60.0, 90.0, 90.0, 90.0, 90.0, 30.0, 120.0, 120.0, 60.0, 60.0, 150.0, 120.0, 120.0, 150.0, 60.0, 150.0, 150.0, 90.0, 90.0, 60.0, 120.0, 60.0, 90.0, 60.0, 120.0, 120.0, 120.0, 90.0, 150.0, 60.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.801289002130226, "mean_inference_ms": 60.55453211545821, "mean_action_processing_ms": 0.2527397986271636, "mean_env_wait_ms": 0.1792736165994355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 87039, "timesteps_this_iter": 40, "agent_timesteps_total": 87039, "timers": {"sample_time_ms": 3407.144, "sample_throughput": 11.74, "learn_time_ms": 2522.57, "learn_throughput": 15.857, "update_time_ms": 83.966}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.931061267852783, "grad_norm": 222.60081481933594, "td_error_abs": 2.2451151529947917, "q_taken_mean": 29.584977213541666, "target_mean": 29.81488037109375}}}, "num_steps_sampled": 87039, "num_agent_steps_sampled": 87039, "num_steps_trained": 87040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 86839, "num_target_updates": 167}, "done": false, "episodes_total": 8704, "training_iteration": 87, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-28-54", "timestamp": 1648888134, "time_this_iter_s": 85.52845215797424, "time_total_s": 7699.43470621109, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7699.43470621109, "timesteps_since_restore": 3480, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 23.77377049180328, "ram_util_percent": 83.77868852459018}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 99.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 120.0, 60.0, 90.0, 90.0, 90.0, 90.0, 90.0, 60.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 90.0, 150.0, 90.0, 60.0, 120.0, 90.0, 90.0, 60.0, 30.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 30.0, 120.0, 150.0, 120.0, 120.0, 60.0, 120.0, 120.0, 90.0, 120.0, 90.0, 60.0, 150.0, 60.0, 30.0, 90.0, 60.0, 120.0, 150.0, 90.0, 60.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 90.0, 30.0, 60.0, 150.0, 90.0, 90.0, 90.0, 90.0, 60.0, 60.0, 60.0, 90.0, 150.0, 90.0, 120.0, 120.0, 90.0, 30.0, 150.0, 120.0, 90.0, 150.0, 120.0, 120.0, 90.0, 120.0, 90.0, 90.0, 150.0, 120.0, 90.0, 120.0, 90.0, 120.0, 90.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.800610275402598, "mean_inference_ms": 60.501644495347776, "mean_action_processing_ms": 0.25257370145728464, "mean_env_wait_ms": 0.17913760575412524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 88039, "timesteps_this_iter": 40, "agent_timesteps_total": 88039, "timers": {"sample_time_ms": 3433.614, "sample_throughput": 11.65, "learn_time_ms": 2501.725, "learn_throughput": 15.989, "update_time_ms": 121.788}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.946368217468262, "grad_norm": 216.14764404296875, "td_error_abs": 2.306654357910156, "q_taken_mean": 30.181742350260418, "target_mean": 30.99554443359375}}}, "num_steps_sampled": 88039, "num_agent_steps_sampled": 88039, "num_steps_trained": 88040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 87879, "num_target_updates": 169}, "done": false, "episodes_total": 8804, "training_iteration": 88, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-30-20", "timestamp": 1648888220, "time_this_iter_s": 86.18325877189636, "time_total_s": 7785.617964982986, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7785.617964982986, "timesteps_since_restore": 3520, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 23.664227642276426, "ram_util_percent": 84.10081300813007}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 99.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 120.0, 90.0, 60.0, 150.0, 120.0, 90.0, 90.0, 60.0, 90.0, 90.0, 60.0, 60.0, 120.0, 60.0, 90.0, 120.0, 30.0, 60.0, 120.0, 30.0, 90.0, 120.0, 150.0, 120.0, 120.0, 60.0, 60.0, 60.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 90.0, 120.0, 120.0, 30.0, 120.0, 150.0, 120.0, 90.0, 120.0, 60.0, 120.0, 120.0, 60.0, 90.0, 150.0, 60.0, 120.0, 90.0, 120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 90.0, 90.0, 150.0, 60.0, 90.0, 120.0, 120.0, 90.0, 150.0, 120.0, 90.0, 90.0, 90.0, 90.0, 90.0, 60.0, 90.0, 60.0, 120.0, 120.0, 90.0, 90.0, 90.0, 150.0, 90.0, 90.0, 90.0, 60.0, 150.0, 120.0, 90.0, 90.0, 90.0, 120.0, 150.0, 120.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7998646548062304, "mean_inference_ms": 60.45751841138866, "mean_action_processing_ms": 0.2524071440251909, "mean_env_wait_ms": 0.17900260401320467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 89039, "timesteps_this_iter": 40, "agent_timesteps_total": 89039, "timers": {"sample_time_ms": 3432.957, "sample_throughput": 11.652, "learn_time_ms": 2510.61, "learn_throughput": 15.932, "update_time_ms": 91.961}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.229228019714355, "grad_norm": 222.388427734375, "td_error_abs": 2.6483500162760416, "q_taken_mean": 28.121687825520834, "target_mean": 26.92279052734375}}}, "num_steps_sampled": 89039, "num_agent_steps_sampled": 89039, "num_steps_trained": 89040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 88919, "num_target_updates": 171}, "done": false, "episodes_total": 8904, "training_iteration": 89, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-31-45", "timestamp": 1648888305, "time_this_iter_s": 85.50192523002625, "time_total_s": 7871.119890213013, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7871.119890213013, "timesteps_since_restore": 3560, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 23.821487603305787, "ram_util_percent": 84.3793388429752}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 101.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 90.0, 120.0, 120.0, 120.0, 60.0, 120.0, 90.0, 60.0, 90.0, 120.0, 60.0, 60.0, 60.0, 120.0, 90.0, 90.0, 60.0, 60.0, 90.0, 120.0, 120.0, 90.0, 150.0, 90.0, 120.0, 90.0, 60.0, 90.0, 120.0, 120.0, 90.0, 90.0, 60.0, 90.0, 60.0, 150.0, 120.0, 120.0, 120.0, 60.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 30.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 90.0, 90.0, 60.0, 90.0, 60.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 150.0, 90.0, 120.0, 30.0, 120.0, 150.0, 60.0, 90.0, 90.0, 150.0, 120.0, 120.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7991033189326109, "mean_inference_ms": 60.406450402227584, "mean_action_processing_ms": 0.25219436075639806, "mean_env_wait_ms": 0.17885954601996965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 90039, "timesteps_this_iter": 40, "agent_timesteps_total": 90039, "timers": {"sample_time_ms": 3458.284, "sample_throughput": 11.566, "learn_time_ms": 2560.511, "learn_throughput": 15.622, "update_time_ms": 87.279}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 18.090614318847656, "grad_norm": 379.1739807128906, "td_error_abs": 3.2558321634928387, "q_taken_mean": 33.877008056640626, "target_mean": 35.376399739583334}}}, "num_steps_sampled": 90039, "num_agent_steps_sampled": 90039, "num_steps_trained": 90040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 89959, "num_target_updates": 173}, "done": false, "episodes_total": 9004, "training_iteration": 90, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-33-11", "timestamp": 1648888391, "time_this_iter_s": 85.67342853546143, "time_total_s": 7956.793318748474, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7956.793318748474, "timesteps_since_restore": 3600, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 23.47622950819672, "ram_util_percent": 84.77131147540985}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 101.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 30.0, 60.0, 90.0, 90.0, 120.0, 150.0, 90.0, 60.0, 90.0, 60.0, 60.0, 90.0, 120.0, 120.0, 60.0, 90.0, 60.0, 90.0, 120.0, 120.0, 90.0, 120.0, 60.0, 150.0, 90.0, 90.0, 120.0, 120.0, 60.0, 60.0, 120.0, 120.0, 60.0, 90.0, 90.0, 90.0, 60.0, 90.0, 90.0, 60.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 90.0, 90.0, 120.0, 150.0, 90.0, 120.0, 120.0, 60.0, 120.0, 90.0, 120.0, 90.0, 120.0, 150.0, 120.0, 60.0, 90.0, 90.0, 60.0, 120.0, 90.0, 90.0, 90.0, 120.0, 150.0, 150.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 60.0, 60.0, 90.0, 120.0, 90.0, 90.0, 120.0, 90.0, 60.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7984624300909894, "mean_inference_ms": 60.36760323970348, "mean_action_processing_ms": 0.252036249477791, "mean_env_wait_ms": 0.17874455157923777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 91039, "timesteps_this_iter": 40, "agent_timesteps_total": 91039, "timers": {"sample_time_ms": 3428.472, "sample_throughput": 11.667, "learn_time_ms": 2508.338, "learn_throughput": 15.947, "update_time_ms": 97.064}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.216635704040527, "grad_norm": 210.11279296875, "td_error_abs": 2.3538197835286456, "q_taken_mean": 33.688698323567706, "target_mean": 33.59371337890625}}}, "num_steps_sampled": 91039, "num_agent_steps_sampled": 91039, "num_steps_trained": 91040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 90999, "num_target_updates": 175}, "done": false, "episodes_total": 9104, "training_iteration": 91, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-34-37", "timestamp": 1648888477, "time_this_iter_s": 85.6310384273529, "time_total_s": 8042.424357175827, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8042.424357175827, "timesteps_since_restore": 3640, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 23.511475409836063, "ram_util_percent": 85.06639344262294}}
{"episode_reward_max": 150.0, "episode_reward_min": 0.0, "episode_reward_mean": 96.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 150.0, 90.0, 120.0, 150.0, 90.0, 120.0, 90.0, 0.0, 60.0, 120.0, 60.0, 90.0, 120.0, 150.0, 90.0, 120.0, 90.0, 120.0, 60.0, 60.0, 150.0, 90.0, 60.0, 120.0, 120.0, 150.0, 150.0, 150.0, 90.0, 90.0, 90.0, 90.0, 150.0, 0.0, 60.0, 120.0, 120.0, 60.0, 60.0, 150.0, 90.0, 90.0, 120.0, 120.0, 60.0, 60.0, 150.0, 60.0, 90.0, 90.0, 90.0, 90.0, 120.0, 120.0, 90.0, 30.0, 120.0, 60.0, 90.0, 150.0, 120.0, 90.0, 90.0, 90.0, 60.0, 90.0, 120.0, 120.0, 60.0, 30.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 120.0, 30.0, 120.0, 90.0, 120.0, 60.0, 90.0, 150.0, 120.0, 150.0, 90.0, 90.0, 90.0, 150.0, 90.0, 90.0, 90.0, 90.0, 60.0, 120.0, 60.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7978308524487008, "mean_inference_ms": 60.32106796226432, "mean_action_processing_ms": 0.2518769313949491, "mean_env_wait_ms": 0.1786293712452384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 92039, "timesteps_this_iter": 40, "agent_timesteps_total": 92039, "timers": {"sample_time_ms": 3442.828, "sample_throughput": 11.618, "learn_time_ms": 2521.126, "learn_throughput": 15.866, "update_time_ms": 101.195}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.59749984741211, "grad_norm": 259.557861328125, "td_error_abs": 2.4269284566243488, "q_taken_mean": 28.719270833333333, "target_mean": 28.55533650716146}}}, "num_steps_sampled": 92039, "num_agent_steps_sampled": 92039, "num_steps_trained": 92040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 92039, "num_target_updates": 177}, "done": false, "episodes_total": 9204, "training_iteration": 92, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-36-03", "timestamp": 1648888563, "time_this_iter_s": 86.21885323524475, "time_total_s": 8128.643210411072, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8128.643210411072, "timesteps_since_restore": 3680, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 23.706504065040654, "ram_util_percent": 85.27967479674797}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 100.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 90.0, 120.0, 60.0, 90.0, 120.0, 120.0, 90.0, 60.0, 150.0, 30.0, 120.0, 120.0, 60.0, 120.0, 120.0, 120.0, 90.0, 90.0, 60.0, 90.0, 120.0, 90.0, 120.0, 90.0, 150.0, 120.0, 90.0, 120.0, 120.0, 150.0, 60.0, 120.0, 60.0, 120.0, 60.0, 30.0, 90.0, 60.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 60.0, 60.0, 90.0, 120.0, 120.0, 150.0, 90.0, 60.0, 90.0, 60.0, 90.0, 90.0, 120.0, 120.0, 150.0, 120.0, 150.0, 60.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 60.0, 90.0, 90.0, 150.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 90.0, 90.0, 120.0, 150.0, 60.0, 60.0, 90.0, 90.0, 120.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7972246946048526, "mean_inference_ms": 60.284631489225994, "mean_action_processing_ms": 0.251713165696223, "mean_env_wait_ms": 0.1785091229461544, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 93039, "timesteps_this_iter": 40, "agent_timesteps_total": 93039, "timers": {"sample_time_ms": 3500.2, "sample_throughput": 11.428, "learn_time_ms": 2555.703, "learn_throughput": 15.651, "update_time_ms": 101.895}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 13.082478523254395, "grad_norm": 216.5418701171875, "td_error_abs": 2.9453709920247397, "q_taken_mean": 32.689031982421874, "target_mean": 31.494866943359376}}}, "num_steps_sampled": 93039, "num_agent_steps_sampled": 93039, "num_steps_trained": 93040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 92559, "num_target_updates": 178}, "done": false, "episodes_total": 9304, "training_iteration": 93, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-37-29", "timestamp": 1648888649, "time_this_iter_s": 86.2610535621643, "time_total_s": 8214.904263973236, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8214.904263973236, "timesteps_since_restore": 3720, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 23.611382113821136, "ram_util_percent": 85.57398373983739}}
{"episode_reward_max": 180.0, "episode_reward_min": 30.0, "episode_reward_mean": 109.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 30.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 120.0, 60.0, 120.0, 90.0, 120.0, 150.0, 90.0, 150.0, 60.0, 60.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 60.0, 60.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0, 60.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 150.0, 180.0, 150.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 60.0, 90.0, 90.0, 90.0, 90.0, 60.0, 90.0, 120.0, 150.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7969914874931703, "mean_inference_ms": 60.27764591334428, "mean_action_processing_ms": 0.25164770219842514, "mean_env_wait_ms": 0.178470130315576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 94039, "timesteps_this_iter": 40, "agent_timesteps_total": 94039, "timers": {"sample_time_ms": 3503.989, "sample_throughput": 11.416, "learn_time_ms": 2542.594, "learn_throughput": 15.732, "update_time_ms": 117.546}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.540413856506348, "grad_norm": 265.5287170410156, "td_error_abs": 2.8674657185872396, "q_taken_mean": 34.925390625, "target_mean": 34.568440755208336}}}, "num_steps_sampled": 94039, "num_agent_steps_sampled": 94039, "num_steps_trained": 94040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 93599, "num_target_updates": 180}, "done": false, "episodes_total": 9404, "training_iteration": 94, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-38-57", "timestamp": 1648888737, "time_this_iter_s": 88.05747389793396, "time_total_s": 8302.96173787117, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8302.96173787117, "timesteps_since_restore": 3760, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 23.6288, "ram_util_percent": 86.064}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 97.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 90.0, 60.0, 120.0, 90.0, 120.0, 120.0, 90.0, 60.0, 90.0, 90.0, 120.0, 90.0, 60.0, 120.0, 90.0, 90.0, 90.0, 120.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 90.0, 90.0, 90.0, 30.0, 90.0, 120.0, 120.0, 120.0, 150.0, 90.0, 90.0, 120.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 60.0, 120.0, 120.0, 60.0, 90.0, 120.0, 30.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 60.0, 90.0, 60.0, 60.0, 90.0, 120.0, 150.0, 120.0, 90.0, 120.0, 90.0, 90.0, 90.0, 60.0, 60.0, 90.0, 90.0, 150.0, 120.0, 120.0, 120.0, 90.0, 60.0, 120.0, 60.0, 60.0, 60.0, 90.0, 120.0, 90.0, 150.0, 60.0, 120.0, 120.0, 90.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7964452585622281, "mean_inference_ms": 60.24426704688083, "mean_action_processing_ms": 0.2515086508286119, "mean_env_wait_ms": 0.17836467366680764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 95039, "timesteps_this_iter": 40, "agent_timesteps_total": 95039, "timers": {"sample_time_ms": 3478.127, "sample_throughput": 11.5, "learn_time_ms": 2550.058, "learn_throughput": 15.686, "update_time_ms": 126.511}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.932291984558105, "grad_norm": 188.5364532470703, "td_error_abs": 2.3504061381022137, "q_taken_mean": 30.099589029947918, "target_mean": 29.23880615234375}}}, "num_steps_sampled": 95039, "num_agent_steps_sampled": 95039, "num_steps_trained": 95040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 94639, "num_target_updates": 182}, "done": false, "episodes_total": 9504, "training_iteration": 95, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-40-25", "timestamp": 1648888825, "time_this_iter_s": 87.13315653800964, "time_total_s": 8390.09489440918, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8390.09489440918, "timesteps_since_restore": 3800, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 23.432258064516127, "ram_util_percent": 86.23064516129031}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 96.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 90.0, 90.0, 90.0, 90.0, 120.0, 60.0, 90.0, 90.0, 90.0, 120.0, 150.0, 90.0, 120.0, 120.0, 90.0, 90.0, 90.0, 60.0, 120.0, 90.0, 90.0, 90.0, 90.0, 90.0, 120.0, 60.0, 120.0, 60.0, 90.0, 120.0, 90.0, 90.0, 90.0, 120.0, 150.0, 60.0, 150.0, 150.0, 60.0, 60.0, 60.0, 90.0, 30.0, 120.0, 60.0, 90.0, 150.0, 90.0, 60.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 60.0, 60.0, 60.0, 120.0, 60.0, 60.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 150.0, 90.0, 90.0, 60.0, 120.0, 90.0, 60.0, 60.0, 60.0, 120.0, 150.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7960363208339553, "mean_inference_ms": 60.21024559272757, "mean_action_processing_ms": 0.2513736846042754, "mean_env_wait_ms": 0.17828354413053582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 96039, "timesteps_this_iter": 40, "agent_timesteps_total": 96039, "timers": {"sample_time_ms": 3479.708, "sample_throughput": 11.495, "learn_time_ms": 2555.69, "learn_throughput": 15.651, "update_time_ms": 105.381}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.003607273101807, "grad_norm": 164.96270751953125, "td_error_abs": 2.0605367024739585, "q_taken_mean": 28.473775227864582, "target_mean": 28.326517740885418}}}, "num_steps_sampled": 96039, "num_agent_steps_sampled": 96039, "num_steps_trained": 96040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 95679, "num_target_updates": 184}, "done": false, "episodes_total": 9604, "training_iteration": 96, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-41-52", "timestamp": 1648888912, "time_this_iter_s": 87.48558783531189, "time_total_s": 8477.580482244492, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8477.580482244492, "timesteps_since_restore": 3840, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 23.501600000000003, "ram_util_percent": 86.6616}}
{"episode_reward_max": 180.0, "episode_reward_min": 30.0, "episode_reward_mean": 108.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 90.0, 150.0, 120.0, 60.0, 60.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 180.0, 90.0, 120.0, 90.0, 120.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 90.0, 90.0, 90.0, 30.0, 120.0, 90.0, 120.0, 90.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0, 90.0, 120.0, 60.0, 90.0, 90.0, 90.0, 90.0, 120.0, 150.0, 150.0, 120.0, 90.0, 150.0, 90.0, 120.0, 120.0, 60.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 30.0, 120.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7956403753716833, "mean_inference_ms": 60.185704194649304, "mean_action_processing_ms": 0.2512810469097719, "mean_env_wait_ms": 0.17822922695467888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 97039, "timesteps_this_iter": 40, "agent_timesteps_total": 97039, "timers": {"sample_time_ms": 3528.168, "sample_throughput": 11.337, "learn_time_ms": 2573.172, "learn_throughput": 15.545, "update_time_ms": 132.963}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 13.72475814819336, "grad_norm": 283.3201904296875, "td_error_abs": 2.493122355143229, "q_taken_mean": 30.358394368489584, "target_mean": 29.829150390625}}}, "num_steps_sampled": 97039, "num_agent_steps_sampled": 97039, "num_steps_trained": 97040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 96719, "num_target_updates": 186}, "done": false, "episodes_total": 9704, "training_iteration": 97, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-43-20", "timestamp": 1648889000, "time_this_iter_s": 87.74935173988342, "time_total_s": 8565.329833984375, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8565.329833984375, "timesteps_since_restore": 3880, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.524800000000003, "ram_util_percent": 86.9992}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 108.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 90.0, 90.0, 150.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 60.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 60.0, 60.0, 120.0, 90.0, 150.0, 120.0, 90.0, 60.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 120.0, 150.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 60.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7949555205755716, "mean_inference_ms": 60.1409678535149, "mean_action_processing_ms": 0.25110325167329783, "mean_env_wait_ms": 0.17812315669220952, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 98039, "timesteps_this_iter": 40, "agent_timesteps_total": 98039, "timers": {"sample_time_ms": 3487.913, "sample_throughput": 11.468, "learn_time_ms": 2552.757, "learn_throughput": 15.669, "update_time_ms": 125.621}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 13.825295448303223, "grad_norm": 191.48623657226562, "td_error_abs": 2.6881062825520834, "q_taken_mean": 26.023976643880207, "target_mean": 26.3384521484375}}}, "num_steps_sampled": 98039, "num_agent_steps_sampled": 98039, "num_steps_trained": 98040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 97759, "num_target_updates": 188}, "done": false, "episodes_total": 9804, "training_iteration": 98, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-44-47", "timestamp": 1648889087, "time_this_iter_s": 87.4330563545227, "time_total_s": 8652.762890338898, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8652.762890338898, "timesteps_since_restore": 3920, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 23.391935483870967, "ram_util_percent": 87.16774193548389}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 111.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 150.0, 120.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 150.0, 90.0, 120.0, 90.0, 60.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 60.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 90.0, 150.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 60.0, 90.0, 120.0, 30.0, 90.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7944098265451675, "mean_inference_ms": 60.10479364127652, "mean_action_processing_ms": 0.25094281394000534, "mean_env_wait_ms": 0.17804217823339136, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 99039, "timesteps_this_iter": 40, "agent_timesteps_total": 99039, "timers": {"sample_time_ms": 3481.244, "sample_throughput": 11.49, "learn_time_ms": 2549.435, "learn_throughput": 15.69, "update_time_ms": 102.006}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 12.34424877166748, "grad_norm": 220.15357971191406, "td_error_abs": 2.8131487528483072, "q_taken_mean": 31.613189697265625, "target_mean": 31.600858561197917}}}, "num_steps_sampled": 99039, "num_agent_steps_sampled": 99039, "num_steps_trained": 99040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 98799, "num_target_updates": 190}, "done": false, "episodes_total": 9904, "training_iteration": 99, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-46-14", "timestamp": 1648889174, "time_this_iter_s": 87.1741681098938, "time_total_s": 8739.937058448792, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8739.937058448792, "timesteps_since_restore": 3960, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 23.952, "ram_util_percent": 87.4408}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 111.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 150.0, 120.0, 60.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 90.0, 150.0, 90.0, 60.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 30.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7941037177992425, "mean_inference_ms": 60.07906546298746, "mean_action_processing_ms": 0.2508412013410963, "mean_env_wait_ms": 0.17799615194490712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 100039, "timesteps_this_iter": 40, "agent_timesteps_total": 100039, "timers": {"sample_time_ms": 3500.523, "sample_throughput": 11.427, "learn_time_ms": 2538.757, "learn_throughput": 15.756, "update_time_ms": 140.006}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.915087699890137, "grad_norm": 252.94082641601562, "td_error_abs": 2.505998738606771, "q_taken_mean": 30.875028483072917, "target_mean": 31.625799560546874}}}, "num_steps_sampled": 100039, "num_agent_steps_sampled": 100039, "num_steps_trained": 100040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 99839, "num_target_updates": 192}, "done": false, "episodes_total": 10004, "training_iteration": 100, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-47-42", "timestamp": 1648889262, "time_this_iter_s": 87.40459442138672, "time_total_s": 8827.341652870178, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8827.341652870178, "timesteps_since_restore": 4000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 23.504032258064516, "ram_util_percent": 87.84677419354838}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 113.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 60.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 90.0, 120.0, 60.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 90.0, 90.0, 120.0, 120.0, 150.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7933882121690826, "mean_inference_ms": 60.02814059300849, "mean_action_processing_ms": 0.2506517925405317, "mean_env_wait_ms": 0.17787832204914072, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 101039, "timesteps_this_iter": 40, "agent_timesteps_total": 101039, "timers": {"sample_time_ms": 3439.353, "sample_throughput": 11.63, "learn_time_ms": 2517.232, "learn_throughput": 15.89, "update_time_ms": 138.058}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 12.996427536010742, "grad_norm": 215.07571411132812, "td_error_abs": 2.84730224609375, "q_taken_mean": 27.20913289388021, "target_mean": 27.261836751302084}}}, "num_steps_sampled": 101039, "num_agent_steps_sampled": 101039, "num_steps_trained": 101040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 100879, "num_target_updates": 194}, "done": false, "episodes_total": 10104, "training_iteration": 101, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-49-08", "timestamp": 1648889348, "time_this_iter_s": 86.4712119102478, "time_total_s": 8913.812864780426, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8913.812864780426, "timesteps_since_restore": 4040, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 23.348780487804877, "ram_util_percent": 88.15040650406503}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 110.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 60.0, 60.0, 120.0, 60.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 150.0, 60.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 90.0, 90.0, 120.0, 120.0, 120.0, 60.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 60.0, 150.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7928641794090973, "mean_inference_ms": 59.98583203963994, "mean_action_processing_ms": 0.2504913319775495, "mean_env_wait_ms": 0.17776371956932224, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 102039, "timesteps_this_iter": 40, "agent_timesteps_total": 102039, "timers": {"sample_time_ms": 3482.065, "sample_throughput": 11.487, "learn_time_ms": 2569.432, "learn_throughput": 15.568, "update_time_ms": 122.979}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.818370819091797, "grad_norm": 330.46881103515625, "td_error_abs": 2.791576639811198, "q_taken_mean": 31.527345784505208, "target_mean": 29.469405110677084}}}, "num_steps_sampled": 102039, "num_agent_steps_sampled": 102039, "num_steps_trained": 102040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 101919, "num_target_updates": 196}, "done": false, "episodes_total": 10204, "training_iteration": 102, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-50-35", "timestamp": 1648889435, "time_this_iter_s": 87.03011870384216, "time_total_s": 9000.842983484268, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9000.842983484268, "timesteps_since_restore": 4080, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 23.204032258064515, "ram_util_percent": 88.31290322580645}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 102.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 150.0, 60.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 60.0, 120.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 120.0, 60.0, 120.0, 150.0, 120.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 60.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 90.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 60.0, 120.0, 90.0, 120.0, 90.0, 90.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 120.0, 60.0, 120.0, 60.0, 120.0, 120.0, 120.0, 60.0, 120.0, 90.0, 90.0, 90.0, 90.0, 90.0, 90.0, 150.0, 120.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7920976936852042, "mean_inference_ms": 59.92882702040486, "mean_action_processing_ms": 0.25024962362096603, "mean_env_wait_ms": 0.17762263902937722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 103039, "timesteps_this_iter": 40, "agent_timesteps_total": 103039, "timers": {"sample_time_ms": 3415.381, "sample_throughput": 11.712, "learn_time_ms": 2475.918, "learn_throughput": 16.156, "update_time_ms": 145.192}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 22.305002212524414, "grad_norm": 559.0844116210938, "td_error_abs": 3.7927462259928384, "q_taken_mean": 31.876993815104168, "target_mean": 33.71119791666667}}}, "num_steps_sampled": 103039, "num_agent_steps_sampled": 103039, "num_steps_trained": 103040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 102959, "num_target_updates": 198}, "done": false, "episodes_total": 10304, "training_iteration": 103, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-52-01", "timestamp": 1648889521, "time_this_iter_s": 85.57176184654236, "time_total_s": 9086.41474533081, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9086.41474533081, "timesteps_since_restore": 4120, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 22.95245901639344, "ram_util_percent": 88.73114754098364}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 117.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7911473110104207, "mean_inference_ms": 59.85876519159768, "mean_action_processing_ms": 0.24994755527631882, "mean_env_wait_ms": 0.17742548593326832, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 104039, "timesteps_this_iter": 40, "agent_timesteps_total": 104039, "timers": {"sample_time_ms": 3433.057, "sample_throughput": 11.651, "learn_time_ms": 2515.064, "learn_throughput": 15.904, "update_time_ms": 137.031}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.017030715942383, "grad_norm": 144.30052185058594, "td_error_abs": 1.8933438618977865, "q_taken_mean": 26.0350341796875, "target_mean": 26.69515584309896}}}, "num_steps_sampled": 104039, "num_agent_steps_sampled": 104039, "num_steps_trained": 104040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 103999, "num_target_updates": 200}, "done": false, "episodes_total": 10404, "training_iteration": 104, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-53-26", "timestamp": 1648889606, "time_this_iter_s": 85.25809335708618, "time_total_s": 9171.672838687897, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9171.672838687897, "timesteps_since_restore": 4160, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 23.459504132231405, "ram_util_percent": 88.94297520661158}}
{"episode_reward_max": 180.0, "episode_reward_min": 60.0, "episode_reward_mean": 114.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 180.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0, 90.0, 120.0, 120.0, 120.0, 60.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 90.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 60.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7901597905465558, "mean_inference_ms": 59.783700924318346, "mean_action_processing_ms": 0.24964495116951516, "mean_env_wait_ms": 0.1772196303953689, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 105039, "timesteps_this_iter": 40, "agent_timesteps_total": 105039, "timers": {"sample_time_ms": 3389.546, "sample_throughput": 11.801, "learn_time_ms": 2502.182, "learn_throughput": 15.986, "update_time_ms": 128.376}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.391785621643066, "grad_norm": 262.29351806640625, "td_error_abs": 2.4300323486328126, "q_taken_mean": 33.643741861979166, "target_mean": 33.601847330729164}}}, "num_steps_sampled": 105039, "num_agent_steps_sampled": 105039, "num_steps_trained": 105040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 105039, "num_target_updates": 202}, "done": false, "episodes_total": 10504, "training_iteration": 105, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-54-51", "timestamp": 1648889691, "time_this_iter_s": 84.61704111099243, "time_total_s": 9256.28987979889, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9256.28987979889, "timesteps_since_restore": 4200, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 23.0625, "ram_util_percent": 89.2475}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 120.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7891300880665342, "mean_inference_ms": 59.70466041562024, "mean_action_processing_ms": 0.2493353060193536, "mean_env_wait_ms": 0.1769933571006466, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 106039, "timesteps_this_iter": 40, "agent_timesteps_total": 106039, "timers": {"sample_time_ms": 3420.516, "sample_throughput": 11.694, "learn_time_ms": 2549.156, "learn_throughput": 15.691, "update_time_ms": 127.779}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 20.27449607849121, "grad_norm": 509.3505859375, "td_error_abs": 3.5976720174153645, "q_taken_mean": 32.42953694661458, "target_mean": 33.237685139973955}}}, "num_steps_sampled": 106039, "num_agent_steps_sampled": 106039, "num_steps_trained": 106040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 105559, "num_target_updates": 203}, "done": false, "episodes_total": 10604, "training_iteration": 106, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-56-17", "timestamp": 1648889777, "time_this_iter_s": 85.57516551017761, "time_total_s": 9341.865045309067, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9341.865045309067, "timesteps_since_restore": 4240, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 23.264754098360655, "ram_util_percent": 89.5827868852459}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 120.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 150.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 60.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7880790587039584, "mean_inference_ms": 59.62883008050424, "mean_action_processing_ms": 0.2490289384515869, "mean_env_wait_ms": 0.1767897472188873, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 107039, "timesteps_this_iter": 40, "agent_timesteps_total": 107039, "timers": {"sample_time_ms": 3461.254, "sample_throughput": 11.557, "learn_time_ms": 2577.156, "learn_throughput": 15.521, "update_time_ms": 132.758}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.392542839050293, "grad_norm": 190.7407989501953, "td_error_abs": 2.2204518636067707, "q_taken_mean": 28.81075439453125, "target_mean": 29.289495849609374}}}, "num_steps_sampled": 107039, "num_agent_steps_sampled": 107039, "num_steps_trained": 107040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 106599, "num_target_updates": 205}, "done": false, "episodes_total": 10704, "training_iteration": 107, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-57-43", "timestamp": 1648889863, "time_this_iter_s": 86.07766056060791, "time_total_s": 9427.942705869675, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9427.942705869675, "timesteps_since_restore": 4280, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 22.77377049180328, "ram_util_percent": 89.88770491803278}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 122.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 60.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7871230137589555, "mean_inference_ms": 59.55819915035125, "mean_action_processing_ms": 0.2487392248094416, "mean_env_wait_ms": 0.1765811279095462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 108039, "timesteps_this_iter": 40, "agent_timesteps_total": 108039, "timers": {"sample_time_ms": 3478.186, "sample_throughput": 11.5, "learn_time_ms": 2604.061, "learn_throughput": 15.361, "update_time_ms": 149.865}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.3544111251831055, "grad_norm": 383.1780700683594, "td_error_abs": 1.7043851216634114, "q_taken_mean": 31.647920735677083, "target_mean": 33.108331298828126}}}, "num_steps_sampled": 108039, "num_agent_steps_sampled": 108039, "num_steps_trained": 108040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 107639, "num_target_updates": 207}, "done": false, "episodes_total": 10804, "training_iteration": 108, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_01-59-10", "timestamp": 1648889950, "time_this_iter_s": 87.49224734306335, "time_total_s": 9515.434953212738, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9515.434953212738, "timesteps_since_restore": 4320, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 23.292, "ram_util_percent": 90.13599999999998}}
{"episode_reward_max": 180.0, "episode_reward_min": 30.0, "episode_reward_mean": 119.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 90.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 30.0, 120.0, 60.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 30.0, 120.0, 120.0, 90.0, 120.0, 120.0, 180.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 150.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7861820848358292, "mean_inference_ms": 59.485144132626935, "mean_action_processing_ms": 0.24843715374731018, "mean_env_wait_ms": 0.17636857730940464, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 109039, "timesteps_this_iter": 40, "agent_timesteps_total": 109039, "timers": {"sample_time_ms": 3530.463, "sample_throughput": 11.33, "learn_time_ms": 2638.775, "learn_throughput": 15.159, "update_time_ms": 133.995}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.573393821716309, "grad_norm": 218.22186279296875, "td_error_abs": 2.316045125325521, "q_taken_mean": 31.27155965169271, "target_mean": 31.798881022135415}}}, "num_steps_sampled": 109039, "num_agent_steps_sampled": 109039, "num_steps_trained": 109040, "num_steps_trained_this_iter": 40, "last_target_update_ts": 108679, "num_target_updates": 209}, "done": false, "episodes_total": 10904, "training_iteration": 109, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-00-38", "timestamp": 1648890038, "time_this_iter_s": 88.12368774414062, "time_total_s": 9603.558640956879, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9603.558640956879, "timesteps_since_restore": 4360, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 22.94206349206349, "ram_util_percent": 90.54126984126985}}
{"episode_reward_max": 180.0, "episode_reward_min": 30.0, "episode_reward_mean": 117.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 180.0, 120.0, 30.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 60.0, 120.0, 90.0, 120.0, 120.0, 150.0, 90.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 180.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 60.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7853005152727027, "mean_inference_ms": 59.41715345686885, "mean_action_processing_ms": 0.2481508120930984, "mean_env_wait_ms": 0.17617335971209802, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 110039, "timesteps_this_iter": 40, "agent_timesteps_total": 110039, "timers": {"sample_time_ms": 3781.512, "sample_throughput": 10.551, "learn_time_ms": 2904.006, "learn_throughput": 13.74, "update_time_ms": 128.574}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.108641624450684, "grad_norm": 132.13555908203125, "td_error_abs": 2.2293629964192707, "q_taken_mean": 29.02608642578125, "target_mean": 29.061586507161458}}}, "num_steps_sampled": 110039, "num_agent_steps_sampled": 110039, "num_steps_trained": 110039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 109719, "num_target_updates": 211}, "done": false, "episodes_total": 11004, "training_iteration": 110, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-02-11", "timestamp": 1648890131, "time_this_iter_s": 92.30693411827087, "time_total_s": 9695.86557507515, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9695.86557507515, "timesteps_since_restore": 4400, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 22.874809160305347, "ram_util_percent": 90.77709923664122}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 128.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 60.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 60.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 60.0, 90.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 60.0, 120.0, 150.0, 120.0, 120.0, 90.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7843498567303641, "mean_inference_ms": 59.349513038270615, "mean_action_processing_ms": 0.2478621926800826, "mean_env_wait_ms": 0.17598454382153583, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 111039, "timesteps_this_iter": 40, "agent_timesteps_total": 111039, "timers": {"sample_time_ms": 3884.971, "sample_throughput": 10.296, "learn_time_ms": 2955.813, "learn_throughput": 13.533, "update_time_ms": 156.583}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.984414100646973, "grad_norm": 128.82275390625, "td_error_abs": 1.731848907470703, "q_taken_mean": 27.808772786458334, "target_mean": 27.525807698567707}}}, "num_steps_sampled": 111039, "num_agent_steps_sampled": 111039, "num_steps_trained": 111039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 110759, "num_target_updates": 213}, "done": false, "episodes_total": 11104, "training_iteration": 111, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-03-46", "timestamp": 1648890226, "time_this_iter_s": 95.49538064002991, "time_total_s": 9791.36095571518, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9791.36095571518, "timesteps_since_restore": 4440, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 22.68222222222222, "ram_util_percent": 91.06592592592594}}
{"episode_reward_max": 180.0, "episode_reward_min": 30.0, "episode_reward_mean": 123.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 150.0, 120.0, 150.0, 120.0, 30.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 90.0, 120.0, 90.0, 180.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 150.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 60.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7834066365490377, "mean_inference_ms": 59.28296565582497, "mean_action_processing_ms": 0.24757961249453309, "mean_env_wait_ms": 0.17580961866505582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 112039, "timesteps_this_iter": 40, "agent_timesteps_total": 112039, "timers": {"sample_time_ms": 3881.809, "sample_throughput": 10.304, "learn_time_ms": 2958.788, "learn_throughput": 13.519, "update_time_ms": 164.602}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.96342134475708, "grad_norm": 255.1855926513672, "td_error_abs": 2.2627944946289062, "q_taken_mean": 31.234682210286458, "target_mean": 30.3576416015625}}}, "num_steps_sampled": 112039, "num_agent_steps_sampled": 112039, "num_steps_trained": 112039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 111799, "num_target_updates": 215}, "done": false, "episodes_total": 11204, "training_iteration": 112, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-05-23", "timestamp": 1648890323, "time_this_iter_s": 97.28675866127014, "time_total_s": 9888.64771437645, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9888.64771437645, "timesteps_since_restore": 4480, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 22.70144927536232, "ram_util_percent": 90.42753623188406}}
{"episode_reward_max": 150.0, "episode_reward_min": 90.0, "episode_reward_mean": 131.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 120.0, 90.0, 150.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 120.0, 90.0, 120.0, 150.0, 90.0, 90.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 120.0, 90.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 90.0, 120.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 90.0, 120.0, 150.0, 120.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7823761809221577, "mean_inference_ms": 59.21510273221646, "mean_action_processing_ms": 0.24727282285537902, "mean_env_wait_ms": 0.17559521420032087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 113039, "timesteps_this_iter": 40, "agent_timesteps_total": 113039, "timers": {"sample_time_ms": 3758.602, "sample_throughput": 10.642, "learn_time_ms": 2860.159, "learn_throughput": 13.985, "update_time_ms": 134.922}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.715155601501465, "grad_norm": 282.0661315917969, "td_error_abs": 2.124550374348958, "q_taken_mean": 36.516215006510414, "target_mean": 35.2747314453125}}}, "num_steps_sampled": 113039, "num_agent_steps_sampled": 113039, "num_steps_trained": 113039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 112839, "num_target_updates": 217}, "done": false, "episodes_total": 11304, "training_iteration": 113, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-06-58", "timestamp": 1648890418, "time_this_iter_s": 94.9399778842926, "time_total_s": 9983.587692260742, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9983.587692260742, "timesteps_since_restore": 4520, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 22.31185185185185, "ram_util_percent": 90.6962962962963}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 127.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 150.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 150.0, 150.0, 150.0, 60.0, 150.0, 120.0, 120.0, 150.0, 120.0, 150.0, 150.0, 90.0, 150.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 90.0, 120.0, 120.0, 90.0, 150.0, 150.0, 150.0, 150.0, 90.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7813956185964256, "mean_inference_ms": 59.146380408578445, "mean_action_processing_ms": 0.24697534819694666, "mean_env_wait_ms": 0.17538453443550786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 114039, "timesteps_this_iter": 40, "agent_timesteps_total": 114039, "timers": {"sample_time_ms": 3781.614, "sample_throughput": 10.577, "learn_time_ms": 2849.19, "learn_throughput": 14.039, "update_time_ms": 131.789}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 13.720569610595703, "grad_norm": 477.77520751953125, "td_error_abs": 2.4067527770996096, "q_taken_mean": 27.906722005208334, "target_mean": 29.787654622395834}}}, "num_steps_sampled": 114039, "num_agent_steps_sampled": 114039, "num_steps_trained": 114039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 113879, "num_target_updates": 219}, "done": false, "episodes_total": 11404, "training_iteration": 114, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-08-34", "timestamp": 1648890514, "time_this_iter_s": 95.07249665260315, "time_total_s": 10078.660188913345, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10078.660188913345, "timesteps_since_restore": 4560, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 22.191851851851847, "ram_util_percent": 91.01481481481481}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 119.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 60.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 90.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 30.0, 120.0, 120.0, 150.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 120.0, 150.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 90.0, 90.0, 120.0, 60.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.780558526876713, "mean_inference_ms": 59.08333492469906, "mean_action_processing_ms": 0.24670869319489447, "mean_env_wait_ms": 0.17521610362057877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 115039, "timesteps_this_iter": 40, "agent_timesteps_total": 115039, "timers": {"sample_time_ms": 3820.976, "sample_throughput": 10.469, "learn_time_ms": 2925.994, "learn_throughput": 13.671, "update_time_ms": 148.712}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.511218070983887, "grad_norm": 161.91937255859375, "td_error_abs": 2.412825266520182, "q_taken_mean": 28.373492431640624, "target_mean": 27.91002197265625}}}, "num_steps_sampled": 115039, "num_agent_steps_sampled": 115039, "num_steps_trained": 115039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 114919, "num_target_updates": 221}, "done": false, "episodes_total": 11504, "training_iteration": 115, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-10-09", "timestamp": 1648890609, "time_this_iter_s": 95.30504536628723, "time_total_s": 10173.965234279633, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10173.965234279633, "timesteps_since_restore": 4600, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 22.500740740740742, "ram_util_percent": 91.35037037037037}}
{"episode_reward_max": 180.0, "episode_reward_min": 60.0, "episode_reward_mean": 117.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 60.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 120.0, 120.0, 180.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 150.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7797781189106116, "mean_inference_ms": 59.02074259012001, "mean_action_processing_ms": 0.24645074509964085, "mean_env_wait_ms": 0.17504726982938595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 116039, "timesteps_this_iter": 40, "agent_timesteps_total": 116039, "timers": {"sample_time_ms": 3937.103, "sample_throughput": 10.16, "learn_time_ms": 2997.184, "learn_throughput": 13.346, "update_time_ms": 172.503}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 17.95867347717285, "grad_norm": 413.9419250488281, "td_error_abs": 3.1797999064127604, "q_taken_mean": 31.7525634765625, "target_mean": 32.671879069010416}}}, "num_steps_sampled": 116039, "num_agent_steps_sampled": 116039, "num_steps_trained": 116039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 115959, "num_target_updates": 223}, "done": false, "episodes_total": 11604, "training_iteration": 116, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-11-47", "timestamp": 1648890707, "time_this_iter_s": 97.66694784164429, "time_total_s": 10271.632182121277, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10271.632182121277, "timesteps_since_restore": 4640, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 21.95971223021583, "ram_util_percent": 91.6323741007194}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 132.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 90.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 60.0, 150.0, 120.0, 150.0, 120.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7789266329017517, "mean_inference_ms": 58.9582087180099, "mean_action_processing_ms": 0.2461865617651486, "mean_env_wait_ms": 0.1748654041154209, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 117039, "timesteps_this_iter": 40, "agent_timesteps_total": 117039, "timers": {"sample_time_ms": 3839.032, "sample_throughput": 10.419, "learn_time_ms": 2921.403, "learn_throughput": 13.692, "update_time_ms": 173.285}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.067105293273926, "grad_norm": 117.30364227294922, "td_error_abs": 2.1338719685872394, "q_taken_mean": 30.421085611979166, "target_mean": 30.2391357421875}}}, "num_steps_sampled": 117039, "num_agent_steps_sampled": 117039, "num_steps_trained": 117039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 116999, "num_target_updates": 225}, "done": false, "episodes_total": 11704, "training_iteration": 117, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-13-23", "timestamp": 1648890803, "time_this_iter_s": 96.76321697235107, "time_total_s": 10368.395399093628, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10368.395399093628, "timesteps_since_restore": 4680, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 22.3992700729927, "ram_util_percent": 91.81751824817518}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 117.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 90.0, 120.0, 150.0, 120.0, 120.0, 90.0, 90.0, 150.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 30.0, 150.0, 120.0, 120.0, 60.0, 150.0, 150.0, 90.0, 90.0, 150.0, 150.0, 120.0, 120.0, 120.0, 90.0, 90.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 90.0, 150.0, 60.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 60.0, 60.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7781970491197893, "mean_inference_ms": 58.90360239565629, "mean_action_processing_ms": 0.24594620175023185, "mean_env_wait_ms": 0.17469882921259938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 118039, "timesteps_this_iter": 40, "agent_timesteps_total": 118039, "timers": {"sample_time_ms": 3865.399, "sample_throughput": 10.348, "learn_time_ms": 2957.321, "learn_throughput": 13.526, "update_time_ms": 166.393}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.36125373840332, "grad_norm": 187.8854217529297, "td_error_abs": 1.495172882080078, "q_taken_mean": 33.01543375651042, "target_mean": 33.55203450520833}}}, "num_steps_sampled": 118039, "num_agent_steps_sampled": 118039, "num_steps_trained": 118039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 118039, "num_target_updates": 227}, "done": false, "episodes_total": 11804, "training_iteration": 118, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-15-01", "timestamp": 1648890901, "time_this_iter_s": 97.4646201133728, "time_total_s": 10465.860019207, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10465.860019207, "timesteps_since_restore": 4720, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 22.21594202898551, "ram_util_percent": 92.1644927536232}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 120.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 150.0, 150.0, 150.0, 120.0, 150.0, 90.0, 120.0, 60.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7773873435733298, "mean_inference_ms": 58.84161605251493, "mean_action_processing_ms": 0.2457059180744837, "mean_env_wait_ms": 0.1745563623195207, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 119039, "timesteps_this_iter": 40, "agent_timesteps_total": 119039, "timers": {"sample_time_ms": 3853.424, "sample_throughput": 10.38, "learn_time_ms": 2935.028, "learn_throughput": 13.628, "update_time_ms": 153.745}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 13.843606948852539, "grad_norm": 337.6084899902344, "td_error_abs": 2.5896268208821613, "q_taken_mean": 33.296461995442705, "target_mean": 34.99630533854167}}}, "num_steps_sampled": 119039, "num_agent_steps_sampled": 119039, "num_steps_trained": 119039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 118559, "num_target_updates": 228}, "done": false, "episodes_total": 11904, "training_iteration": 119, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-16-37", "timestamp": 1648890997, "time_this_iter_s": 96.44498872756958, "time_total_s": 10562.30500793457, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10562.30500793457, "timesteps_since_restore": 4760, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 22.281159420289853, "ram_util_percent": 92.4391304347826}}
{"episode_reward_max": 180.0, "episode_reward_min": 30.0, "episode_reward_mean": 125.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 120.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 30.0, 120.0, 150.0, 150.0, 150.0, 90.0, 90.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 90.0, 150.0, 120.0, 150.0, 150.0, 120.0, 180.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 120.0, 150.0, 120.0, 150.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7765936133437219, "mean_inference_ms": 58.79056431377969, "mean_action_processing_ms": 0.24546236497031593, "mean_env_wait_ms": 0.17439264081809697, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 120039, "timesteps_this_iter": 40, "agent_timesteps_total": 120039, "timers": {"sample_time_ms": 3865.822, "sample_throughput": 10.347, "learn_time_ms": 2945.748, "learn_throughput": 13.579, "update_time_ms": 144.042}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.708589553833008, "grad_norm": 162.42153930664062, "td_error_abs": 1.8170370737711588, "q_taken_mean": 35.47747802734375, "target_mean": 35.651997884114586}}}, "num_steps_sampled": 120039, "num_agent_steps_sampled": 120039, "num_steps_trained": 120039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 119599, "num_target_updates": 230}, "done": false, "episodes_total": 12004, "training_iteration": 120, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-18-14", "timestamp": 1648891094, "time_this_iter_s": 96.884610414505, "time_total_s": 10659.189618349075, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10659.189618349075, "timesteps_since_restore": 4800, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 22.63357664233577, "ram_util_percent": 92.62335766423358}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 120.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 150.0, 120.0, 150.0, 150.0, 120.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 90.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 60.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7757767434736564, "mean_inference_ms": 58.73221413604575, "mean_action_processing_ms": 0.2452152112595423, "mean_env_wait_ms": 0.17421159822491517, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 121039, "timesteps_this_iter": 40, "agent_timesteps_total": 121039, "timers": {"sample_time_ms": 3840.744, "sample_throughput": 10.415, "learn_time_ms": 2914.07, "learn_throughput": 13.727, "update_time_ms": 164.145}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.972978591918945, "grad_norm": 188.91680908203125, "td_error_abs": 1.7137290954589843, "q_taken_mean": 32.70655924479167, "target_mean": 33.70398763020833}}}, "num_steps_sampled": 121039, "num_agent_steps_sampled": 121039, "num_steps_trained": 121039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 120639, "num_target_updates": 232}, "done": false, "episodes_total": 12104, "training_iteration": 121, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-19-50", "timestamp": 1648891190, "time_this_iter_s": 96.13765740394592, "time_total_s": 10755.327275753021, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10755.327275753021, "timesteps_since_restore": 4840, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 22.44014598540146, "ram_util_percent": 92.65912408759124}}
{"episode_reward_max": 180.0, "episode_reward_min": 30.0, "episode_reward_mean": 118.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 90.0, 180.0, 150.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 30.0, 150.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 90.0, 120.0, 180.0, 120.0, 90.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7750193719858618, "mean_inference_ms": 58.67842159831585, "mean_action_processing_ms": 0.2449814672563483, "mean_env_wait_ms": 0.17405380252174166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 122039, "timesteps_this_iter": 40, "agent_timesteps_total": 122039, "timers": {"sample_time_ms": 3840.633, "sample_throughput": 10.415, "learn_time_ms": 2891.248, "learn_throughput": 13.835, "update_time_ms": 193.03}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.807100296020508, "grad_norm": 239.01544189453125, "td_error_abs": 2.4943255106608073, "q_taken_mean": 29.714508056640625, "target_mean": 31.388885498046875}}}, "num_steps_sampled": 122039, "num_agent_steps_sampled": 122039, "num_steps_trained": 122039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 121679, "num_target_updates": 234}, "done": false, "episodes_total": 12204, "training_iteration": 122, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-21-26", "timestamp": 1648891286, "time_this_iter_s": 95.98936629295349, "time_total_s": 10851.316642045975, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10851.316642045975, "timesteps_since_restore": 4880, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 22.40073529411765, "ram_util_percent": 92.675}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 121.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 30.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 60.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0, 120.0, 120.0, 90.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 120.0, 150.0, 150.0, 120.0, 120.0, 90.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.774280128356037, "mean_inference_ms": 58.62302470383863, "mean_action_processing_ms": 0.24474137530812703, "mean_env_wait_ms": 0.1739039355362277, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 123039, "timesteps_this_iter": 40, "agent_timesteps_total": 123039, "timers": {"sample_time_ms": 3747.616, "sample_throughput": 10.673, "learn_time_ms": 2818.102, "learn_throughput": 14.194, "update_time_ms": 185.33}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 13.281338691711426, "grad_norm": 271.27337646484375, "td_error_abs": 2.7018363952636717, "q_taken_mean": 32.80266520182292, "target_mean": 34.23152262369792}}}, "num_steps_sampled": 123039, "num_agent_steps_sampled": 123039, "num_steps_trained": 123039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 122719, "num_target_updates": 236}, "done": false, "episodes_total": 12304, "training_iteration": 123, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-23-01", "timestamp": 1648891381, "time_this_iter_s": 94.42110204696655, "time_total_s": 10945.737744092941, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10945.737744092941, "timesteps_since_restore": 4920, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 22.157462686567165, "ram_util_percent": 92.69477611940299}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 110.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 60.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 150.0, 90.0, 90.0, 90.0, 90.0, 150.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 90.0, 90.0, 90.0, 60.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 150.0, 90.0, 90.0, 120.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7736263601157415, "mean_inference_ms": 58.5769412885716, "mean_action_processing_ms": 0.2445385365805108, "mean_env_wait_ms": 0.1737706923899975, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 124039, "timesteps_this_iter": 40, "agent_timesteps_total": 124039, "timers": {"sample_time_ms": 3748.774, "sample_throughput": 10.67, "learn_time_ms": 2750.005, "learn_throughput": 14.545, "update_time_ms": 227.876}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.664943218231201, "grad_norm": 119.06468200683594, "td_error_abs": 1.7276273091634116, "q_taken_mean": 30.605216471354165, "target_mean": 30.66153767903646}}}, "num_steps_sampled": 124039, "num_agent_steps_sampled": 124039, "num_steps_trained": 124039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 123759, "num_target_updates": 238}, "done": false, "episodes_total": 12404, "training_iteration": 124, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-24-35", "timestamp": 1648891475, "time_this_iter_s": 93.84350895881653, "time_total_s": 11039.581253051758, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11039.581253051758, "timesteps_since_restore": 4960, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 22.556923076923074, "ram_util_percent": 92.59846153846154}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 108.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 60.0, 90.0, 120.0, 120.0, 90.0, 90.0, 90.0, 30.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 120.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 150.0, 60.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.772832157451696, "mean_inference_ms": 58.52163368562371, "mean_action_processing_ms": 0.24430550270564372, "mean_env_wait_ms": 0.17362371504406401, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 125039, "timesteps_this_iter": 40, "agent_timesteps_total": 125039, "timers": {"sample_time_ms": 3710.584, "sample_throughput": 10.78, "learn_time_ms": 2802.095, "learn_throughput": 14.275, "update_time_ms": 178.286}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.515775203704834, "grad_norm": 216.45872497558594, "td_error_abs": 1.8647034962972004, "q_taken_mean": 32.17703653971354, "target_mean": 32.27554931640625}}}, "num_steps_sampled": 125039, "num_agent_steps_sampled": 125039, "num_steps_trained": 125039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 124799, "num_target_updates": 240}, "done": false, "episodes_total": 12504, "training_iteration": 125, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-26-07", "timestamp": 1648891567, "time_this_iter_s": 92.73704743385315, "time_total_s": 11132.318300485611, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11132.318300485611, "timesteps_since_restore": 5000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 22.712307692307697, "ram_util_percent": 92.79923076923077}}
{"episode_reward_max": 150.0, "episode_reward_min": 90.0, "episode_reward_mean": 116.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7720835147523192, "mean_inference_ms": 58.46858658415945, "mean_action_processing_ms": 0.24406794931421913, "mean_env_wait_ms": 0.173475189983514, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 126039, "timesteps_this_iter": 40, "agent_timesteps_total": 126039, "timers": {"sample_time_ms": 3829.722, "sample_throughput": 10.445, "learn_time_ms": 2875.415, "learn_throughput": 13.911, "update_time_ms": 191.449}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.12808084487915, "grad_norm": 109.77222442626953, "td_error_abs": 1.8231190999348958, "q_taken_mean": 28.543157958984374, "target_mean": 28.752878824869793}}}, "num_steps_sampled": 126039, "num_agent_steps_sampled": 126039, "num_steps_trained": 126039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 125839, "num_target_updates": 242}, "done": false, "episodes_total": 12604, "training_iteration": 126, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-27-43", "timestamp": 1648891663, "time_this_iter_s": 95.30340051651001, "time_total_s": 11227.621701002121, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11227.621701002121, "timesteps_since_restore": 5040, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 22.334074074074078, "ram_util_percent": 92.76888888888888}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 114.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 120.0, 150.0, 60.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7713736533254497, "mean_inference_ms": 58.415569701105575, "mean_action_processing_ms": 0.2438497254106803, "mean_env_wait_ms": 0.17334010745263106, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 127039, "timesteps_this_iter": 40, "agent_timesteps_total": 127039, "timers": {"sample_time_ms": 3793.916, "sample_throughput": 10.543, "learn_time_ms": 2815.752, "learn_throughput": 14.206, "update_time_ms": 223.635}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.303649425506592, "grad_norm": 197.5775604248047, "td_error_abs": 1.7285442352294922, "q_taken_mean": 31.247139485677085, "target_mean": 31.44856974283854}}}, "num_steps_sampled": 127039, "num_agent_steps_sampled": 127039, "num_steps_trained": 127039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 126879, "num_target_updates": 244}, "done": false, "episodes_total": 12704, "training_iteration": 127, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-29-19", "timestamp": 1648891759, "time_this_iter_s": 96.58014178276062, "time_total_s": 11324.201842784882, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11324.201842784882, "timesteps_since_restore": 5080, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 21.88592592592593, "ram_util_percent": 92.73185185185184}}
{"episode_reward_max": 180.0, "episode_reward_min": 60.0, "episode_reward_mean": 141.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 90.0, 150.0, 150.0, 150.0, 150.0, 120.0, 180.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 90.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 60.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7706169239790707, "mean_inference_ms": 58.36004793048969, "mean_action_processing_ms": 0.24360643228783438, "mean_env_wait_ms": 0.17317596280708547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 128039, "timesteps_this_iter": 40, "agent_timesteps_total": 128039, "timers": {"sample_time_ms": 3767.773, "sample_throughput": 10.616, "learn_time_ms": 2813.046, "learn_throughput": 14.219, "update_time_ms": 206.87}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.8916096687316895, "grad_norm": 229.5393524169922, "td_error_abs": 2.2111434936523438, "q_taken_mean": 36.723795572916664, "target_mean": 35.65450439453125}}}, "num_steps_sampled": 128039, "num_agent_steps_sampled": 128039, "num_steps_trained": 128039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 127919, "num_target_updates": 246}, "done": false, "episodes_total": 12804, "training_iteration": 128, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-30-53", "timestamp": 1648891853, "time_this_iter_s": 93.85562133789062, "time_total_s": 11418.057464122772, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11418.057464122772, "timesteps_since_restore": 5120, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 22.142105263157895, "ram_util_percent": 92.63984962406016}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 132.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 60.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 60.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 90.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.76983322992767, "mean_inference_ms": 58.30739187913123, "mean_action_processing_ms": 0.24336985104393777, "mean_env_wait_ms": 0.17302584099122117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 129039, "timesteps_this_iter": 40, "agent_timesteps_total": 129039, "timers": {"sample_time_ms": 3702.403, "sample_throughput": 10.804, "learn_time_ms": 2727.883, "learn_throughput": 14.663, "update_time_ms": 231.269}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.897238731384277, "grad_norm": 244.90867614746094, "td_error_abs": 2.2834294637044272, "q_taken_mean": 34.741739908854164, "target_mean": 33.91524658203125}}}, "num_steps_sampled": 129039, "num_agent_steps_sampled": 129039, "num_steps_trained": 129039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 128959, "num_target_updates": 248}, "done": false, "episodes_total": 12904, "training_iteration": 129, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-32-26", "timestamp": 1648891946, "time_this_iter_s": 92.79369401931763, "time_total_s": 11510.85115814209, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11510.85115814209, "timesteps_since_restore": 5160, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 22.573076923076925, "ram_util_percent": 92.58923076923075}}
{"episode_reward_max": 150.0, "episode_reward_min": 90.0, "episode_reward_mean": 120.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 120.0, 120.0, 90.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 90.0, 150.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 150.0, 120.0, 90.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7691866056357586, "mean_inference_ms": 58.255375871893975, "mean_action_processing_ms": 0.2431664387607912, "mean_env_wait_ms": 0.17288778165151933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 130039, "timesteps_this_iter": 40, "agent_timesteps_total": 130039, "timers": {"sample_time_ms": 3641.143, "sample_throughput": 10.986, "learn_time_ms": 2674.529, "learn_throughput": 14.956, "update_time_ms": 221.798}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.859248161315918, "grad_norm": 202.4000701904297, "td_error_abs": 1.9066853841145834, "q_taken_mean": 33.07846476236979, "target_mean": 33.605322265625}}}, "num_steps_sampled": 130039, "num_agent_steps_sampled": 130039, "num_steps_trained": 130039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 129999, "num_target_updates": 250}, "done": false, "episodes_total": 13004, "training_iteration": 130, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-33-58", "timestamp": 1648892038, "time_this_iter_s": 91.57680344581604, "time_total_s": 11602.427961587906, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11602.427961587906, "timesteps_since_restore": 5200, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 22.559375, "ram_util_percent": 92.62109375000001}}
{"episode_reward_max": 150.0, "episode_reward_min": 90.0, "episode_reward_mean": 114.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7685312869131968, "mean_inference_ms": 58.208118462285896, "mean_action_processing_ms": 0.2429585660053414, "mean_env_wait_ms": 0.1727479015696008, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 131039, "timesteps_this_iter": 40, "agent_timesteps_total": 131039, "timers": {"sample_time_ms": 3656.231, "sample_throughput": 10.94, "learn_time_ms": 2673.327, "learn_throughput": 14.963, "update_time_ms": 236.288}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 3.361483097076416, "grad_norm": 235.57382202148438, "td_error_abs": 1.3683902740478515, "q_taken_mean": 33.085923258463545, "target_mean": 32.37039591471354}}}, "num_steps_sampled": 131039, "num_agent_steps_sampled": 131039, "num_steps_trained": 131039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 131039, "num_target_updates": 252}, "done": false, "episodes_total": 13104, "training_iteration": 131, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-35-29", "timestamp": 1648892129, "time_this_iter_s": 91.55242109298706, "time_total_s": 11693.980382680893, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11693.980382680893, "timesteps_since_restore": 5240, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 22.38661417322835, "ram_util_percent": 92.56299212598424}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 114.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 60.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7678587392956823, "mean_inference_ms": 58.15770977927843, "mean_action_processing_ms": 0.24275437818191925, "mean_env_wait_ms": 0.17261850355125183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 132039, "timesteps_this_iter": 40, "agent_timesteps_total": 132039, "timers": {"sample_time_ms": 3608.612, "sample_throughput": 11.085, "learn_time_ms": 2634.958, "learn_throughput": 15.181, "update_time_ms": 224.189}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.725342750549316, "grad_norm": 78.17687225341797, "td_error_abs": 1.7215901692708333, "q_taken_mean": 34.03750813802083, "target_mean": 33.92464599609375}}}, "num_steps_sampled": 132039, "num_agent_steps_sampled": 132039, "num_steps_trained": 132039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 131559, "num_target_updates": 253}, "done": false, "episodes_total": 13204, "training_iteration": 132, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-37-00", "timestamp": 1648892220, "time_this_iter_s": 90.50447368621826, "time_total_s": 11784.484856367111, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11784.484856367111, "timesteps_since_restore": 5280, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 22.60555555555556, "ram_util_percent": 92.61825396825397}}
{"episode_reward_max": 150.0, "episode_reward_min": 90.0, "episode_reward_mean": 111.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 150.0, 90.0, 90.0, 90.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 90.0, 120.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7671684853991239, "mean_inference_ms": 58.110397766333136, "mean_action_processing_ms": 0.24254333178233176, "mean_env_wait_ms": 0.17247387952495147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 133039, "timesteps_this_iter": 40, "agent_timesteps_total": 133039, "timers": {"sample_time_ms": 3649.643, "sample_throughput": 10.96, "learn_time_ms": 2693.375, "learn_throughput": 14.851, "update_time_ms": 213.782}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.340072631835938, "grad_norm": 137.66456604003906, "td_error_abs": 2.3075831095377604, "q_taken_mean": 32.61739908854167, "target_mean": 32.34236450195313}}}, "num_steps_sampled": 133039, "num_agent_steps_sampled": 133039, "num_steps_trained": 133039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 132599, "num_target_updates": 255}, "done": false, "episodes_total": 13304, "training_iteration": 133, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-38-31", "timestamp": 1648892311, "time_this_iter_s": 90.98005080223083, "time_total_s": 11875.464907169342, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11875.464907169342, "timesteps_since_restore": 5320, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 22.858267716535426, "ram_util_percent": 92.60236220472441}}
{"episode_reward_max": 180.0, "episode_reward_min": 60.0, "episode_reward_mean": 122.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 150.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 60.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 180.0, 150.0, 150.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 150.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7665456893001813, "mean_inference_ms": 58.065329556354556, "mean_action_processing_ms": 0.24233890993475604, "mean_env_wait_ms": 0.17234929618003902, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 134039, "timesteps_this_iter": 40, "agent_timesteps_total": 134039, "timers": {"sample_time_ms": 3674.081, "sample_throughput": 10.887, "learn_time_ms": 2704.668, "learn_throughput": 14.789, "update_time_ms": 212.803}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 15.170008659362793, "grad_norm": 357.0602111816406, "td_error_abs": 2.8903630574544272, "q_taken_mean": 36.482275390625, "target_mean": 34.519921875}}}, "num_steps_sampled": 134039, "num_agent_steps_sampled": 134039, "num_steps_trained": 134039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 133639, "num_target_updates": 257}, "done": false, "episodes_total": 13404, "training_iteration": 134, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-40-02", "timestamp": 1648892402, "time_this_iter_s": 91.55212473869324, "time_total_s": 11967.017031908035, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11967.017031908035, "timesteps_since_restore": 5360, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 22.73858267716535, "ram_util_percent": 92.6566929133858}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 135.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 120.0, 150.0, 150.0, 90.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 90.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 90.0, 150.0, 150.0, 120.0, 150.0, 150.0, 30.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 90.0, 90.0, 150.0, 120.0, 150.0, 90.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 120.0, 90.0, 120.0, 90.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7659176425118062, "mean_inference_ms": 58.01691666832861, "mean_action_processing_ms": 0.2421338503021584, "mean_env_wait_ms": 0.1722167505731899, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 135039, "timesteps_this_iter": 40, "agent_timesteps_total": 135039, "timers": {"sample_time_ms": 3721.661, "sample_throughput": 10.748, "learn_time_ms": 2748.013, "learn_throughput": 14.556, "update_time_ms": 225.003}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.104537010192871, "grad_norm": 173.27578735351562, "td_error_abs": 2.1948343912760415, "q_taken_mean": 40.37928059895833, "target_mean": 39.58681640625}}}, "num_steps_sampled": 135039, "num_agent_steps_sampled": 135039, "num_steps_trained": 135039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 134679, "num_target_updates": 259}, "done": false, "episodes_total": 13504, "training_iteration": 135, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-41-34", "timestamp": 1648892494, "time_this_iter_s": 91.91712737083435, "time_total_s": 12058.93415927887, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12058.93415927887, "timesteps_since_restore": 5400, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 22.68976377952756, "ram_util_percent": 92.69685039370076}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 135.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 150.0, 60.0, 150.0, 150.0, 120.0, 150.0, 120.0, 60.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 60.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 120.0, 60.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 90.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 60.0, 120.0, 150.0, 150.0, 150.0, 120.0, 60.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7652737959703388, "mean_inference_ms": 57.970306332938726, "mean_action_processing_ms": 0.24192415917663973, "mean_env_wait_ms": 0.1720842344816552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 136039, "timesteps_this_iter": 40, "agent_timesteps_total": 136039, "timers": {"sample_time_ms": 3664.029, "sample_throughput": 10.917, "learn_time_ms": 2695.94, "learn_throughput": 14.837, "update_time_ms": 227.139}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.86220932006836, "grad_norm": 518.8743286132812, "td_error_abs": 2.7418558756510416, "q_taken_mean": 34.77574869791667, "target_mean": 37.23481852213542}}}, "num_steps_sampled": 136039, "num_agent_steps_sampled": 136039, "num_steps_trained": 136039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 135719, "num_target_updates": 261}, "done": false, "episodes_total": 13604, "training_iteration": 136, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-43-06", "timestamp": 1648892586, "time_this_iter_s": 91.54713773727417, "time_total_s": 12150.481297016144, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12150.481297016144, "timesteps_since_restore": 5440, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 22.448818897637796, "ram_util_percent": 92.6236220472441}}
{"episode_reward_max": 150.0, "episode_reward_min": 30.0, "episode_reward_mean": 136.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 60.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 120.0, 150.0, 150.0, 90.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 30.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 30.0, 150.0, 60.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 90.0, 90.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7645916840720887, "mean_inference_ms": 57.92392106300785, "mean_action_processing_ms": 0.2417255920166662, "mean_env_wait_ms": 0.17195042355201268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 137039, "timesteps_this_iter": 40, "agent_timesteps_total": 137039, "timers": {"sample_time_ms": 3650.526, "sample_throughput": 10.957, "learn_time_ms": 2687.216, "learn_throughput": 14.885, "update_time_ms": 211.841}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.141886711120605, "grad_norm": 329.5848388671875, "td_error_abs": 2.6669797261555988, "q_taken_mean": 36.24110107421875, "target_mean": 34.30875244140625}}}, "num_steps_sampled": 137039, "num_agent_steps_sampled": 137039, "num_steps_trained": 137039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 136759, "num_target_updates": 263}, "done": false, "episodes_total": 13704, "training_iteration": 137, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-44-38", "timestamp": 1648892678, "time_this_iter_s": 92.4041154384613, "time_total_s": 12242.885412454605, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12242.885412454605, "timesteps_since_restore": 5480, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 22.637500000000003, "ram_util_percent": 92.63828125000002}}
{"episode_reward_max": 150.0, "episode_reward_min": 90.0, "episode_reward_mean": 137.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 90.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 90.0, 120.0, 120.0, 120.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 90.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7640068390157282, "mean_inference_ms": 57.88117365492108, "mean_action_processing_ms": 0.24154030073833788, "mean_env_wait_ms": 0.17184558082147214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 138039, "timesteps_this_iter": 40, "agent_timesteps_total": 138039, "timers": {"sample_time_ms": 3629.901, "sample_throughput": 11.02, "learn_time_ms": 2665.89, "learn_throughput": 15.004, "update_time_ms": 214.56}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.56648588180542, "grad_norm": 458.6766357421875, "td_error_abs": 1.7366653442382813, "q_taken_mean": 39.069559733072914, "target_mean": 39.330029296875}}}, "num_steps_sampled": 138039, "num_agent_steps_sampled": 138039, "num_steps_trained": 138039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 137799, "num_target_updates": 265}, "done": false, "episodes_total": 13804, "training_iteration": 138, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-46-09", "timestamp": 1648892769, "time_this_iter_s": 90.82938146591187, "time_total_s": 12333.714793920517, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12333.714793920517, "timesteps_since_restore": 5520, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 22.758730158730156, "ram_util_percent": 92.63412698412698}}
{"episode_reward_max": 150.0, "episode_reward_min": 90.0, "episode_reward_mean": 139.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 90.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 90.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 90.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7634282128554769, "mean_inference_ms": 57.83812344642017, "mean_action_processing_ms": 0.24136870207398523, "mean_env_wait_ms": 0.17173784607929796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 139039, "timesteps_this_iter": 40, "agent_timesteps_total": 139039, "timers": {"sample_time_ms": 3687.968, "sample_throughput": 10.846, "learn_time_ms": 2710.803, "learn_throughput": 14.756, "update_time_ms": 210.888}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.298120498657227, "grad_norm": 197.00794982910156, "td_error_abs": 2.0242276509602863, "q_taken_mean": 38.53677571614583, "target_mean": 39.252909342447914}}}, "num_steps_sampled": 139039, "num_agent_steps_sampled": 139039, "num_steps_trained": 139039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 138839, "num_target_updates": 267}, "done": false, "episodes_total": 13904, "training_iteration": 139, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-47-41", "timestamp": 1648892861, "time_this_iter_s": 91.50404262542725, "time_total_s": 12425.218836545944, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12425.218836545944, "timesteps_since_restore": 5560, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 22.7671875, "ram_util_percent": 92.646875}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 126.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 120.0, 150.0, 90.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 150.0, 120.0, 150.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 90.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 90.0, 150.0, 150.0, 150.0, 150.0, 120.0, 60.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 150.0, 60.0, 120.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 90.0, 150.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7627528388783409, "mean_inference_ms": 57.79370113019709, "mean_action_processing_ms": 0.2411817443848292, "mean_env_wait_ms": 0.1716132294115441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 140039, "timesteps_this_iter": 40, "agent_timesteps_total": 140039, "timers": {"sample_time_ms": 3682.753, "sample_throughput": 10.861, "learn_time_ms": 2733.075, "learn_throughput": 14.636, "update_time_ms": 197.636}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 3.0924010276794434, "grad_norm": 212.66688537597656, "td_error_abs": 1.2892468770345051, "q_taken_mean": 38.138720703125, "target_mean": 37.178035481770834}}}, "num_steps_sampled": 140039, "num_agent_steps_sampled": 140039, "num_steps_trained": 140039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 139879, "num_target_updates": 269}, "done": false, "episodes_total": 14004, "training_iteration": 140, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-49-12", "timestamp": 1648892952, "time_this_iter_s": 91.70358157157898, "time_total_s": 12516.922418117523, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12516.922418117523, "timesteps_since_restore": 5600, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 22.6984126984127, "ram_util_percent": 92.69365079365079}}
{"episode_reward_max": 180.0, "episode_reward_min": 60.0, "episode_reward_mean": 116.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 180.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 60.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 180.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 90.0, 120.0, 120.0, 90.0, 90.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7621692277648984, "mean_inference_ms": 57.74883450257221, "mean_action_processing_ms": 0.24099209635260113, "mean_env_wait_ms": 0.17149854969433315, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 141039, "timesteps_this_iter": 40, "agent_timesteps_total": 141039, "timers": {"sample_time_ms": 3661.912, "sample_throughput": 10.923, "learn_time_ms": 2680.091, "learn_throughput": 14.925, "update_time_ms": 238.138}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 13.710330963134766, "grad_norm": 405.5948486328125, "td_error_abs": 2.845708974202474, "q_taken_mean": 39.857295735677084, "target_mean": 38.915364583333336}}}, "num_steps_sampled": 141039, "num_agent_steps_sampled": 141039, "num_steps_trained": 141039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 140919, "num_target_updates": 271}, "done": false, "episodes_total": 14104, "training_iteration": 141, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-50-44", "timestamp": 1648893044, "time_this_iter_s": 91.75286746025085, "time_total_s": 12608.675285577774, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12608.675285577774, "timesteps_since_restore": 5640, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 22.01171875, "ram_util_percent": 92.67109375000001}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 104.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 120.0, 90.0, 90.0, 60.0, 60.0, 60.0, 60.0, 90.0, 90.0, 60.0, 150.0, 150.0, 120.0, 120.0, 60.0, 90.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 90.0, 120.0, 90.0, 150.0, 60.0, 60.0, 90.0, 90.0, 60.0, 150.0, 150.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 150.0, 120.0, 120.0, 90.0, 60.0, 60.0, 60.0, 60.0, 90.0, 90.0, 120.0, 150.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 90.0, 90.0, 60.0, 90.0, 60.0, 60.0, 90.0, 90.0, 60.0, 120.0, 150.0, 150.0, 90.0, 120.0, 60.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7616122100468065, "mean_inference_ms": 57.70707826214688, "mean_action_processing_ms": 0.2408200302214128, "mean_env_wait_ms": 0.1714409298569997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 142039, "timesteps_this_iter": 40, "agent_timesteps_total": 142039, "timers": {"sample_time_ms": 3644.345, "sample_throughput": 10.976, "learn_time_ms": 2682.349, "learn_throughput": 14.912, "update_time_ms": 214.512}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 2.379605531692505, "grad_norm": 128.0799560546875, "td_error_abs": 1.2188260396321615, "q_taken_mean": 32.39536743164062, "target_mean": 32.32107747395833}}}, "num_steps_sampled": 142039, "num_agent_steps_sampled": 142039, "num_steps_trained": 142039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 141959, "num_target_updates": 273}, "done": false, "episodes_total": 14204, "training_iteration": 142, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-52-15", "timestamp": 1648893135, "time_this_iter_s": 91.35453081130981, "time_total_s": 12700.029816389084, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12700.029816389084, "timesteps_since_restore": 5680, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 22.315079365079363, "ram_util_percent": 92.65317460317459}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 122.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 150.0, 150.0, 150.0, 120.0, 90.0, 150.0, 150.0, 90.0, 90.0, 150.0, 150.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 90.0, 120.0, 120.0, 150.0, 120.0, 90.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 90.0, 120.0, 120.0, 150.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 90.0, 150.0, 150.0, 120.0, 90.0, 120.0, 150.0, 120.0, 90.0, 150.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 150.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 150.0, 90.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 90.0, 60.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7610026212833857, "mean_inference_ms": 57.66443592447354, "mean_action_processing_ms": 0.2406395258327308, "mean_env_wait_ms": 0.1713180555223926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 143039, "timesteps_this_iter": 40, "agent_timesteps_total": 143039, "timers": {"sample_time_ms": 3678.569, "sample_throughput": 10.874, "learn_time_ms": 2685.593, "learn_throughput": 14.894, "update_time_ms": 219.39}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.917941093444824, "grad_norm": 178.552001953125, "td_error_abs": 2.5780982971191406, "q_taken_mean": 33.452168782552086, "target_mean": 32.52166748046875}}}, "num_steps_sampled": 143039, "num_agent_steps_sampled": 143039, "num_steps_trained": 143039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 142999, "num_target_updates": 275}, "done": false, "episodes_total": 14304, "training_iteration": 143, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-53-47", "timestamp": 1648893227, "time_this_iter_s": 91.16241645812988, "time_total_s": 12791.192232847214, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12791.192232847214, "timesteps_since_restore": 5720, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 22.531746031746028, "ram_util_percent": 92.60714285714283}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 113.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 60.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 150.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 60.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 60.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7604709204801589, "mean_inference_ms": 57.62517452847179, "mean_action_processing_ms": 0.24048190468107272, "mean_env_wait_ms": 0.17122079816269042, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 144039, "timesteps_this_iter": 40, "agent_timesteps_total": 144039, "timers": {"sample_time_ms": 3714.02, "sample_throughput": 10.77, "learn_time_ms": 2732.079, "learn_throughput": 14.641, "update_time_ms": 223.811}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 2.6425371170043945, "grad_norm": 83.11029052734375, "td_error_abs": 1.2666213989257813, "q_taken_mean": 30.2216064453125, "target_mean": 29.927276611328125}}}, "num_steps_sampled": 144039, "num_agent_steps_sampled": 144039, "num_steps_trained": 144039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 144039, "num_target_updates": 277}, "done": false, "episodes_total": 14404, "training_iteration": 144, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-55-19", "timestamp": 1648893319, "time_this_iter_s": 92.01163911819458, "time_total_s": 12883.203871965408, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12883.203871965408, "timesteps_since_restore": 5760, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 22.568253968253973, "ram_util_percent": 92.68174603174602}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 114.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 150.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 120.0, 90.0, 120.0, 120.0, 120.0, 60.0, 90.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 90.0, 150.0, 90.0, 90.0, 90.0, 120.0, 120.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.759832739074361, "mean_inference_ms": 57.583260634253726, "mean_action_processing_ms": 0.24029582373382016, "mean_env_wait_ms": 0.17109731422491997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 145039, "timesteps_this_iter": 40, "agent_timesteps_total": 145039, "timers": {"sample_time_ms": 3670.399, "sample_throughput": 10.898, "learn_time_ms": 2680.486, "learn_throughput": 14.923, "update_time_ms": 245.709}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.909817695617676, "grad_norm": 222.59974670410156, "td_error_abs": 1.8860219319661458, "q_taken_mean": 31.519773356119792, "target_mean": 30.55058390299479}}}, "num_steps_sampled": 145039, "num_agent_steps_sampled": 145039, "num_steps_trained": 145039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 144559, "num_target_updates": 278}, "done": false, "episodes_total": 14504, "training_iteration": 145, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-56-50", "timestamp": 1648893410, "time_this_iter_s": 91.6555712223053, "time_total_s": 12974.859443187714, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12974.859443187714, "timesteps_since_restore": 5800, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 22.072440944881887, "ram_util_percent": 92.57480314960628}}
{"episode_reward_max": 180.0, "episode_reward_min": 60.0, "episode_reward_mean": 126.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 150.0, 180.0, 120.0, 150.0, 180.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 90.0, 120.0, 120.0, 120.0, 120.0, 60.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 150.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 60.0, 120.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 120.0, 120.0, 90.0, 120.0, 120.0, 120.0, 90.0, 60.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7592795004694151, "mean_inference_ms": 57.545714970616224, "mean_action_processing_ms": 0.240122667336432, "mean_env_wait_ms": 0.17105523844837292, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 146039, "timesteps_this_iter": 40, "agent_timesteps_total": 146039, "timers": {"sample_time_ms": 3645.135, "sample_throughput": 10.974, "learn_time_ms": 2679.32, "learn_throughput": 14.929, "update_time_ms": 211.161}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.443205833435059, "grad_norm": 151.1776123046875, "td_error_abs": 1.6333635965983073, "q_taken_mean": 31.067193603515626, "target_mean": 30.99293212890625}}}, "num_steps_sampled": 146039, "num_agent_steps_sampled": 146039, "num_steps_trained": 146039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 145599, "num_target_updates": 280}, "done": false, "episodes_total": 14604, "training_iteration": 146, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-58-22", "timestamp": 1648893502, "time_this_iter_s": 91.4150128364563, "time_total_s": 13066.27445602417, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13066.27445602417, "timesteps_since_restore": 5840, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 22.80787401574803, "ram_util_percent": 92.64015748031498}}
{"episode_reward_max": 150.0, "episode_reward_min": 90.0, "episode_reward_mean": 138.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 120.0, 90.0, 120.0, 90.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 90.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7586978545119013, "mean_inference_ms": 57.50653426506031, "mean_action_processing_ms": 0.23994970145881922, "mean_env_wait_ms": 0.17093451448652744, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 147039, "timesteps_this_iter": 40, "agent_timesteps_total": 147039, "timers": {"sample_time_ms": 3572.38, "sample_throughput": 11.197, "learn_time_ms": 2602.721, "learn_throughput": 15.369, "update_time_ms": 220.235}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.699690341949463, "grad_norm": 97.65725708007812, "td_error_abs": 1.965626017252604, "q_taken_mean": 26.159273274739583, "target_mean": 26.764286295572916}}}, "num_steps_sampled": 147039, "num_agent_steps_sampled": 147039, "num_steps_trained": 147039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 146639, "num_target_updates": 282}, "done": false, "episodes_total": 14704, "training_iteration": 147, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_02-59-51", "timestamp": 1648893591, "time_this_iter_s": 89.12518191337585, "time_total_s": 13155.399637937546, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13155.399637937546, "timesteps_since_restore": 5880, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 22.77777777777778, "ram_util_percent": 92.56984126984126}}
{"episode_reward_max": 180.0, "episode_reward_min": 60.0, "episode_reward_mean": 142.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 120.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 180.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 60.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 60.0, 150.0, 150.0, 150.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7581407789307, "mean_inference_ms": 57.46704632826722, "mean_action_processing_ms": 0.23977431671432825, "mean_env_wait_ms": 0.1708085803779223, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 148039, "timesteps_this_iter": 40, "agent_timesteps_total": 148039, "timers": {"sample_time_ms": 3590.568, "sample_throughput": 11.14, "learn_time_ms": 2633.965, "learn_throughput": 15.186, "update_time_ms": 204.507}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.094212532043457, "grad_norm": 297.90533447265625, "td_error_abs": 1.8641493479410807, "q_taken_mean": 33.42657470703125, "target_mean": 32.65615234375}}}, "num_steps_sampled": 148039, "num_agent_steps_sampled": 148039, "num_steps_trained": 148039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 147679, "num_target_updates": 284}, "done": false, "episodes_total": 14804, "training_iteration": 148, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_03-01-20", "timestamp": 1648893680, "time_this_iter_s": 89.29145765304565, "time_total_s": 13244.691095590591, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13244.691095590591, "timesteps_since_restore": 5920, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 22.5272, "ram_util_percent": 92.57839999999999}}
{"episode_reward_max": 180.0, "episode_reward_min": 60.0, "episode_reward_mean": 137.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 120.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 120.0, 150.0, 90.0, 120.0, 150.0, 90.0, 150.0, 60.0, 150.0, 150.0, 150.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 90.0, 120.0, 180.0, 150.0, 150.0, 90.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 120.0, 120.0, 180.0, 150.0, 90.0, 150.0, 150.0, 120.0, 150.0, 150.0, 90.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7576395261861427, "mean_inference_ms": 57.428678783961686, "mean_action_processing_ms": 0.2396091380108298, "mean_env_wait_ms": 0.17069306212710564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 149039, "timesteps_this_iter": 40, "agent_timesteps_total": 149039, "timers": {"sample_time_ms": 3605.988, "sample_throughput": 11.093, "learn_time_ms": 2648.753, "learn_throughput": 15.101, "update_time_ms": 218.059}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.685746192932129, "grad_norm": 453.0976257324219, "td_error_abs": 2.5179206848144533, "q_taken_mean": 34.29193115234375, "target_mean": 34.411962890625}}}, "num_steps_sampled": 149039, "num_agent_steps_sampled": 149039, "num_steps_trained": 149039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 148719, "num_target_updates": 286}, "done": false, "episodes_total": 14904, "training_iteration": 149, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_03-02-50", "timestamp": 1648893770, "time_this_iter_s": 90.06608200073242, "time_total_s": 13334.757177591324, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13334.757177591324, "timesteps_since_restore": 5960, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 22.296031746031744, "ram_util_percent": 92.64682539682539}}
{"episode_reward_max": 150.0, "episode_reward_min": 60.0, "episode_reward_mean": 141.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 60.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 60.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 60.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 120.0, 120.0, 150.0, 120.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 120.0, 120.0, 90.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 120.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0, 150.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7571643408315958, "mean_inference_ms": 57.39258563544041, "mean_action_processing_ms": 0.23945302554765932, "mean_env_wait_ms": 0.17058273206253294, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 150039, "timesteps_this_iter": 40, "agent_timesteps_total": 150039, "timers": {"sample_time_ms": 3624.696, "sample_throughput": 11.035, "learn_time_ms": 2641.422, "learn_throughput": 15.143, "update_time_ms": 225.476}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.713288307189941, "grad_norm": 242.9071044921875, "td_error_abs": 1.7028512318929037, "q_taken_mean": 34.27964680989583, "target_mean": 33.12567952473958}}}, "num_steps_sampled": 150039, "num_agent_steps_sampled": 150039, "num_steps_trained": 150039, "num_steps_trained_this_iter": 40, "last_target_update_ts": 149759, "num_target_updates": 288}, "done": true, "episodes_total": 15004, "training_iteration": 150, "trial_id": "fabe5_00000", "experiment_id": "637faa69f99a4a9ab42baa92763bff02", "date": "2022-04-02_03-04-21", "timestamp": 1648893861, "time_this_iter_s": 91.06537055969238, "time_total_s": 13425.822548151016, "pid": 27087, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "coop", "time_limit": 10, "trainer": "qmix"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13425.822548151016, "timesteps_since_restore": 6000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 22.808730158730157, "ram_util_percent": 92.66984126984129}}
