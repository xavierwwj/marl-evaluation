{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -10.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, -10.0, -10.0, 0.0, 0.0, -20.0, 0.0, -20.0, -10.0, 0.0, -10.0, -10.0, 0.0, -10.0, -10.0, -20.0, 0.0, -10.0, -20.0, -10.0, -10.0, -10.0, -10.0, -20.0, 0.0, -10.0, -30.0, -10.0, -10.0, -10.0, 0.0, -10.0, -20.0, 0.0, -20.0, -10.0, -20.0, -20.0, -10.0, -20.0, -10.0, 0.0, -10.0, -20.0, -10.0, -10.0, -10.0, -30.0, 0.0, -10.0, 0.0, -10.0, 0.0, -10.0, -10.0, -20.0, 10.0, -20.0, -20.0, -10.0, 0.0, 10.0, -30.0, -10.0, -10.0, 0.0, 10.0, 0.0, -20.0, -30.0, -20.0, 10.0, 10.0, 10.0, 0.0, -10.0, -10.0, -20.0, -10.0, -20.0, 10.0, -20.0, -10.0, -20.0, -10.0, 0.0, -30.0, -10.0, -20.0, -10.0, -10.0, -10.0, -20.0, -20.0, -20.0, -20.0, -20.0, -20.0, -30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.73603899830366, "mean_inference_ms": 54.68083425347073, "mean_action_processing_ms": 0.22703575423039293, "mean_env_wait_ms": 0.16231579609601152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1000, "timesteps_this_iter": 40, "agent_timesteps_total": 1000, "timers": {"sample_time_ms": 3239.952, "sample_throughput": 12.346, "learn_time_ms": 2462.148, "learn_throughput": 16.246, "update_time_ms": 42.621}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 18.191308975219727, "grad_norm": 231.6316680908203, "td_error_abs": 3.4500104268391927, "q_taken_mean": -3.3190155029296875, "target_mean": 0.036191741625467934}}}, "num_steps_sampled": 1000, "num_agent_steps_sampled": 1000, "num_steps_trained": 1000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 520, "num_target_updates": 1}, "done": false, "episodes_total": 100, "training_iteration": 1, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-26-15", "timestamp": 1648895175, "time_this_iter_s": 83.74463629722595, "time_total_s": 83.74463629722595, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 83.74463629722595, "timesteps_since_restore": 40, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.352500000000003, "ram_util_percent": 56.87}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -12.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, -20.0, 0.0, -10.0, 0.0, -20.0, -10.0, 20.0, -10.0, -20.0, -20.0, 0.0, -10.0, -20.0, -20.0, 0.0, -10.0, 0.0, -30.0, -10.0, -10.0, -10.0, 0.0, 0.0, -10.0, 0.0, -20.0, -20.0, 0.0, -20.0, -20.0, -20.0, -20.0, -10.0, 0.0, -10.0, -20.0, -20.0, -20.0, -20.0, -10.0, -20.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -30.0, -20.0, -30.0, -10.0, -20.0, -10.0, -10.0, -20.0, -20.0, -10.0, 0.0, 0.0, -20.0, 0.0, 0.0, -30.0, -10.0, -10.0, -30.0, -10.0, -20.0, -10.0, 0.0, 0.0, -20.0, -10.0, -10.0, -10.0, -20.0, -10.0, 0.0, -30.0, -20.0, -20.0, -20.0, -20.0, 0.0, 10.0, -20.0, -20.0, -10.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, -20.0, -10.0, -20.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7320086875123653, "mean_inference_ms": 54.22294068479251, "mean_action_processing_ms": 0.226230797415484, "mean_env_wait_ms": 0.16265988587857247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2000, "timesteps_this_iter": 40, "agent_timesteps_total": 2000, "timers": {"sample_time_ms": 3327.046, "sample_throughput": 12.023, "learn_time_ms": 2511.183, "learn_throughput": 15.929, "update_time_ms": 43.727}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.593591213226318, "grad_norm": 34.758460998535156, "td_error_abs": 1.5590147654215494, "q_taken_mean": -1.1692998250325521, "target_mean": -1.3191799163818358}}}, "num_steps_sampled": 2000, "num_agent_steps_sampled": 2000, "num_steps_trained": 2000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 1560, "num_target_updates": 3}, "done": false, "episodes_total": 200, "training_iteration": 2, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-27-38", "timestamp": 1648895258, "time_this_iter_s": 82.21902227401733, "time_total_s": 165.9636585712433, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 165.9636585712433, "timesteps_since_restore": 80, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.065254237288137, "ram_util_percent": 57.4508474576271}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -12.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, -10.0, -10.0, -20.0, -20.0, -30.0, -10.0, 10.0, -30.0, -10.0, -10.0, -20.0, 0.0, -30.0, 0.0, 0.0, -30.0, -20.0, 0.0, 0.0, -10.0, -10.0, -30.0, -10.0, -20.0, 0.0, -10.0, -20.0, -10.0, -20.0, 0.0, -10.0, -10.0, -20.0, -30.0, 0.0, -20.0, -10.0, -20.0, -10.0, -20.0, 0.0, -10.0, 0.0, 0.0, -10.0, -20.0, -10.0, -20.0, -10.0, 0.0, -10.0, -20.0, -20.0, -20.0, -10.0, 0.0, -10.0, -10.0, 10.0, -30.0, -20.0, -10.0, -20.0, -10.0, -10.0, 0.0, -10.0, 10.0, -20.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, -10.0, -20.0, -20.0, 0.0, -20.0, -20.0, -10.0, -10.0, -20.0, -20.0, -20.0, 0.0, -10.0, -10.0, -20.0, -20.0, -20.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, -20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7261083859419536, "mean_inference_ms": 54.0717211607769, "mean_action_processing_ms": 0.2250180898430186, "mean_env_wait_ms": 0.16058777048489387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3000, "timesteps_this_iter": 40, "agent_timesteps_total": 3000, "timers": {"sample_time_ms": 3299.105, "sample_throughput": 12.125, "learn_time_ms": 2479.156, "learn_throughput": 16.135, "update_time_ms": 51.862}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.728565692901611, "grad_norm": 32.614112854003906, "td_error_abs": 1.5138072967529297, "q_taken_mean": -0.6071555455525716, "target_mean": -0.11578359603881835}}}, "num_steps_sampled": 3000, "num_agent_steps_sampled": 3000, "num_steps_trained": 3000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 2600, "num_target_updates": 5}, "done": false, "episodes_total": 300, "training_iteration": 3, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-29-01", "timestamp": 1648895341, "time_this_iter_s": 82.259268283844, "time_total_s": 248.22292685508728, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 248.22292685508728, "timesteps_since_restore": 120, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.441525423728816, "ram_util_percent": 57.908474576271175}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -12.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -20.0, -20.0, -30.0, -20.0, -20.0, -10.0, -10.0, 0.0, 0.0, -20.0, -10.0, -10.0, 10.0, -30.0, 0.0, -10.0, -20.0, -30.0, -10.0, -10.0, -30.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, -20.0, -10.0, -20.0, -10.0, -10.0, -10.0, -10.0, -30.0, 0.0, -20.0, 0.0, -10.0, -10.0, -10.0, -10.0, -20.0, -10.0, 10.0, -30.0, -10.0, 0.0, -10.0, -20.0, -10.0, -10.0, -20.0, -20.0, -10.0, -20.0, -10.0, -20.0, 10.0, -10.0, -10.0, -20.0, 0.0, -20.0, -10.0, -20.0, -20.0, -20.0, -10.0, 0.0, -10.0, -10.0, -20.0, -10.0, -10.0, -20.0, -20.0, 0.0, -20.0, -20.0, -10.0, -10.0, -10.0, -20.0, -10.0, -10.0, -20.0, -20.0, 0.0, -10.0, -20.0, -10.0, 0.0, -20.0, 0.0, 10.0, -20.0, 0.0, -20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7215384598616714, "mean_inference_ms": 53.6278304043826, "mean_action_processing_ms": 0.2234900271618641, "mean_env_wait_ms": 0.1600302539981686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 4000, "timesteps_this_iter": 40, "agent_timesteps_total": 4000, "timers": {"sample_time_ms": 3193.332, "sample_throughput": 12.526, "learn_time_ms": 2426.592, "learn_throughput": 16.484, "update_time_ms": 43.024}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.22268533706665, "grad_norm": 45.454833984375, "td_error_abs": 1.3624304453531901, "q_taken_mean": -0.756511942545573, "target_mean": -0.10175104141235351}}}, "num_steps_sampled": 4000, "num_agent_steps_sampled": 4000, "num_steps_trained": 4000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 3640, "num_target_updates": 7}, "done": false, "episodes_total": 400, "training_iteration": 4, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-30-22", "timestamp": 1648895422, "time_this_iter_s": 80.90424394607544, "time_total_s": 329.1271708011627, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 329.1271708011627, "timesteps_since_restore": 160, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.12521739130435, "ram_util_percent": 58.302608695652175}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -11.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -20.0, -30.0, -10.0, 0.0, -20.0, -10.0, -20.0, 0.0, -20.0, 10.0, -20.0, -10.0, -10.0, -10.0, -20.0, -10.0, -10.0, -30.0, 0.0, -10.0, -20.0, 0.0, -20.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, -10.0, 0.0, 10.0, -10.0, -20.0, -30.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, -20.0, -10.0, -10.0, -20.0, 0.0, -10.0, -10.0, 0.0, -10.0, -30.0, 0.0, -10.0, -10.0, -20.0, 0.0, -10.0, -10.0, -10.0, 0.0, 10.0, -20.0, 10.0, -20.0, 0.0, -20.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -20.0, -10.0, -20.0, -10.0, -20.0, -20.0, -10.0, -10.0, -10.0, -20.0, -20.0, -20.0, -10.0, -20.0, -20.0, -20.0, -10.0, -10.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7176574090306614, "mean_inference_ms": 53.347714942136264, "mean_action_processing_ms": 0.22218067297260827, "mean_env_wait_ms": 0.15912872614810983, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 5000, "timesteps_this_iter": 40, "agent_timesteps_total": 5000, "timers": {"sample_time_ms": 3266.641, "sample_throughput": 12.245, "learn_time_ms": 2434.691, "learn_throughput": 16.429, "update_time_ms": 58.053}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.613710403442383, "grad_norm": 36.102237701416016, "td_error_abs": 1.582287851969401, "q_taken_mean": 1.8869978586832683, "target_mean": 1.9720561981201172}}}, "num_steps_sampled": 5000, "num_agent_steps_sampled": 5000, "num_steps_trained": 5000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 4680, "num_target_updates": 9}, "done": false, "episodes_total": 500, "training_iteration": 5, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-31-44", "timestamp": 1648895504, "time_this_iter_s": 81.19540596008301, "time_total_s": 410.3225767612457, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 410.3225767612457, "timesteps_since_restore": 200, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.086324786324788, "ram_util_percent": 58.66153846153848}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -11.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -10.0, 0.0, -30.0, 0.0, -20.0, -20.0, 0.0, 0.0, -10.0, -10.0, -10.0, -10.0, -10.0, -20.0, -20.0, 0.0, -20.0, -10.0, 0.0, -10.0, 0.0, -20.0, -30.0, -20.0, -10.0, -10.0, 0.0, -20.0, -10.0, 0.0, -20.0, -20.0, -30.0, -20.0, -10.0, -20.0, -20.0, -10.0, 0.0, -10.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, -20.0, -20.0, -10.0, -10.0, -20.0, -20.0, -20.0, -10.0, 0.0, -10.0, 10.0, -10.0, -20.0, 0.0, -30.0, -10.0, -10.0, -10.0, -10.0, 10.0, -30.0, -20.0, -20.0, -10.0, -10.0, -20.0, 0.0, -10.0, -10.0, -20.0, -20.0, 0.0, -10.0, -30.0, -20.0, -10.0, 0.0, 10.0, -10.0, -10.0, -10.0, 0.0, 0.0, -10.0, -30.0, -20.0, -10.0, -10.0, -20.0, 0.0, -10.0, -20.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7139067900808235, "mean_inference_ms": 53.1043853861423, "mean_action_processing_ms": 0.22131720834537646, "mean_env_wait_ms": 0.15835762818124915, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 6000, "timesteps_this_iter": 40, "agent_timesteps_total": 6000, "timers": {"sample_time_ms": 3246.27, "sample_throughput": 12.322, "learn_time_ms": 2415.265, "learn_throughput": 16.561, "update_time_ms": 61.221}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.556451320648193, "grad_norm": 35.98789978027344, "td_error_abs": 1.7399897257486978, "q_taken_mean": 1.3905017852783204, "target_mean": 0.9016941070556641}}}, "num_steps_sampled": 6000, "num_agent_steps_sampled": 6000, "num_steps_trained": 6000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 5720, "num_target_updates": 11}, "done": false, "episodes_total": 600, "training_iteration": 6, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-33-05", "timestamp": 1648895585, "time_this_iter_s": 80.77728056907654, "time_total_s": 491.09985733032227, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 491.09985733032227, "timesteps_since_restore": 240, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 23.0301724137931, "ram_util_percent": 58.90862068965516}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -9.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, -10.0, -30.0, -10.0, -30.0, -10.0, 0.0, -10.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, -10.0, -10.0, 10.0, -10.0, -10.0, 0.0, 20.0, -10.0, -10.0, -20.0, -20.0, -10.0, 0.0, -20.0, -20.0, 0.0, -20.0, -10.0, -10.0, 0.0, -10.0, -10.0, -30.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -10.0, -20.0, -10.0, 0.0, -20.0, -20.0, -10.0, -10.0, -10.0, 0.0, 0.0, -10.0, -10.0, -10.0, 10.0, -10.0, -20.0, -10.0, -20.0, -20.0, 0.0, 0.0, -20.0, -20.0, -20.0, -20.0, 0.0, 0.0, -30.0, -20.0, 10.0, -20.0, -10.0, -20.0, 0.0, -10.0, -20.0, 10.0, -10.0, -10.0, -20.0, -10.0, -20.0, -10.0, -30.0, -10.0, -10.0, -10.0, -20.0, -10.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7114064550481476, "mean_inference_ms": 52.96989957105769, "mean_action_processing_ms": 0.2205974711206284, "mean_env_wait_ms": 0.1576651443010871, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 7000, "timesteps_this_iter": 40, "agent_timesteps_total": 7000, "timers": {"sample_time_ms": 3182.056, "sample_throughput": 12.57, "learn_time_ms": 2344.235, "learn_throughput": 17.063, "update_time_ms": 59.832}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.377176761627197, "grad_norm": 23.521705627441406, "td_error_abs": 1.4974829355875652, "q_taken_mean": 0.6144342422485352, "target_mean": 0.5004455248514811}}}, "num_steps_sampled": 7000, "num_agent_steps_sampled": 7000, "num_steps_trained": 7000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 6760, "num_target_updates": 13}, "done": false, "episodes_total": 700, "training_iteration": 7, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-34-25", "timestamp": 1648895665, "time_this_iter_s": 79.38300561904907, "time_total_s": 570.4828629493713, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 570.4828629493713, "timesteps_since_restore": 280, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.549122807017543, "ram_util_percent": 59.216666666666676}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -10.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, -30.0, 0.0, 0.0, -10.0, 0.0, -30.0, -10.0, -20.0, -20.0, 0.0, -10.0, 0.0, -20.0, -20.0, -10.0, -20.0, -20.0, -20.0, -10.0, -10.0, -20.0, 10.0, -20.0, -20.0, -10.0, -20.0, 0.0, -10.0, 0.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, -20.0, -20.0, -20.0, -20.0, -20.0, -20.0, -20.0, 0.0, -20.0, -20.0, -20.0, 0.0, 0.0, -20.0, -10.0, 10.0, 0.0, -10.0, 0.0, 0.0, -10.0, -10.0, -10.0, -10.0, -10.0, -30.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -10.0, -20.0, -10.0, -10.0, -20.0, -10.0, -20.0, 0.0, -10.0, -10.0, 0.0, -10.0, -10.0, 0.0, -20.0, 0.0, 0.0, 0.0, -30.0, -30.0, -10.0, -20.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7096148919368136, "mean_inference_ms": 52.83670831119818, "mean_action_processing_ms": 0.2204397212023261, "mean_env_wait_ms": 0.15780521833199612, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 8000, "timesteps_this_iter": 40, "agent_timesteps_total": 8000, "timers": {"sample_time_ms": 3162.087, "sample_throughput": 12.65, "learn_time_ms": 2361.401, "learn_throughput": 16.939, "update_time_ms": 50.02}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.582086563110352, "grad_norm": 21.871593475341797, "td_error_abs": 1.2991259256998697, "q_taken_mean": 0.1624025503794352, "target_mean": 0.19872032801310222}}}, "num_steps_sampled": 8000, "num_agent_steps_sampled": 8000, "num_steps_trained": 8000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 7800, "num_target_updates": 15}, "done": false, "episodes_total": 800, "training_iteration": 8, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-35-44", "timestamp": 1648895744, "time_this_iter_s": 78.98383069038391, "time_total_s": 649.4666936397552, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 649.4666936397552, "timesteps_since_restore": 320, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.267256637168146, "ram_util_percent": 59.48053097345134}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -9.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -10.0, 0.0, 0.0, -20.0, -10.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, -20.0, -30.0, -10.0, -10.0, -10.0, 0.0, -20.0, -10.0, -20.0, 0.0, 0.0, -10.0, -10.0, 0.0, 0.0, -20.0, -20.0, 0.0, -10.0, 0.0, 0.0, -30.0, -20.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, 0.0, -10.0, -10.0, -30.0, -10.0, 0.0, -10.0, 0.0, -20.0, -10.0, -20.0, 0.0, -30.0, -20.0, -20.0, -20.0, -10.0, -10.0, -20.0, 0.0, -10.0, -20.0, -10.0, -10.0, -20.0, -10.0, 0.0, 0.0, 0.0, -10.0, -20.0, -10.0, 10.0, 0.0, -10.0, 0.0, 0.0, 0.0, -10.0, -10.0, -20.0, -10.0, 0.0, -10.0, -20.0, -10.0, 0.0, -10.0, -20.0, -10.0, 0.0, 0.0, -20.0, -20.0, -10.0, -10.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7131685685285296, "mean_inference_ms": 53.10368310181844, "mean_action_processing_ms": 0.22161057237941173, "mean_env_wait_ms": 0.15861656548234426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 9000, "timesteps_this_iter": 40, "agent_timesteps_total": 9000, "timers": {"sample_time_ms": 3243.369, "sample_throughput": 12.333, "learn_time_ms": 2430.594, "learn_throughput": 16.457, "update_time_ms": 44.934}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.7910003662109375, "grad_norm": 30.264204025268555, "td_error_abs": 1.7282276153564453, "q_taken_mean": 0.7364648818969727, "target_mean": 0.43137003580729166}}}, "num_steps_sampled": 9000, "num_agent_steps_sampled": 9000, "num_steps_trained": 9000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 8840, "num_target_updates": 17}, "done": false, "episodes_total": 900, "training_iteration": 9, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-37-07", "timestamp": 1648895827, "time_this_iter_s": 81.73649001121521, "time_total_s": 731.2031836509705, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 731.2031836509705, "timesteps_since_restore": 360, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.359829059829057, "ram_util_percent": 59.795726495726505}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -11.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -10.0, -30.0, -10.0, -20.0, -10.0, -10.0, 10.0, -20.0, 10.0, 0.0, -20.0, -30.0, -10.0, -10.0, 0.0, -10.0, 0.0, 0.0, -10.0, 10.0, -10.0, -10.0, -10.0, -10.0, 0.0, -20.0, -20.0, -20.0, 0.0, 0.0, -10.0, -10.0, -20.0, -20.0, 0.0, -10.0, -30.0, 0.0, -20.0, -30.0, -20.0, -10.0, -20.0, -30.0, -20.0, 0.0, 0.0, 0.0, -10.0, -10.0, -20.0, 0.0, -10.0, -10.0, -20.0, -10.0, -10.0, 0.0, -10.0, 0.0, -10.0, -20.0, -20.0, -10.0, 0.0, -20.0, -20.0, -10.0, -10.0, 0.0, -20.0, 0.0, -10.0, -10.0, -10.0, -10.0, -20.0, -10.0, -20.0, -10.0, -10.0, -20.0, 0.0, 0.0, -10.0, -10.0, -10.0, 0.0, 0.0, -20.0, -30.0, -10.0, -20.0, 0.0, -20.0, -30.0, 0.0, -20.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.719126154546116, "mean_inference_ms": 53.44876440845934, "mean_action_processing_ms": 0.22280492672010793, "mean_env_wait_ms": 0.15954809730313194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 10000, "timesteps_this_iter": 40, "agent_timesteps_total": 10000, "timers": {"sample_time_ms": 3257.377, "sample_throughput": 12.28, "learn_time_ms": 2386.163, "learn_throughput": 16.763, "update_time_ms": 53.914}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.480803966522217, "grad_norm": 27.276824951171875, "td_error_abs": 1.5577841440836588, "q_taken_mean": 1.7984001159667968, "target_mean": 1.4408772786458333}}}, "num_steps_sampled": 10000, "num_agent_steps_sampled": 10000, "num_steps_trained": 10000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 9880, "num_target_updates": 19}, "done": false, "episodes_total": 1000, "training_iteration": 10, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-38-29", "timestamp": 1648895909, "time_this_iter_s": 81.94553232192993, "time_total_s": 813.1487159729004, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 813.1487159729004, "timesteps_since_restore": 400, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 23.906837606837605, "ram_util_percent": 60.12905982905985}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -10.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -10.0, -10.0, 0.0, 10.0, -20.0, -20.0, 0.0, -10.0, -20.0, -20.0, -20.0, 10.0, -10.0, -20.0, 0.0, 0.0, -20.0, -10.0, -10.0, -10.0, 0.0, -10.0, -10.0, -30.0, 0.0, -20.0, -20.0, -20.0, -30.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, 0.0, -10.0, -10.0, -10.0, 0.0, -20.0, -20.0, -30.0, -20.0, 0.0, -20.0, -10.0, 0.0, -20.0, -20.0, -10.0, 0.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, 0.0, -10.0, -10.0, -20.0, 0.0, -10.0, -10.0, -20.0, 0.0, 0.0, -30.0, 0.0, -20.0, -20.0, 0.0, -20.0, 0.0, -10.0, -20.0, -20.0, -10.0, -10.0, 0.0, -10.0, -20.0, 0.0, -20.0, 0.0, -10.0, 0.0, -20.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7218288664642742, "mean_inference_ms": 53.67798408305848, "mean_action_processing_ms": 0.22355650434143887, "mean_env_wait_ms": 0.16021085019460027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 11000, "timesteps_this_iter": 40, "agent_timesteps_total": 11000, "timers": {"sample_time_ms": 3263.912, "sample_throughput": 12.255, "learn_time_ms": 2425.061, "learn_throughput": 16.494, "update_time_ms": 45.117}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.80640172958374, "grad_norm": 30.633346557617188, "td_error_abs": 1.56995480855306, "q_taken_mean": 1.3308878580729167, "target_mean": 0.8251778284708658}}}, "num_steps_sampled": 11000, "num_agent_steps_sampled": 11000, "num_steps_trained": 11000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 10920, "num_target_updates": 21}, "done": false, "episodes_total": 1100, "training_iteration": 11, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-39-51", "timestamp": 1648895991, "time_this_iter_s": 81.51498985290527, "time_total_s": 894.6637058258057, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 894.6637058258057, "timesteps_since_restore": 440, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 23.50677966101695, "ram_util_percent": 60.391525423728794}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -10.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -30.0, -20.0, -20.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, 0.0, -10.0, -20.0, -10.0, 0.0, -10.0, -20.0, -10.0, -20.0, -20.0, 0.0, -20.0, -30.0, -10.0, 0.0, -10.0, -10.0, -20.0, -20.0, 10.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -20.0, -10.0, -20.0, -10.0, -10.0, 0.0, -20.0, -10.0, -20.0, -20.0, -20.0, 0.0, -10.0, 0.0, -10.0, -20.0, -30.0, -20.0, 0.0, -10.0, -20.0, -10.0, -30.0, -30.0, -10.0, 0.0, -10.0, 0.0, 10.0, -10.0, -10.0, -20.0, -20.0, -10.0, -20.0, 0.0, -30.0, -10.0, -20.0, -10.0, -10.0, 0.0, 10.0, -10.0, -10.0, 0.0, -10.0, -10.0, 10.0, -10.0, 10.0, 10.0, -10.0, 10.0, -10.0, 0.0, 0.0, -10.0, -20.0, -30.0, 0.0, -10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7237086531242823, "mean_inference_ms": 53.862447263558096, "mean_action_processing_ms": 0.22416583937988485, "mean_env_wait_ms": 0.16064933441909537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 12000, "timesteps_this_iter": 40, "agent_timesteps_total": 12000, "timers": {"sample_time_ms": 3266.564, "sample_throughput": 12.245, "learn_time_ms": 2441.636, "learn_throughput": 16.382, "update_time_ms": 44.777}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 3.8511531352996826, "grad_norm": 18.24444007873535, "td_error_abs": 1.0953347524007162, "q_taken_mean": 0.641917864481608, "target_mean": 0.48118508656819664}}}, "num_steps_sampled": 12000, "num_agent_steps_sampled": 12000, "num_steps_trained": 12000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 11960, "num_target_updates": 23}, "done": false, "episodes_total": 1200, "training_iteration": 12, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-41-13", "timestamp": 1648896073, "time_this_iter_s": 81.53055047988892, "time_total_s": 976.1942563056946, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 976.1942563056946, "timesteps_since_restore": 480, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.346153846153847, "ram_util_percent": 60.703418803418806}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": -8.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -20.0, -10.0, -10.0, -20.0, -20.0, 0.0, -10.0, 0.0, -20.0, -20.0, -20.0, -10.0, -10.0, -20.0, 10.0, -10.0, 0.0, -10.0, -10.0, -20.0, 0.0, -10.0, 0.0, -10.0, 0.0, -10.0, 10.0, -20.0, -20.0, -10.0, -20.0, -10.0, 0.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, -10.0, -20.0, 0.0, 0.0, 0.0, -20.0, -20.0, -20.0, 20.0, -10.0, -10.0, -20.0, 0.0, -10.0, 0.0, -10.0, 0.0, 10.0, -10.0, -10.0, 0.0, -20.0, 0.0, 10.0, 0.0, -10.0, -20.0, -10.0, -20.0, 0.0, -10.0, 0.0, -10.0, 0.0, 0.0, -20.0, -10.0, 0.0, -10.0, -10.0, -10.0, -10.0, -10.0, -20.0, -20.0, -10.0, -10.0, -10.0, 10.0, 10.0, -20.0, -20.0, -10.0, -10.0, -20.0, -10.0, -10.0, -10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7246603822018761, "mean_inference_ms": 53.9921782303502, "mean_action_processing_ms": 0.22461039585100617, "mean_env_wait_ms": 0.16091712178981551, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 13000, "timesteps_this_iter": 40, "agent_timesteps_total": 13000, "timers": {"sample_time_ms": 3227.528, "sample_throughput": 12.393, "learn_time_ms": 2402.837, "learn_throughput": 16.647, "update_time_ms": 45.649}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.151285171508789, "grad_norm": 14.03369426727295, "td_error_abs": 1.2528109232584634, "q_taken_mean": 0.5028055508931478, "target_mean": 0.6082247416178386}}}, "num_steps_sampled": 13000, "num_agent_steps_sampled": 13000, "num_steps_trained": 13000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 13000, "num_target_updates": 25}, "done": false, "episodes_total": 1300, "training_iteration": 13, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-42-35", "timestamp": 1648896155, "time_this_iter_s": 81.17455744743347, "time_total_s": 1057.368813753128, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1057.368813753128, "timesteps_since_restore": 520, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 22.991379310344822, "ram_util_percent": 61.06465517241379}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -9.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, 0.0, 0.0, -20.0, -20.0, -10.0, -20.0, -20.0, -20.0, -20.0, -20.0, 10.0, 0.0, 0.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, -20.0, 0.0, -10.0, -10.0, -20.0, -10.0, -20.0, 0.0, -10.0, -10.0, -20.0, -10.0, -10.0, -30.0, -20.0, -20.0, 10.0, -10.0, -10.0, 0.0, -20.0, 0.0, 10.0, 0.0, -10.0, 0.0, -30.0, 0.0, 0.0, -10.0, 0.0, -30.0, 10.0, -20.0, -20.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, -10.0, 10.0, -30.0, -10.0, -10.0, -10.0, -20.0, 10.0, 20.0, -10.0, -10.0, 10.0, 0.0, 0.0, 0.0, -20.0, -20.0, -10.0, -20.0, 0.0, -10.0, -10.0, 0.0, -20.0, -20.0, 0.0, -10.0, -20.0, -20.0, -20.0, -10.0, -30.0, -20.0, 10.0, -20.0, -20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7265881108270646, "mean_inference_ms": 54.1538988069547, "mean_action_processing_ms": 0.2252182358505045, "mean_env_wait_ms": 0.16154135611696746, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 14000, "timesteps_this_iter": 40, "agent_timesteps_total": 14000, "timers": {"sample_time_ms": 3253.609, "sample_throughput": 12.294, "learn_time_ms": 2402.628, "learn_throughput": 16.648, "update_time_ms": 53.759}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.0895795822143555, "grad_norm": 16.11397933959961, "td_error_abs": 1.5209387461344401, "q_taken_mean": 1.2935590108235677, "target_mean": 1.2728459676106771}}}, "num_steps_sampled": 14000, "num_agent_steps_sampled": 14000, "num_steps_trained": 14000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 13520, "num_target_updates": 26}, "done": false, "episodes_total": 1400, "training_iteration": 14, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-43-57", "timestamp": 1648896237, "time_this_iter_s": 81.7043068408966, "time_total_s": 1139.0731205940247, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1139.0731205940247, "timesteps_since_restore": 560, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.557264957264955, "ram_util_percent": 61.32136752136753}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -8.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -10.0, -20.0, 10.0, -10.0, -20.0, -10.0, -10.0, -10.0, -10.0, 0.0, 0.0, 0.0, -10.0, -20.0, -20.0, 0.0, 0.0, -20.0, -10.0, 0.0, -30.0, 0.0, -20.0, -20.0, -20.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, -10.0, -10.0, -10.0, -20.0, 0.0, -10.0, 10.0, -10.0, -10.0, -20.0, 0.0, 0.0, -20.0, 10.0, 0.0, 0.0, -10.0, -20.0, -20.0, -10.0, -10.0, -10.0, -20.0, -10.0, -20.0, -20.0, -10.0, -10.0, 0.0, -20.0, 0.0, -20.0, 0.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, -10.0, -20.0, 10.0, -10.0, -20.0, 0.0, -20.0, 10.0, 0.0, -20.0, -30.0, -10.0, 0.0, -20.0, 0.0, 0.0, -30.0, -10.0, -10.0, 0.0, -10.0, -10.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7292587609012676, "mean_inference_ms": 54.24633427512896, "mean_action_processing_ms": 0.2258634827862228, "mean_env_wait_ms": 0.1620096513284934, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 15000, "timesteps_this_iter": 40, "agent_timesteps_total": 15000, "timers": {"sample_time_ms": 3271.762, "sample_throughput": 12.226, "learn_time_ms": 2460.109, "learn_throughput": 16.259, "update_time_ms": 45.104}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.402597904205322, "grad_norm": 21.64215850830078, "td_error_abs": 1.3996542612711589, "q_taken_mean": -0.3498379389444987, "target_mean": -0.7039229075113932}}}, "num_steps_sampled": 15000, "num_agent_steps_sampled": 15000, "num_steps_trained": 15000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 14560, "num_target_updates": 28}, "done": false, "episodes_total": 1500, "training_iteration": 15, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-45-20", "timestamp": 1648896320, "time_this_iter_s": 82.29799103736877, "time_total_s": 1221.3711116313934, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1221.3711116313934, "timesteps_since_restore": 600, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.594915254237286, "ram_util_percent": 61.60254237288136}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -8.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -20.0, -10.0, -10.0, -10.0, -20.0, -20.0, -20.0, -10.0, -20.0, -10.0, 0.0, -20.0, -20.0, -20.0, -10.0, -30.0, -10.0, -10.0, -20.0, -10.0, -20.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, -20.0, -20.0, 0.0, 0.0, -10.0, -10.0, 0.0, -20.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -10.0, -10.0, -10.0, 0.0, 10.0, -10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, -10.0, -10.0, -10.0, 0.0, 0.0, 0.0, -10.0, 0.0, -10.0, -20.0, 0.0, 0.0, -10.0, -10.0, 10.0, 10.0, -10.0, -20.0, 0.0, -10.0, -20.0, 0.0, -10.0, -10.0, -10.0, -10.0, 10.0, -10.0, -30.0, -10.0, -10.0, 0.0, 0.0, -10.0, -10.0, -20.0, -20.0, -10.0, 0.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7303569710752241, "mean_inference_ms": 54.3573211801258, "mean_action_processing_ms": 0.22626207697781833, "mean_env_wait_ms": 0.16221291599974452, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 16000, "timesteps_this_iter": 40, "agent_timesteps_total": 16000, "timers": {"sample_time_ms": 3283.788, "sample_throughput": 12.181, "learn_time_ms": 2449.028, "learn_throughput": 16.333, "update_time_ms": 45.815}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.636475563049316, "grad_norm": 20.542343139648438, "td_error_abs": 1.255716069539388, "q_taken_mean": 0.5910694122314453, "target_mean": 0.5023856480916341}}}, "num_steps_sampled": 16000, "num_agent_steps_sampled": 16000, "num_steps_trained": 16000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 15600, "num_target_updates": 30}, "done": false, "episodes_total": 1600, "training_iteration": 16, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-46-43", "timestamp": 1648896403, "time_this_iter_s": 82.65780878067017, "time_total_s": 1304.0289204120636, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1304.0289204120636, "timesteps_since_restore": 640, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 23.389830508474578, "ram_util_percent": 61.96949152542372}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -7.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, -20.0, 0.0, -10.0, -20.0, 10.0, 0.0, 0.0, 10.0, -20.0, 10.0, -10.0, -20.0, 0.0, -20.0, -10.0, 10.0, 0.0, 0.0, 10.0, 10.0, -20.0, 0.0, -20.0, -20.0, 0.0, -20.0, -20.0, -20.0, -20.0, -10.0, -20.0, -10.0, -20.0, -20.0, -20.0, 20.0, 0.0, -10.0, 0.0, -10.0, -20.0, 0.0, -20.0, 0.0, 0.0, -30.0, -10.0, 0.0, 0.0, -10.0, -10.0, 0.0, -10.0, 0.0, 10.0, -10.0, -20.0, 10.0, 0.0, -10.0, -10.0, 0.0, -20.0, 0.0, -10.0, 0.0, 10.0, 0.0, -20.0, -10.0, 0.0, 10.0, 0.0, -30.0, 0.0, -20.0, -10.0, 0.0, -10.0, -10.0, -20.0, -10.0, -20.0, -20.0, -10.0, 0.0, -10.0, -10.0, -10.0, -10.0, 0.0, 10.0, -10.0, -10.0, 10.0, -10.0, -20.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7308924711331063, "mean_inference_ms": 54.45412776521221, "mean_action_processing_ms": 0.22650928784471155, "mean_env_wait_ms": 0.16234117910402632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 17000, "timesteps_this_iter": 40, "agent_timesteps_total": 17000, "timers": {"sample_time_ms": 3354.325, "sample_throughput": 11.925, "learn_time_ms": 2506.515, "learn_throughput": 15.958, "update_time_ms": 44.883}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.170506000518799, "grad_norm": 24.35611915588379, "td_error_abs": 1.5149705251057943, "q_taken_mean": -0.06353167692820232, "target_mean": 0.2645477135976156}}}, "num_steps_sampled": 17000, "num_agent_steps_sampled": 17000, "num_steps_trained": 17000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 16640, "num_target_updates": 32}, "done": false, "episodes_total": 1700, "training_iteration": 17, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-48-07", "timestamp": 1648896487, "time_this_iter_s": 83.60239815711975, "time_total_s": 1387.6313185691833, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1387.6313185691833, "timesteps_since_restore": 680, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.633333333333333, "ram_util_percent": 62.30333333333335}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -8.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -10.0, -10.0, -10.0, -20.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, -20.0, 10.0, -10.0, -20.0, 0.0, -10.0, -20.0, 10.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, 10.0, -10.0, 0.0, 0.0, -20.0, -10.0, 0.0, -20.0, -10.0, -10.0, 0.0, -20.0, 0.0, -10.0, -10.0, -10.0, 10.0, 10.0, 0.0, -10.0, -20.0, -20.0, -30.0, -10.0, 0.0, 0.0, 0.0, -20.0, -10.0, -10.0, -10.0, -20.0, -10.0, 0.0, 0.0, -10.0, 0.0, -30.0, -20.0, 0.0, 0.0, 10.0, -20.0, -10.0, -20.0, 10.0, -10.0, -10.0, -10.0, 0.0, 10.0, -10.0, -10.0, -30.0, -10.0, 0.0, -10.0, -10.0, -20.0, 0.0, -30.0, -20.0, -20.0, -20.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, 0.0, -20.0, 0.0, -30.0, -20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7314562956456792, "mean_inference_ms": 54.514003618376385, "mean_action_processing_ms": 0.226655924910838, "mean_env_wait_ms": 0.1624581734886754, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 18000, "timesteps_this_iter": 40, "agent_timesteps_total": 18000, "timers": {"sample_time_ms": 3343.052, "sample_throughput": 11.965, "learn_time_ms": 2509.105, "learn_throughput": 15.942, "update_time_ms": 43.815}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.122397422790527, "grad_norm": 22.33668327331543, "td_error_abs": 1.2278948465983073, "q_taken_mean": 0.49719060262044273, "target_mean": 0.20546018282572429}}}, "num_steps_sampled": 18000, "num_agent_steps_sampled": 18000, "num_steps_trained": 18000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 17680, "num_target_updates": 34}, "done": false, "episodes_total": 1800, "training_iteration": 18, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-49-30", "timestamp": 1648896570, "time_this_iter_s": 83.09548544883728, "time_total_s": 1470.7268040180206, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1470.7268040180206, "timesteps_since_restore": 720, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 23.30420168067227, "ram_util_percent": 62.55882352941177}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -8.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, -20.0, -10.0, -10.0, 0.0, -20.0, 0.0, 10.0, -20.0, -10.0, 0.0, -10.0, 0.0, -10.0, 0.0, 0.0, 0.0, -10.0, -10.0, -20.0, -10.0, 0.0, -10.0, -20.0, 0.0, -20.0, -10.0, -20.0, -10.0, 0.0, 0.0, -10.0, -30.0, 10.0, -20.0, -10.0, -10.0, -10.0, -20.0, -20.0, 0.0, 10.0, -20.0, -10.0, 20.0, 10.0, -30.0, -10.0, -10.0, -10.0, -20.0, -10.0, 0.0, -10.0, -10.0, 0.0, -20.0, -10.0, 0.0, -10.0, -10.0, 0.0, -30.0, 10.0, 0.0, -30.0, -10.0, 0.0, -10.0, 0.0, -10.0, -10.0, -20.0, 0.0, -20.0, -10.0, 0.0, -10.0, -10.0, 0.0, 0.0, -10.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, -10.0, -20.0, -10.0, -10.0, -10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7315080207514779, "mean_inference_ms": 54.532686626753076, "mean_action_processing_ms": 0.22666994031417545, "mean_env_wait_ms": 0.16246931449008528, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 19000, "timesteps_this_iter": 40, "agent_timesteps_total": 19000, "timers": {"sample_time_ms": 3331.843, "sample_throughput": 12.005, "learn_time_ms": 2504.144, "learn_throughput": 15.974, "update_time_ms": 51.846}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.425879955291748, "grad_norm": 15.695569038391113, "td_error_abs": 1.2101999918619792, "q_taken_mean": 0.9179789861043294, "target_mean": 0.794512685139974}}}, "num_steps_sampled": 19000, "num_agent_steps_sampled": 19000, "num_steps_trained": 19000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 18720, "num_target_updates": 36}, "done": false, "episodes_total": 1900, "training_iteration": 19, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-50-54", "timestamp": 1648896654, "time_this_iter_s": 83.04951119422913, "time_total_s": 1553.7763152122498, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1553.7763152122498, "timesteps_since_restore": 760, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 22.80168067226891, "ram_util_percent": 62.89747899159663}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -6.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -20.0, 0.0, -10.0, 0.0, 10.0, -10.0, 0.0, -20.0, -10.0, -20.0, -10.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -10.0, -10.0, 0.0, -10.0, 0.0, 20.0, 0.0, -30.0, -30.0, 0.0, 0.0, 0.0, -10.0, -20.0, -10.0, -10.0, 10.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -10.0, 10.0, 10.0, -20.0, -20.0, -10.0, -10.0, -20.0, -10.0, -10.0, 10.0, 0.0, -10.0, -10.0, -20.0, 0.0, 0.0, -10.0, -10.0, -20.0, -20.0, -10.0, 10.0, 0.0, -10.0, -10.0, -10.0, -10.0, 10.0, 0.0, 0.0, -30.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, -10.0, -10.0, 10.0, -10.0, 10.0, 0.0, -10.0, 0.0, -20.0, -10.0, -10.0, -10.0, -20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7319987666437657, "mean_inference_ms": 54.56088172557522, "mean_action_processing_ms": 0.22689016359707193, "mean_env_wait_ms": 0.16267089647332372, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 20000, "timesteps_this_iter": 40, "agent_timesteps_total": 20000, "timers": {"sample_time_ms": 3329.454, "sample_throughput": 12.014, "learn_time_ms": 2483.794, "learn_throughput": 16.104, "update_time_ms": 50.209}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.673899173736572, "grad_norm": 24.766408920288086, "td_error_abs": 1.3073509216308594, "q_taken_mean": 0.20940669377644858, "target_mean": 0.5707895914713542}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 20000, "num_steps_trained": 20000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 19760, "num_target_updates": 38}, "done": false, "episodes_total": 2000, "training_iteration": 20, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-52-18", "timestamp": 1648896738, "time_this_iter_s": 83.56634974479675, "time_total_s": 1637.3426649570465, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1637.3426649570465, "timesteps_since_restore": 800, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.4725, "ram_util_percent": 63.233333333333334}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -9.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -30.0, -10.0, -10.0, 10.0, -20.0, 0.0, -10.0, -10.0, -10.0, -20.0, -20.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, -30.0, -10.0, -20.0, 10.0, 0.0, 10.0, -10.0, -20.0, -10.0, -20.0, -20.0, -30.0, -10.0, -20.0, -30.0, 0.0, -10.0, -20.0, -10.0, -20.0, 10.0, -20.0, -10.0, -20.0, 0.0, -10.0, 10.0, 10.0, 10.0, -10.0, -20.0, 0.0, -20.0, -20.0, -10.0, -10.0, 0.0, 0.0, -10.0, -20.0, -20.0, -10.0, -10.0, 0.0, 0.0, 10.0, -10.0, -10.0, -20.0, -10.0, -10.0, 0.0, 0.0, 0.0, -10.0, -20.0, -10.0, -10.0, -10.0, -10.0, -20.0, -10.0, 10.0, 0.0, -10.0, 0.0, 10.0, -10.0, 10.0, -10.0, -20.0, -20.0, -20.0, -10.0, -10.0, -20.0, -10.0, 0.0, -10.0, -10.0, -20.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7321402087163481, "mean_inference_ms": 54.588282115117565, "mean_action_processing_ms": 0.22702926773045143, "mean_env_wait_ms": 0.16278307725306676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 21000, "timesteps_this_iter": 40, "agent_timesteps_total": 21000, "timers": {"sample_time_ms": 3341.543, "sample_throughput": 11.971, "learn_time_ms": 2481.17, "learn_throughput": 16.121, "update_time_ms": 43.471}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.101308345794678, "grad_norm": 27.168630599975586, "td_error_abs": 1.5664398193359375, "q_taken_mean": 0.8187656402587891, "target_mean": 0.4547739346822103}}}, "num_steps_sampled": 21000, "num_agent_steps_sampled": 21000, "num_steps_trained": 21000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 20800, "num_target_updates": 40}, "done": false, "episodes_total": 2100, "training_iteration": 21, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-53-41", "timestamp": 1648896821, "time_this_iter_s": 82.94360852241516, "time_total_s": 1720.2862734794617, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1720.2862734794617, "timesteps_since_restore": 840, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 23.321848739495795, "ram_util_percent": 63.495798319327726}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -8.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 20.0, -10.0, -10.0, -20.0, -20.0, -30.0, 0.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -20.0, 10.0, 10.0, -20.0, 10.0, -10.0, 0.0, -10.0, -30.0, -10.0, -10.0, 0.0, 0.0, -30.0, 0.0, 0.0, -20.0, 0.0, 10.0, 10.0, -10.0, -10.0, -10.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, -10.0, 0.0, -20.0, 0.0, -30.0, -10.0, -20.0, -10.0, -10.0, -20.0, 0.0, -10.0, 10.0, 0.0, -20.0, 0.0, -10.0, -10.0, -20.0, 0.0, -10.0, -20.0, -10.0, 0.0, -10.0, -10.0, 0.0, 0.0, -10.0, -10.0, 0.0, -30.0, -10.0, 0.0, 10.0, -10.0, -10.0, 0.0, -30.0, 0.0, -20.0, 0.0, -10.0, -20.0, 0.0, -10.0, -20.0, -20.0, -10.0, -20.0, 10.0, -10.0, 0.0, -20.0, -10.0, 0.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7325660378428897, "mean_inference_ms": 54.60971994760621, "mean_action_processing_ms": 0.2271502998780606, "mean_env_wait_ms": 0.16283255407017505, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 22000, "timesteps_this_iter": 40, "agent_timesteps_total": 22000, "timers": {"sample_time_ms": 3359.924, "sample_throughput": 11.905, "learn_time_ms": 2511.011, "learn_throughput": 15.93, "update_time_ms": 58.608}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.1036834716796875, "grad_norm": 23.51827621459961, "td_error_abs": 1.5498985290527343, "q_taken_mean": 0.018377272288004558, "target_mean": 0.2276327927907308}}}, "num_steps_sampled": 22000, "num_agent_steps_sampled": 22000, "num_steps_trained": 22000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 21840, "num_target_updates": 42}, "done": false, "episodes_total": 2200, "training_iteration": 22, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-55-06", "timestamp": 1648896906, "time_this_iter_s": 83.8024537563324, "time_total_s": 1804.088727235794, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1804.088727235794, "timesteps_since_restore": 880, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 22.991666666666667, "ram_util_percent": 63.85250000000001}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -8.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -10.0, 0.0, -10.0, 10.0, -10.0, -20.0, 0.0, 0.0, 0.0, -10.0, -20.0, 0.0, 0.0, 20.0, -20.0, -20.0, 0.0, -10.0, -20.0, 0.0, -10.0, 0.0, -10.0, -30.0, 0.0, -20.0, -20.0, -20.0, -10.0, 10.0, 0.0, -20.0, -10.0, 0.0, 0.0, -10.0, 0.0, -10.0, 0.0, -10.0, -10.0, -20.0, -20.0, -10.0, 0.0, -10.0, -10.0, -10.0, -30.0, -10.0, 0.0, -10.0, -10.0, -10.0, 10.0, -10.0, -10.0, -10.0, -30.0, -20.0, -10.0, -10.0, -10.0, 0.0, -20.0, 0.0, -20.0, -20.0, 10.0, 0.0, 0.0, 0.0, -10.0, -10.0, 10.0, -10.0, 10.0, -10.0, -10.0, -20.0, -20.0, -10.0, -20.0, 0.0, -30.0, -10.0, -20.0, 10.0, -10.0, 0.0, 0.0, -20.0, -10.0, -20.0, -10.0, -20.0, 0.0, 0.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7328524048111578, "mean_inference_ms": 54.639604822943824, "mean_action_processing_ms": 0.2272838075313127, "mean_env_wait_ms": 0.16288139823829997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 23000, "timesteps_this_iter": 40, "agent_timesteps_total": 23000, "timers": {"sample_time_ms": 3331.848, "sample_throughput": 12.005, "learn_time_ms": 2500.385, "learn_throughput": 15.998, "update_time_ms": 51.543}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.17166805267334, "grad_norm": 26.896100997924805, "td_error_abs": 1.32022705078125, "q_taken_mean": 0.3706155776977539, "target_mean": 0.8207302729288737}}}, "num_steps_sampled": 23000, "num_agent_steps_sampled": 23000, "num_steps_trained": 23000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 22880, "num_target_updates": 44}, "done": false, "episodes_total": 2300, "training_iteration": 23, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-56-30", "timestamp": 1648896990, "time_this_iter_s": 83.73600745201111, "time_total_s": 1887.8247346878052, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1887.8247346878052, "timesteps_since_restore": 920, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.2475, "ram_util_percent": 64.09583333333333}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -6.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, 0.0, 10.0, 0.0, -10.0, 0.0, -20.0, 0.0, -30.0, 0.0, -10.0, -20.0, -10.0, 0.0, 0.0, -20.0, -30.0, 0.0, -10.0, -10.0, -20.0, -10.0, 0.0, -10.0, 0.0, 0.0, 0.0, -20.0, -10.0, -10.0, -10.0, -10.0, 0.0, 0.0, 0.0, -20.0, -10.0, -10.0, -10.0, 0.0, 0.0, -20.0, 0.0, -10.0, -10.0, -10.0, -20.0, 0.0, -10.0, 10.0, 0.0, -10.0, -10.0, -10.0, 0.0, 0.0, -10.0, -20.0, 0.0, 0.0, 10.0, -20.0, 0.0, -10.0, 10.0, -10.0, 0.0, 0.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, 0.0, 10.0, -10.0, -20.0, 0.0, 0.0, -20.0, 0.0, 0.0, -20.0, 0.0, -10.0, 0.0, -30.0, -10.0, 0.0, -10.0, -10.0, 10.0, 0.0, 0.0, -10.0, 10.0, 10.0, -20.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7337708708406033, "mean_inference_ms": 54.67657104489645, "mean_action_processing_ms": 0.2274122601289627, "mean_env_wait_ms": 0.16294139918635792, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 24000, "timesteps_this_iter": 40, "agent_timesteps_total": 24000, "timers": {"sample_time_ms": 3332.151, "sample_throughput": 12.004, "learn_time_ms": 2504.657, "learn_throughput": 15.97, "update_time_ms": 43.445}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.837825298309326, "grad_norm": 20.41138458251953, "td_error_abs": 1.4125157674153646, "q_taken_mean": 0.4725289026896159, "target_mean": 0.3255764961242676}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 24000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 23920, "num_target_updates": 46}, "done": false, "episodes_total": 2400, "training_iteration": 24, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-57-53", "timestamp": 1648897073, "time_this_iter_s": 83.33951163291931, "time_total_s": 1971.1642463207245, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1971.1642463207245, "timesteps_since_restore": 960, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.310833333333335, "ram_util_percent": 64.39166666666667}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -5.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, -10.0, -10.0, -20.0, -20.0, -20.0, -10.0, -20.0, -20.0, -10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -20.0, 10.0, 10.0, -10.0, -20.0, 0.0, -10.0, -10.0, -10.0, -20.0, -10.0, 0.0, -10.0, -10.0, 0.0, -20.0, 10.0, 0.0, -20.0, 10.0, -10.0, 0.0, 0.0, -10.0, -20.0, -20.0, -20.0, 10.0, 0.0, 0.0, 0.0, -30.0, 0.0, -10.0, -10.0, 10.0, 10.0, -20.0, -10.0, 20.0, 0.0, -10.0, 0.0, -10.0, 0.0, 0.0, -20.0, 0.0, -10.0, -20.0, 0.0, 0.0, -10.0, -20.0, 0.0, 10.0, 0.0, 0.0, -20.0, -30.0, 0.0, 0.0, 0.0, 10.0, -20.0, 0.0, 0.0, -20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7345933300879378, "mean_inference_ms": 54.73779045358844, "mean_action_processing_ms": 0.227685900349328, "mean_env_wait_ms": 0.1630339121326525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 25000, "timesteps_this_iter": 40, "agent_timesteps_total": 25000, "timers": {"sample_time_ms": 3399.581, "sample_throughput": 11.766, "learn_time_ms": 2537.338, "learn_throughput": 15.765, "update_time_ms": 55.572}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.447332382202148, "grad_norm": 15.210259437561035, "td_error_abs": 1.2378331502278646, "q_taken_mean": 0.6459984461466471, "target_mean": 0.8093059539794922}}}, "num_steps_sampled": 25000, "num_agent_steps_sampled": 25000, "num_steps_trained": 25000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 24960, "num_target_updates": 48}, "done": false, "episodes_total": 2500, "training_iteration": 25, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_03-59-18", "timestamp": 1648897158, "time_this_iter_s": 84.43693399429321, "time_total_s": 2055.6011803150177, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2055.6011803150177, "timesteps_since_restore": 1000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 23.61404958677686, "ram_util_percent": 64.68512396694216}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -6.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 10.0, -10.0, -10.0, -20.0, 0.0, -10.0, 0.0, -10.0, -10.0, 0.0, 0.0, -20.0, -10.0, -10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -20.0, 0.0, -20.0, -10.0, 0.0, 10.0, -20.0, 0.0, 0.0, -20.0, -10.0, 0.0, 10.0, -10.0, 10.0, -10.0, -10.0, -30.0, -10.0, -10.0, -20.0, 0.0, -20.0, -20.0, -10.0, -10.0, -10.0, -20.0, 10.0, -20.0, -10.0, 0.0, -20.0, -20.0, -10.0, -20.0, -20.0, 0.0, -20.0, 0.0, 0.0, -10.0, -10.0, -10.0, 0.0, 0.0, -10.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, -10.0, -20.0, 10.0, 10.0, 0.0, -20.0, 0.0, -20.0, -20.0, 10.0, 10.0, -10.0, -10.0, 0.0, 10.0, -10.0, 10.0, -20.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7350511540634558, "mean_inference_ms": 54.76670324976602, "mean_action_processing_ms": 0.22781999124744964, "mean_env_wait_ms": 0.1631667294551401, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 26000, "timesteps_this_iter": 40, "agent_timesteps_total": 26000, "timers": {"sample_time_ms": 3335.76, "sample_throughput": 11.991, "learn_time_ms": 2498.179, "learn_throughput": 16.012, "update_time_ms": 44.143}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 3.856903076171875, "grad_norm": 18.631214141845703, "td_error_abs": 1.323798624674479, "q_taken_mean": 1.7574644724527995, "target_mean": 1.480789057413737}}}, "num_steps_sampled": 26000, "num_agent_steps_sampled": 26000, "num_steps_trained": 26000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 26000, "num_target_updates": 50}, "done": false, "episodes_total": 2600, "training_iteration": 26, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-00-42", "timestamp": 1648897242, "time_this_iter_s": 83.729807138443, "time_total_s": 2139.3309874534607, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2139.3309874534607, "timesteps_since_restore": 1040, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.065833333333334, "ram_util_percent": 64.9775}}
{"episode_reward_max": 10.0, "episode_reward_min": -20.0, "episode_reward_mean": -6.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, 10.0, -20.0, -10.0, 0.0, -10.0, -10.0, -20.0, -10.0, -20.0, -20.0, 0.0, -10.0, 10.0, -10.0, -20.0, -10.0, -10.0, 10.0, 0.0, 0.0, -10.0, 10.0, 0.0, -10.0, -10.0, 0.0, -10.0, 0.0, -20.0, -10.0, -10.0, 0.0, 10.0, -10.0, 0.0, -20.0, -10.0, -20.0, -10.0, -20.0, 0.0, 10.0, -10.0, -20.0, -10.0, 0.0, 0.0, -10.0, -20.0, -10.0, -10.0, 0.0, -10.0, -10.0, 0.0, -10.0, 0.0, -10.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, -10.0, -20.0, 0.0, -10.0, 0.0, -10.0, -20.0, -10.0, 0.0, 0.0, 0.0, -10.0, -10.0, -20.0, 10.0, 10.0, -10.0, 0.0, 0.0, 10.0, -10.0, -10.0, -10.0, -10.0, 0.0, 10.0, 10.0, -10.0, 10.0, -10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7353636922173774, "mean_inference_ms": 54.78444690616763, "mean_action_processing_ms": 0.2279171077008955, "mean_env_wait_ms": 0.1632099133246988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 27000, "timesteps_this_iter": 40, "agent_timesteps_total": 27000, "timers": {"sample_time_ms": 3299.384, "sample_throughput": 12.123, "learn_time_ms": 2484.531, "learn_throughput": 16.1, "update_time_ms": 44.284}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.7833333015441895, "grad_norm": 17.18701171875, "td_error_abs": 1.3721007029215495, "q_taken_mean": 1.2305814107259114, "target_mean": 1.0721763610839843}}}, "num_steps_sampled": 27000, "num_agent_steps_sampled": 27000, "num_steps_trained": 27000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 26520, "num_target_updates": 51}, "done": false, "episodes_total": 2700, "training_iteration": 27, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-02-06", "timestamp": 1648897326, "time_this_iter_s": 83.17063069343567, "time_total_s": 2222.5016181468964, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2222.5016181468964, "timesteps_since_restore": 1080, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 22.99327731092437, "ram_util_percent": 65.31512605042019}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -5.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, -20.0, 0.0, -20.0, 0.0, 0.0, -10.0, 0.0, -10.0, -10.0, 0.0, -10.0, -20.0, 0.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, 0.0, -20.0, 0.0, -20.0, 0.0, 0.0, -10.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -20.0, 0.0, -10.0, -10.0, -20.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, -10.0, 0.0, 0.0, 10.0, -10.0, 0.0, -10.0, 0.0, 10.0, 0.0, -20.0, 10.0, 0.0, 10.0, -20.0, -10.0, -20.0, 10.0, -10.0, 0.0, 0.0, -10.0, -20.0, 0.0, -20.0, -10.0, 10.0, -10.0, 0.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, -10.0, -10.0, -10.0, -10.0, 10.0, 0.0, -20.0, -10.0, 0.0, -10.0, -10.0, -30.0, -20.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7354873467336265, "mean_inference_ms": 54.813113430196466, "mean_action_processing_ms": 0.2280530325430936, "mean_env_wait_ms": 0.1632896700410771, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 28000, "timesteps_this_iter": 40, "agent_timesteps_total": 28000, "timers": {"sample_time_ms": 3346.43, "sample_throughput": 11.953, "learn_time_ms": 2505.425, "learn_throughput": 15.965, "update_time_ms": 43.598}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.693192005157471, "grad_norm": 20.941408157348633, "td_error_abs": 1.535912322998047, "q_taken_mean": 0.38402156829833983, "target_mean": 0.705149777730306}}}, "num_steps_sampled": 28000, "num_agent_steps_sampled": 28000, "num_steps_trained": 28000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 27560, "num_target_updates": 53}, "done": false, "episodes_total": 2800, "training_iteration": 28, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-03-30", "timestamp": 1648897410, "time_this_iter_s": 83.33156323432922, "time_total_s": 2305.8331813812256, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2305.8331813812256, "timesteps_since_restore": 1120, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 23.28067226890756, "ram_util_percent": 65.6294117647059}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -4.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, 10.0, -10.0, 10.0, 0.0, -10.0, -10.0, 10.0, -20.0, -10.0, -10.0, -10.0, 0.0, 0.0, 0.0, -20.0, -10.0, 0.0, 0.0, -10.0, 10.0, -10.0, 10.0, -10.0, -20.0, -20.0, 0.0, 0.0, -10.0, 0.0, -10.0, 0.0, -10.0, -10.0, 0.0, -10.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, -20.0, -10.0, 0.0, -10.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -30.0, -10.0, -10.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, -20.0, 0.0, 0.0, -10.0, 0.0, -10.0, 0.0, -20.0, -10.0, 0.0, -10.0, 0.0, 10.0, -10.0, -10.0, -10.0, 20.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7358949573397421, "mean_inference_ms": 54.863293702611266, "mean_action_processing_ms": 0.22823598331919115, "mean_env_wait_ms": 0.16341452236225518, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 29000, "timesteps_this_iter": 40, "agent_timesteps_total": 29000, "timers": {"sample_time_ms": 3321.277, "sample_throughput": 12.044, "learn_time_ms": 2483.069, "learn_throughput": 16.109, "update_time_ms": 44.477}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.364382266998291, "grad_norm": 13.639921188354492, "td_error_abs": 1.300989023844401, "q_taken_mean": 1.1994712829589844, "target_mean": 1.2563491821289063}}}, "num_steps_sampled": 29000, "num_agent_steps_sampled": 29000, "num_steps_trained": 29000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 28600, "num_target_updates": 55}, "done": false, "episodes_total": 2900, "training_iteration": 29, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-04-53", "timestamp": 1648897493, "time_this_iter_s": 82.99993824958801, "time_total_s": 2388.8331196308136, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2388.8331196308136, "timesteps_since_restore": 1160, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 23.194117647058828, "ram_util_percent": 65.95882352941176}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -5.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -20.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -20.0, -10.0, 0.0, 0.0, -20.0, 10.0, -10.0, 10.0, -10.0, -10.0, -20.0, -10.0, -10.0, 20.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 10.0, -10.0, -10.0, 0.0, 0.0, -10.0, -10.0, 0.0, -10.0, -20.0, 0.0, -20.0, 0.0, -10.0, -10.0, -30.0, 10.0, 0.0, -30.0, 0.0, 10.0, -10.0, 0.0, -10.0, 10.0, -20.0, -10.0, -30.0, 0.0, -10.0, 0.0, -10.0, -20.0, -20.0, -10.0, -10.0, 0.0, -10.0, 0.0, 0.0, 10.0, -10.0, 10.0, -10.0, 0.0, -10.0, -10.0, 0.0, -10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -10.0, -10.0, -20.0, -20.0, 0.0, 0.0, 0.0, -10.0, -10.0, 10.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7368463736314038, "mean_inference_ms": 54.91695527537093, "mean_action_processing_ms": 0.22837722671777314, "mean_env_wait_ms": 0.16351319713411994, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 30000, "timesteps_this_iter": 40, "agent_timesteps_total": 30000, "timers": {"sample_time_ms": 3302.019, "sample_throughput": 12.114, "learn_time_ms": 2461.828, "learn_throughput": 16.248, "update_time_ms": 43.683}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.054539203643799, "grad_norm": 18.829198837280273, "td_error_abs": 1.629632822672526, "q_taken_mean": 0.15738506317138673, "target_mean": 0.3060362180074056}}}, "num_steps_sampled": 30000, "num_agent_steps_sampled": 30000, "num_steps_trained": 30000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 29640, "num_target_updates": 57}, "done": false, "episodes_total": 3000, "training_iteration": 30, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-06-17", "timestamp": 1648897577, "time_this_iter_s": 83.16224956512451, "time_total_s": 2471.995369195938, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2471.995369195938, "timesteps_since_restore": 1200, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 23.465546218487397, "ram_util_percent": 66.19411764705883}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -5.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -30.0, -20.0, 0.0, 10.0, 0.0, 10.0, 20.0, -10.0, -20.0, 0.0, 0.0, 0.0, 10.0, -10.0, -20.0, 0.0, -10.0, -20.0, 10.0, -10.0, 10.0, 0.0, -20.0, -10.0, 0.0, -10.0, -20.0, -10.0, 0.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, 0.0, 20.0, 0.0, -20.0, 10.0, 10.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, -10.0, -20.0, -10.0, 0.0, -20.0, 0.0, -10.0, -10.0, 0.0, 0.0, -10.0, -10.0, -20.0, 0.0, 0.0, -10.0, -10.0, -10.0, 0.0, 0.0, -10.0, -10.0, -10.0, -10.0, -10.0, 0.0, -20.0, -10.0, -20.0, -10.0, 0.0, 0.0, 0.0, -10.0, 0.0, -10.0, -20.0, -10.0, -10.0, -10.0, -10.0, 10.0, -10.0, 0.0, 10.0, -10.0, -10.0, 0.0, -10.0, 0.0, 10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7373684376320553, "mean_inference_ms": 54.94824432124018, "mean_action_processing_ms": 0.22859442481655046, "mean_env_wait_ms": 0.16393758084539933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 31000, "timesteps_this_iter": 40, "agent_timesteps_total": 31000, "timers": {"sample_time_ms": 3369.722, "sample_throughput": 11.87, "learn_time_ms": 2507.768, "learn_throughput": 15.95, "update_time_ms": 44.629}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.61334228515625, "grad_norm": 20.234893798828125, "td_error_abs": 1.6217562357584636, "q_taken_mean": 2.195672098795573, "target_mean": 2.0091898600260416}}}, "num_steps_sampled": 31000, "num_agent_steps_sampled": 31000, "num_steps_trained": 31000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 30680, "num_target_updates": 59}, "done": false, "episodes_total": 3100, "training_iteration": 31, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-07-41", "timestamp": 1648897661, "time_this_iter_s": 83.53363728523254, "time_total_s": 2555.5290064811707, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2555.5290064811707, "timesteps_since_restore": 1240, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 23.101666666666667, "ram_util_percent": 66.51916666666666}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": -5.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, 0.0, 0.0, -20.0, -10.0, 10.0, 0.0, 10.0, 10.0, 20.0, -20.0, -20.0, 0.0, 0.0, -20.0, -10.0, 0.0, -20.0, -10.0, -10.0, -10.0, 0.0, -10.0, -10.0, 0.0, -20.0, -10.0, -20.0, 0.0, -10.0, -20.0, -10.0, 0.0, 0.0, -10.0, 0.0, -20.0, 10.0, -10.0, -10.0, -20.0, -20.0, 0.0, 0.0, 10.0, -10.0, -10.0, -20.0, 10.0, 0.0, -10.0, -20.0, -20.0, -10.0, -10.0, -20.0, -10.0, 10.0, 0.0, 0.0, -10.0, -20.0, -20.0, -10.0, 0.0, 10.0, 0.0, -10.0, 0.0, -10.0, -10.0, -10.0, 0.0, -10.0, -10.0, 0.0, 10.0, -20.0, 10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 0.0, 10.0, -20.0, -10.0, 0.0, -20.0, 10.0, 20.0, 0.0, 0.0, -10.0, -20.0, -10.0, 0.0, 0.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7375274773106517, "mean_inference_ms": 54.946992147298126, "mean_action_processing_ms": 0.22862768369888514, "mean_env_wait_ms": 0.16395964632629081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 32000, "timesteps_this_iter": 40, "agent_timesteps_total": 32000, "timers": {"sample_time_ms": 3310.028, "sample_throughput": 12.084, "learn_time_ms": 2487.025, "learn_throughput": 16.083, "update_time_ms": 48.252}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.8617963790893555, "grad_norm": 15.938898086547852, "td_error_abs": 1.6389549255371094, "q_taken_mean": 1.8014266967773438, "target_mean": 1.8336566925048827}}}, "num_steps_sampled": 32000, "num_agent_steps_sampled": 32000, "num_steps_trained": 32000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 31720, "num_target_updates": 61}, "done": false, "episodes_total": 3200, "training_iteration": 32, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-09-04", "timestamp": 1648897744, "time_this_iter_s": 83.09762644767761, "time_total_s": 2638.6266329288483, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2638.6266329288483, "timesteps_since_restore": 1280, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 22.85126050420168, "ram_util_percent": 66.82689075630252}}
{"episode_reward_max": 30.0, "episode_reward_min": -30.0, "episode_reward_mean": -3.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, -10.0, 0.0, -20.0, -10.0, 20.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, -20.0, -10.0, -20.0, -10.0, 0.0, 10.0, -10.0, 20.0, -10.0, -10.0, 0.0, -30.0, -10.0, -10.0, -10.0, -10.0, 0.0, -10.0, 0.0, 0.0, 20.0, -10.0, 0.0, 0.0, -10.0, 0.0, -10.0, 10.0, 0.0, -10.0, 10.0, 10.0, -10.0, -10.0, 0.0, -20.0, -20.0, -10.0, -20.0, 0.0, -10.0, 0.0, 0.0, 0.0, -20.0, -10.0, 0.0, 10.0, -10.0, 0.0, 20.0, 0.0, -20.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, -20.0, -10.0, 0.0, -20.0, 0.0, 10.0, -10.0, 10.0, 0.0, 30.0, 0.0, -10.0, 0.0, -10.0, -10.0, 0.0, -10.0, 20.0, -10.0, 0.0, -10.0, -10.0, 10.0, 0.0, 10.0, 0.0, -30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7379047582545664, "mean_inference_ms": 54.97003011942746, "mean_action_processing_ms": 0.228768795883998, "mean_env_wait_ms": 0.1641002052149011, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 33000, "timesteps_this_iter": 40, "agent_timesteps_total": 33000, "timers": {"sample_time_ms": 3324.561, "sample_throughput": 12.032, "learn_time_ms": 2491.5, "learn_throughput": 16.055, "update_time_ms": 44.399}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.458323955535889, "grad_norm": 22.394569396972656, "td_error_abs": 1.5813621520996093, "q_taken_mean": 1.0905977884928386, "target_mean": 1.3616915384928385}}}, "num_steps_sampled": 33000, "num_agent_steps_sampled": 33000, "num_steps_trained": 33000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 32760, "num_target_updates": 63}, "done": false, "episodes_total": 3300, "training_iteration": 33, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-10-29", "timestamp": 1648897829, "time_this_iter_s": 83.94601058959961, "time_total_s": 2722.572643518448, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2722.572643518448, "timesteps_since_restore": 1320, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.547500000000003, "ram_util_percent": 67.17}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -1.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, -20.0, -20.0, 10.0, -10.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -20.0, -10.0, 0.0, 20.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, -10.0, 0.0, -30.0, 0.0, -10.0, 10.0, -10.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, -10.0, 20.0, 0.0, 0.0, -10.0, -10.0, 10.0, -20.0, -10.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, 20.0, 10.0, -10.0, -10.0, -20.0, 0.0, 0.0, -20.0, -20.0, 0.0, -10.0, 10.0, -10.0, 0.0, 10.0, -10.0, -10.0, 20.0, 10.0, -10.0, 20.0, 10.0, 10.0, -10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, -10.0, 0.0, -20.0, -10.0, -10.0, -20.0, 0.0, 10.0, 0.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7381167093202262, "mean_inference_ms": 54.99483124534741, "mean_action_processing_ms": 0.2288765001964491, "mean_env_wait_ms": 0.16416634353325374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 34000, "timesteps_this_iter": 40, "agent_timesteps_total": 34000, "timers": {"sample_time_ms": 3359.492, "sample_throughput": 11.907, "learn_time_ms": 2525.399, "learn_throughput": 15.839, "update_time_ms": 49.443}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.323458671569824, "grad_norm": 13.305399894714355, "td_error_abs": 1.203448486328125, "q_taken_mean": 1.4382929484049478, "target_mean": 1.4037455240885417}}}, "num_steps_sampled": 34000, "num_agent_steps_sampled": 34000, "num_steps_trained": 34000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 33800, "num_target_updates": 65}, "done": false, "episodes_total": 3400, "training_iteration": 34, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-11-53", "timestamp": 1648897913, "time_this_iter_s": 84.0672492980957, "time_total_s": 2806.6398928165436, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2806.6398928165436, "timesteps_since_restore": 1360, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 23.742148760330583, "ram_util_percent": 67.48760330578511}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": -3.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, 0.0, 0.0, -20.0, -20.0, -10.0, -10.0, -10.0, 10.0, 0.0, -10.0, -10.0, 10.0, -10.0, 0.0, 0.0, 0.0, -20.0, 20.0, 0.0, -10.0, -10.0, 0.0, 0.0, 10.0, 0.0, -10.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, 0.0, -10.0, 0.0, -10.0, 10.0, -10.0, 0.0, 0.0, 10.0, -10.0, -10.0, -20.0, -20.0, 0.0, 0.0, -20.0, -10.0, 0.0, -10.0, 30.0, -20.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -10.0, -10.0, -10.0, 0.0, -10.0, -10.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, -10.0, -20.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 10.0, -10.0, -10.0, -10.0, -20.0, 10.0, -20.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.738357151730267, "mean_inference_ms": 55.023367146657755, "mean_action_processing_ms": 0.22897853427390452, "mean_env_wait_ms": 0.16423681506755322, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 35000, "timesteps_this_iter": 40, "agent_timesteps_total": 35000, "timers": {"sample_time_ms": 3345.317, "sample_throughput": 11.957, "learn_time_ms": 2509.19, "learn_throughput": 15.941, "update_time_ms": 43.662}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.644384860992432, "grad_norm": 20.562549591064453, "td_error_abs": 1.6161282857259114, "q_taken_mean": 1.9680577596028646, "target_mean": 1.8167747497558593}}}, "num_steps_sampled": 35000, "num_agent_steps_sampled": 35000, "num_steps_trained": 35000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 34840, "num_target_updates": 67}, "done": false, "episodes_total": 3500, "training_iteration": 35, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-13-18", "timestamp": 1648897998, "time_this_iter_s": 83.84005832672119, "time_total_s": 2890.4799511432648, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2890.4799511432648, "timesteps_since_restore": 1400, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 23.386666666666667, "ram_util_percent": 67.7975}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -3.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -10.0, -10.0, 20.0, 10.0, -10.0, -20.0, 10.0, 0.0, -10.0, 0.0, -10.0, -10.0, -10.0, 0.0, -10.0, 0.0, 0.0, -10.0, -10.0, 0.0, -10.0, -10.0, -30.0, 0.0, 0.0, -10.0, 10.0, 10.0, 0.0, -20.0, 0.0, 0.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -20.0, -10.0, 0.0, -10.0, 10.0, 0.0, -20.0, 0.0, -10.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, 0.0, -10.0, -10.0, 0.0, 0.0, 20.0, -10.0, -10.0, 0.0, 10.0, 0.0, 0.0, -10.0, 0.0, -20.0, -10.0, -10.0, -10.0, 10.0, -10.0, -10.0, 0.0, -10.0, -20.0, 10.0, 0.0, -20.0, 10.0, 10.0, -10.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7385426581587984, "mean_inference_ms": 55.02377875764269, "mean_action_processing_ms": 0.22898622518538794, "mean_env_wait_ms": 0.16424978670709972, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 36000, "timesteps_this_iter": 40, "agent_timesteps_total": 36000, "timers": {"sample_time_ms": 3369.361, "sample_throughput": 11.872, "learn_time_ms": 2536.548, "learn_throughput": 15.769, "update_time_ms": 50.774}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.485533714294434, "grad_norm": 20.806699752807617, "td_error_abs": 1.503946050008138, "q_taken_mean": 1.571822992960612, "target_mean": 1.8819483439127604}}}, "num_steps_sampled": 36000, "num_agent_steps_sampled": 36000, "num_steps_trained": 36000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 35880, "num_target_updates": 69}, "done": false, "episodes_total": 3600, "training_iteration": 36, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-14-42", "timestamp": 1648898082, "time_this_iter_s": 83.9755072593689, "time_total_s": 2974.4554584026337, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2974.4554584026337, "timesteps_since_restore": 1440, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.785, "ram_util_percent": 68.12083333333334}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -2.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, 0.0, -10.0, 0.0, 10.0, -10.0, -20.0, 0.0, -10.0, 0.0, -20.0, 0.0, -10.0, -10.0, -20.0, 10.0, 20.0, -30.0, -10.0, -10.0, 10.0, -10.0, 10.0, 10.0, -10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 10.0, -10.0, 0.0, 10.0, 0.0, -10.0, 0.0, 0.0, 0.0, -10.0, -20.0, 10.0, 0.0, -20.0, 10.0, 0.0, -10.0, 10.0, 0.0, 0.0, -20.0, -20.0, 10.0, 0.0, -20.0, 10.0, 10.0, -20.0, 0.0, 0.0, 0.0, 0.0, -10.0, -20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 10.0, 0.0, -10.0, -10.0, 10.0, 10.0, -30.0, -10.0, 0.0, 20.0, -10.0, 0.0, -10.0, 0.0, -10.0, -10.0, 0.0, -10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.738488205212952, "mean_inference_ms": 55.045005663345094, "mean_action_processing_ms": 0.2290037448645127, "mean_env_wait_ms": 0.16425395189730005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 37000, "timesteps_this_iter": 40, "agent_timesteps_total": 37000, "timers": {"sample_time_ms": 3380.419, "sample_throughput": 11.833, "learn_time_ms": 2504.828, "learn_throughput": 15.969, "update_time_ms": 64.864}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.245025634765625, "grad_norm": 11.924015045166016, "td_error_abs": 1.4069061279296875, "q_taken_mean": 2.3048164367675783, "target_mean": 2.2974461873372394}}}, "num_steps_sampled": 37000, "num_agent_steps_sampled": 37000, "num_steps_trained": 37000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 36920, "num_target_updates": 71}, "done": false, "episodes_total": 3700, "training_iteration": 37, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-16-06", "timestamp": 1648898166, "time_this_iter_s": 83.92295813560486, "time_total_s": 3058.3784165382385, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3058.3784165382385, "timesteps_since_restore": 1480, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 23.61583333333333, "ram_util_percent": 68.38833333333332}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": -1.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 10.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, -10.0, 10.0, 10.0, 0.0, 0.0, 0.0, -10.0, -20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -10.0, -20.0, 0.0, 20.0, -20.0, 0.0, 0.0, 10.0, 0.0, 0.0, -10.0, -20.0, 10.0, 20.0, 10.0, -10.0, -10.0, 0.0, -10.0, -20.0, 0.0, -10.0, -10.0, 0.0, 10.0, 0.0, -10.0, -10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 0.0, 10.0, 10.0, -10.0, 10.0, -10.0, 10.0, 20.0, -10.0, -10.0, 0.0, 0.0, 0.0, -10.0, 10.0, -10.0, 0.0, 0.0, -10.0, 10.0, -10.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 10.0, -10.0, -20.0, -10.0, 0.0, -20.0, -10.0, -20.0, 10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7386251746096267, "mean_inference_ms": 55.054337391664106, "mean_action_processing_ms": 0.22906263230185978, "mean_env_wait_ms": 0.16430039466550359, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 38000, "timesteps_this_iter": 40, "agent_timesteps_total": 38000, "timers": {"sample_time_ms": 3363.91, "sample_throughput": 11.891, "learn_time_ms": 2519.792, "learn_throughput": 15.874, "update_time_ms": 65.552}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.807947635650635, "grad_norm": 20.538440704345703, "td_error_abs": 1.5935834248860676, "q_taken_mean": 1.8134160359700522, "target_mean": 2.100740432739258}}}, "num_steps_sampled": 38000, "num_agent_steps_sampled": 38000, "num_steps_trained": 38000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 37960, "num_target_updates": 73}, "done": false, "episodes_total": 3800, "training_iteration": 38, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-17-31", "timestamp": 1648898251, "time_this_iter_s": 84.49484038352966, "time_total_s": 3142.873256921768, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3142.873256921768, "timesteps_since_restore": 1520, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 23.422314049586777, "ram_util_percent": 68.71157024793389}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": -2.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 0.0, 0.0, 10.0, -20.0, 0.0, -20.0, 10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 20.0, 10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 20.0, 0.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, 0.0, -20.0, -20.0, -10.0, 10.0, -20.0, 0.0, -10.0, 10.0, 0.0, 10.0, -10.0, -10.0, 0.0, 10.0, 10.0, -10.0, 10.0, 0.0, -20.0, 20.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, 10.0, -10.0, 0.0, -10.0, 0.0, -10.0, 0.0, -10.0, -20.0, 0.0, -10.0, 10.0, -10.0, 10.0, -10.0, -10.0, -10.0, 0.0, 10.0, -10.0, -20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, -20.0, 10.0, 10.0, -20.0, 10.0, -10.0, 0.0, -10.0, 0.0, -10.0, 10.0, 10.0, -20.0, 0.0, -20.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7389997986081613, "mean_inference_ms": 55.07288170697052, "mean_action_processing_ms": 0.22917472451861096, "mean_env_wait_ms": 0.1644262985356245, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 39000, "timesteps_this_iter": 40, "agent_timesteps_total": 39000, "timers": {"sample_time_ms": 3327.172, "sample_throughput": 12.022, "learn_time_ms": 2513.737, "learn_throughput": 15.913, "update_time_ms": 44.039}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.352024555206299, "grad_norm": 30.452402114868164, "td_error_abs": 1.3753514607747397, "q_taken_mean": 1.127748998006185, "target_mean": 1.5722972869873046}}}, "num_steps_sampled": 39000, "num_agent_steps_sampled": 39000, "num_steps_trained": 39000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 39000, "num_target_updates": 75}, "done": false, "episodes_total": 3900, "training_iteration": 39, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-18-56", "timestamp": 1648898336, "time_this_iter_s": 83.9984393119812, "time_total_s": 3226.8716962337494, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3226.8716962337494, "timesteps_since_restore": 1560, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 22.863333333333337, "ram_util_percent": 69.09750000000001}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": -1.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, 10.0, 0.0, -20.0, 10.0, -10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, -20.0, 0.0, 10.0, 20.0, 0.0, 0.0, -10.0, 10.0, -20.0, 0.0, -10.0, 0.0, 10.0, -10.0, -10.0, -10.0, -10.0, 10.0, 0.0, -10.0, 0.0, 0.0, -10.0, -10.0, 0.0, -10.0, 0.0, -10.0, -10.0, -10.0, 10.0, 10.0, -10.0, 0.0, 10.0, -20.0, 0.0, -20.0, -10.0, -10.0, 0.0, -10.0, 10.0, 0.0, 0.0, -10.0, -20.0, 0.0, 10.0, -10.0, 0.0, -10.0, -10.0, 20.0, 10.0, 0.0, -10.0, 0.0, -10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 10.0, -20.0, 10.0, -10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, -10.0, 0.0, 10.0, 10.0, -20.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7387355451237709, "mean_inference_ms": 55.054330745943425, "mean_action_processing_ms": 0.22910278018218683, "mean_env_wait_ms": 0.16435414311313923, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 40000, "timesteps_this_iter": 40, "agent_timesteps_total": 40000, "timers": {"sample_time_ms": 3323.854, "sample_throughput": 12.034, "learn_time_ms": 2496.314, "learn_throughput": 16.024, "update_time_ms": 44.204}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.181394577026367, "grad_norm": 11.715229034423828, "td_error_abs": 1.2938182830810547, "q_taken_mean": 1.4638991038004556, "target_mean": 1.3928858439127605}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 40000, "num_steps_trained": 40000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 39520, "num_target_updates": 76}, "done": false, "episodes_total": 4000, "training_iteration": 40, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-20-20", "timestamp": 1648898420, "time_this_iter_s": 83.56957483291626, "time_total_s": 3310.4412710666656, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3310.4412710666656, "timesteps_since_restore": 1600, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 22.98916666666667, "ram_util_percent": 69.35833333333333}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -3.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, -10.0, -10.0, 10.0, -20.0, -10.0, -10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -10.0, -20.0, -10.0, 0.0, -10.0, 10.0, 10.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, 0.0, -10.0, -10.0, -10.0, 10.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, -30.0, 10.0, 0.0, -10.0, -20.0, -10.0, 10.0, -20.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, -10.0, 10.0, -10.0, 0.0, 0.0, -10.0, -10.0, -10.0, 0.0, -10.0, -10.0, -10.0, 0.0, 0.0, 10.0, 0.0, -10.0, -10.0, -10.0, 0.0, 0.0, 10.0, 0.0, -20.0, -10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7389063556512244, "mean_inference_ms": 55.06931050395211, "mean_action_processing_ms": 0.22916212487530102, "mean_env_wait_ms": 0.16441125774858015, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 41000, "timesteps_this_iter": 40, "agent_timesteps_total": 41000, "timers": {"sample_time_ms": 3383.761, "sample_throughput": 11.821, "learn_time_ms": 2508.069, "learn_throughput": 15.949, "update_time_ms": 72.826}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.46508264541626, "grad_norm": 15.747523307800293, "td_error_abs": 1.6062981923421225, "q_taken_mean": 1.454291534423828, "target_mean": 1.5156295776367188}}}, "num_steps_sampled": 41000, "num_agent_steps_sampled": 41000, "num_steps_trained": 41000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 40560, "num_target_updates": 78}, "done": false, "episodes_total": 4100, "training_iteration": 41, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-21-45", "timestamp": 1648898505, "time_this_iter_s": 84.5940043926239, "time_total_s": 3395.0352754592896, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3395.0352754592896, "timesteps_since_restore": 1640, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 23.772131147540986, "ram_util_percent": 69.6450819672131}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": -3.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 10.0, 0.0, -10.0, 10.0, 10.0, -10.0, 0.0, -10.0, 10.0, -10.0, 0.0, 0.0, -30.0, 0.0, 0.0, 10.0, -10.0, -10.0, -10.0, 0.0, 0.0, 0.0, 20.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -10.0, -10.0, -10.0, -10.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -10.0, 0.0, -10.0, 0.0, -10.0, -10.0, 0.0, 10.0, 10.0, -20.0, 0.0, 0.0, 10.0, -20.0, 10.0, -10.0, -10.0, -10.0, 0.0, 0.0, -10.0, 0.0, -10.0, -10.0, -10.0, -20.0, 0.0, 10.0, -10.0, 10.0, 0.0, 0.0, -10.0, -20.0, 10.0, -10.0, 10.0, -20.0, 0.0, -10.0, -10.0, -10.0, -10.0, 0.0, -10.0, 0.0, 0.0, -10.0, 10.0, 0.0, 0.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7389963734616507, "mean_inference_ms": 55.062977470292246, "mean_action_processing_ms": 0.22942317620809496, "mean_env_wait_ms": 0.16439802225925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 42000, "timesteps_this_iter": 40, "agent_timesteps_total": 42000, "timers": {"sample_time_ms": 3415.13, "sample_throughput": 11.713, "learn_time_ms": 2556.545, "learn_throughput": 15.646, "update_time_ms": 68.445}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.84303092956543, "grad_norm": 15.234313011169434, "td_error_abs": 1.4273972829182944, "q_taken_mean": 1.5302525838216146, "target_mean": 1.3732649485270183}}}, "num_steps_sampled": 42000, "num_agent_steps_sampled": 42000, "num_steps_trained": 42000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 41600, "num_target_updates": 80}, "done": false, "episodes_total": 4200, "training_iteration": 42, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-23-11", "timestamp": 1648898591, "time_this_iter_s": 84.96186566352844, "time_total_s": 3479.997141122818, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3479.997141122818, "timesteps_since_restore": 1680, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 23.24297520661157, "ram_util_percent": 70.01239669421486}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": -1.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -10.0, 0.0, -10.0, 10.0, 10.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -10.0, 10.0, 0.0, -10.0, -20.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -10.0, -10.0, -10.0, 10.0, 10.0, 10.0, -10.0, -10.0, -10.0, 10.0, -10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, -20.0, -10.0, 10.0, -10.0, 10.0, 0.0, -10.0, 0.0, -20.0, 0.0, -10.0, 10.0, -20.0, -10.0, -10.0, 10.0, 0.0, -10.0, -10.0, -10.0, 20.0, -10.0, 20.0, -10.0, 0.0, 10.0, 0.0, -10.0, -10.0, 10.0, -20.0, 10.0, 0.0, -10.0, 0.0, 0.0, -10.0, 0.0, 10.0, -10.0, -10.0, 0.0, 0.0, 0.0, -20.0, -10.0, -10.0, 0.0, 0.0, -10.0, 10.0, 10.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7389518684835701, "mean_inference_ms": 55.06688921343568, "mean_action_processing_ms": 0.22948572729013314, "mean_env_wait_ms": 0.1644078448432821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 43000, "timesteps_this_iter": 40, "agent_timesteps_total": 43000, "timers": {"sample_time_ms": 3377.66, "sample_throughput": 11.843, "learn_time_ms": 2543.902, "learn_throughput": 15.724, "update_time_ms": 45.238}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.913134574890137, "grad_norm": 10.95371150970459, "td_error_abs": 1.6101202646891275, "q_taken_mean": 1.8651952107747396, "target_mean": 1.837408955891927}}}, "num_steps_sampled": 43000, "num_agent_steps_sampled": 43000, "num_steps_trained": 43000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 42640, "num_target_updates": 82}, "done": false, "episodes_total": 4300, "training_iteration": 43, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-24-35", "timestamp": 1648898675, "time_this_iter_s": 83.88668370246887, "time_total_s": 3563.883824825287, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3563.883824825287, "timesteps_since_restore": 1720, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 22.799999999999997, "ram_util_percent": 70.29338842975207}}
{"episode_reward_max": 10.0, "episode_reward_min": -30.0, "episode_reward_mean": -0.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 10.0, -10.0, -10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -10.0, 10.0, 0.0, 10.0, 0.0, 10.0, -10.0, 10.0, -10.0, 0.0, -10.0, 10.0, -10.0, 0.0, 10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 10.0, -10.0, 10.0, -30.0, 0.0, 0.0, -10.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -10.0, -20.0, -10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, -10.0, -10.0, 10.0, -10.0, 0.0, 10.0, 0.0, 10.0, 10.0, -10.0, -20.0, -20.0, -10.0, 10.0, -10.0, 0.0, -10.0, 0.0, -10.0, 10.0, 0.0, 0.0, -10.0, 10.0, 10.0, 0.0, -10.0, -10.0, 10.0, -10.0, 0.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7390612396865787, "mean_inference_ms": 55.066626122426726, "mean_action_processing_ms": 0.2295136039944716, "mean_env_wait_ms": 0.1644403834135334, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 44000, "timesteps_this_iter": 40, "agent_timesteps_total": 44000, "timers": {"sample_time_ms": 3390.887, "sample_throughput": 11.796, "learn_time_ms": 2543.5, "learn_throughput": 15.726, "update_time_ms": 73.208}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.825290203094482, "grad_norm": 31.95281410217285, "td_error_abs": 1.387415059407552, "q_taken_mean": 0.36872002283732097, "target_mean": 0.9584318161010742}}}, "num_steps_sampled": 44000, "num_agent_steps_sampled": 44000, "num_steps_trained": 44000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 43680, "num_target_updates": 84}, "done": false, "episodes_total": 4400, "training_iteration": 44, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-26-00", "timestamp": 1648898760, "time_this_iter_s": 84.81034541130066, "time_total_s": 3648.6941702365875, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3648.6941702365875, "timesteps_since_restore": 1760, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.529752066115705, "ram_util_percent": 70.59586776859503}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": -2.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 10.0, -20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -10.0, 0.0, -20.0, 10.0, -10.0, -10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, -20.0, 0.0, 10.0, -10.0, 0.0, 10.0, 0.0, -10.0, 0.0, 10.0, -10.0, 0.0, -10.0, 0.0, -10.0, 10.0, -20.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, -20.0, -20.0, 20.0, -20.0, -10.0, -10.0, -10.0, -20.0, 0.0, 10.0, -10.0, 10.0, 0.0, 0.0, 0.0, 10.0, -10.0, 0.0, -10.0, 0.0, -10.0, 0.0, -20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, -10.0, -20.0, -10.0, 0.0, -10.0, -20.0, -10.0, 0.0, -10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7390977223601175, "mean_inference_ms": 55.06467162296618, "mean_action_processing_ms": 0.22959505735042515, "mean_env_wait_ms": 0.1645099109103442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 45000, "timesteps_this_iter": 40, "agent_timesteps_total": 45000, "timers": {"sample_time_ms": 3387.285, "sample_throughput": 11.809, "learn_time_ms": 2563.149, "learn_throughput": 15.606, "update_time_ms": 54.257}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.821945667266846, "grad_norm": 15.406009674072266, "td_error_abs": 1.3770650227864583, "q_taken_mean": 1.3254845937093098, "target_mean": 1.3980271657307943}}}, "num_steps_sampled": 45000, "num_agent_steps_sampled": 45000, "num_steps_trained": 45000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 44720, "num_target_updates": 86}, "done": false, "episodes_total": 4500, "training_iteration": 45, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-27-25", "timestamp": 1648898845, "time_this_iter_s": 84.78066325187683, "time_total_s": 3733.4748334884644, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3733.4748334884644, "timesteps_since_restore": 1800, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 23.568032786885247, "ram_util_percent": 70.89590163934425}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": -1.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 10.0, -20.0, -10.0, 10.0, 0.0, -20.0, -10.0, -10.0, -10.0, -10.0, -10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, -10.0, 10.0, -20.0, -20.0, 0.0, -10.0, 10.0, -20.0, 10.0, 10.0, 0.0, 10.0, -10.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -10.0, -10.0, -10.0, -10.0, 0.0, -20.0, 0.0, -10.0, 0.0, 0.0, -10.0, 0.0, -10.0, -10.0, 0.0, -10.0, 0.0, -10.0, 0.0, 0.0, -20.0, 0.0, 10.0, -10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -10.0, -10.0, -10.0, 10.0, -10.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 10.0, 10.0, -20.0, 0.0, 0.0, 10.0, 0.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7389478917308873, "mean_inference_ms": 55.051372047300255, "mean_action_processing_ms": 0.22957733574872136, "mean_env_wait_ms": 0.1644704167961649, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 46000, "timesteps_this_iter": 40, "agent_timesteps_total": 46000, "timers": {"sample_time_ms": 3367.674, "sample_throughput": 11.878, "learn_time_ms": 2522.736, "learn_throughput": 15.856, "update_time_ms": 71.509}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 2.896287441253662, "grad_norm": 10.99172306060791, "td_error_abs": 0.953048578898112, "q_taken_mean": 0.773809305826823, "target_mean": 0.7512257893880209}}}, "num_steps_sampled": 46000, "num_agent_steps_sampled": 46000, "num_steps_trained": 46000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 45760, "num_target_updates": 88}, "done": false, "episodes_total": 4600, "training_iteration": 46, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-28-50", "timestamp": 1648898930, "time_this_iter_s": 84.51686263084412, "time_total_s": 3817.9916961193085, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3817.9916961193085, "timesteps_since_restore": 1840, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 23.05289256198347, "ram_util_percent": 71.13140495867769}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 1.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 0.0, -10.0, 10.0, 10.0, 0.0, -10.0, 10.0, 0.0, -10.0, -10.0, 0.0, 0.0, -10.0, -10.0, -10.0, 0.0, 0.0, -20.0, -10.0, 0.0, 20.0, 20.0, -10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 10.0, -10.0, 0.0, -10.0, -10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, -10.0, 10.0, 0.0, -20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -20.0, 0.0, 20.0, 10.0, 10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -20.0, -10.0, 10.0, -20.0, 20.0, 0.0, -10.0, 0.0, 0.0, 20.0, 10.0, -20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7388927958669204, "mean_inference_ms": 55.04259894973785, "mean_action_processing_ms": 0.22952844311192586, "mean_env_wait_ms": 0.16447370909151243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 47000, "timesteps_this_iter": 40, "agent_timesteps_total": 47000, "timers": {"sample_time_ms": 3387.933, "sample_throughput": 11.807, "learn_time_ms": 2552.316, "learn_throughput": 15.672, "update_time_ms": 85.298}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.306902885437012, "grad_norm": 18.538841247558594, "td_error_abs": 1.5711421966552734, "q_taken_mean": 1.2606258392333984, "target_mean": 1.2483932495117187}}}, "num_steps_sampled": 47000, "num_agent_steps_sampled": 47000, "num_steps_trained": 47000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 46800, "num_target_updates": 90}, "done": false, "episodes_total": 4700, "training_iteration": 47, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-30-15", "timestamp": 1648899015, "time_this_iter_s": 84.54635739326477, "time_total_s": 3902.5380535125732, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3902.5380535125732, "timesteps_since_restore": 1880, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 23.02892561983471, "ram_util_percent": 71.4099173553719}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 1.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, -10.0, 10.0, -20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, -20.0, 10.0, 10.0, 10.0, 10.0, -10.0, 0.0, -20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, -20.0, 20.0, -10.0, 0.0, -10.0, -10.0, -10.0, 0.0, -10.0, 10.0, 10.0, 10.0, 0.0, -10.0, -10.0, 10.0, -10.0, 10.0, -20.0, 0.0, 0.0, -10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, -10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, -10.0, 20.0, -10.0, 10.0, -10.0, -20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7387104506055945, "mean_inference_ms": 55.02166958930402, "mean_action_processing_ms": 0.2294124518719407, "mean_env_wait_ms": 0.16439794927882648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 48000, "timesteps_this_iter": 40, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 3371.339, "sample_throughput": 11.865, "learn_time_ms": 2549.869, "learn_throughput": 15.687, "update_time_ms": 63.553}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.834408760070801, "grad_norm": 29.393869400024414, "td_error_abs": 1.3978982289632162, "q_taken_mean": 0.8927581151326497, "target_mean": 1.4603922526041666}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 48000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 47840, "num_target_updates": 92}, "done": false, "episodes_total": 4800, "training_iteration": 48, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-31-40", "timestamp": 1648899100, "time_this_iter_s": 83.92314720153809, "time_total_s": 3986.4612007141113, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3986.4612007141113, "timesteps_since_restore": 1920, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 23.111666666666665, "ram_util_percent": 71.8225}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": -1.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, 10.0, -10.0, 0.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -10.0, 0.0, -10.0, -10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -10.0, -10.0, -10.0, 0.0, -20.0, 10.0, 10.0, 0.0, 10.0, -10.0, 0.0, -20.0, 0.0, 0.0, -10.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, -20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, -10.0, -10.0, -10.0, -10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 10.0, 10.0, -10.0, 10.0, 0.0, -10.0, -20.0, 0.0, -10.0, 0.0, 0.0, 0.0, -10.0, -10.0, 10.0, 0.0, 10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7383547630244669, "mean_inference_ms": 54.99184095132656, "mean_action_processing_ms": 0.22932093792103356, "mean_env_wait_ms": 0.16428797442167117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 49000, "timesteps_this_iter": 40, "agent_timesteps_total": 49000, "timers": {"sample_time_ms": 3349.161, "sample_throughput": 11.943, "learn_time_ms": 2503.386, "learn_throughput": 15.978, "update_time_ms": 63.493}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.130048751831055, "grad_norm": 16.77699089050293, "td_error_abs": 1.6687786102294921, "q_taken_mean": 1.8016501108805338, "target_mean": 2.019275410970052}}}, "num_steps_sampled": 49000, "num_agent_steps_sampled": 49000, "num_steps_trained": 49000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 48880, "num_target_updates": 94}, "done": false, "episodes_total": 4900, "training_iteration": 49, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-33-03", "timestamp": 1648899183, "time_this_iter_s": 82.91513442993164, "time_total_s": 4069.376335144043, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4069.376335144043, "timesteps_since_restore": 1960, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 23.118487394957985, "ram_util_percent": 72.10420168067226}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 0.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 0.0, 10.0, -20.0, -10.0, 0.0, 0.0, -10.0, 0.0, 0.0, -10.0, -10.0, 0.0, -10.0, 0.0, -10.0, 10.0, 0.0, -10.0, -10.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -10.0, -20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -10.0, 0.0, 0.0, -10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, -10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, -20.0, -20.0, 10.0, 0.0, -10.0, -10.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -20.0, 10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7383046307741915, "mean_inference_ms": 54.98506738017934, "mean_action_processing_ms": 0.22928896507981505, "mean_env_wait_ms": 0.16430004359569444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 50000, "timesteps_this_iter": 40, "agent_timesteps_total": 50000, "timers": {"sample_time_ms": 3399.762, "sample_throughput": 11.766, "learn_time_ms": 2492.746, "learn_throughput": 16.047, "update_time_ms": 101.31}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.100300312042236, "grad_norm": 19.393301010131836, "td_error_abs": 1.5848480224609376, "q_taken_mean": 1.1107816060384115, "target_mean": 1.3133827209472657}}}, "num_steps_sampled": 50000, "num_agent_steps_sampled": 50000, "num_steps_trained": 50000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 49920, "num_target_updates": 96}, "done": false, "episodes_total": 5000, "training_iteration": 50, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-34-28", "timestamp": 1648899268, "time_this_iter_s": 84.35964608192444, "time_total_s": 4153.735981225967, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4153.735981225967, "timesteps_since_restore": 2000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 23.132231404958677, "ram_util_percent": 72.4380165289256}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 2.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 20.0, 0.0, -10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -10.0, 10.0, 0.0, 10.0, 10.0, -10.0, 0.0, 10.0, 20.0, 0.0, -10.0, 0.0, 20.0, -10.0, 10.0, 0.0, -10.0, 0.0, -10.0, -10.0, 0.0, 10.0, 0.0, 10.0, 10.0, -20.0, -10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, -10.0, 0.0, -10.0, 0.0, 10.0, 10.0, -20.0, -20.0, 10.0, 0.0, -10.0, 0.0, -10.0, 10.0, 20.0, 0.0, -10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7380911503835857, "mean_inference_ms": 54.96803403564477, "mean_action_processing_ms": 0.22919559355352767, "mean_env_wait_ms": 0.16422191700947703, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 51000, "timesteps_this_iter": 40, "agent_timesteps_total": 51000, "timers": {"sample_time_ms": 3360.03, "sample_throughput": 11.905, "learn_time_ms": 2509.023, "learn_throughput": 15.942, "update_time_ms": 60.391}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.808861255645752, "grad_norm": 12.651556015014648, "td_error_abs": 1.7130200703938803, "q_taken_mean": 0.9962395350138347, "target_mean": 1.1036590576171874}}}, "num_steps_sampled": 51000, "num_agent_steps_sampled": 51000, "num_steps_trained": 51000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 50960, "num_target_updates": 98}, "done": false, "episodes_total": 5100, "training_iteration": 51, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-35-52", "timestamp": 1648899352, "time_this_iter_s": 83.87193703651428, "time_total_s": 4237.607918262482, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4237.607918262482, "timesteps_since_restore": 2040, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 23.072499999999998, "ram_util_percent": 72.7}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 1.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -10.0, -10.0, -10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, -10.0, 10.0, -10.0, -10.0, 10.0, 10.0, 20.0, -10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, -10.0, -10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 10.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, -10.0, 10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, -10.0, 0.0, -10.0, -10.0, 10.0, 0.0, 10.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -10.0, 10.0, 0.0, 10.0, 10.0, -20.0, -10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7378019724302258, "mean_inference_ms": 54.95165814877328, "mean_action_processing_ms": 0.22912511421381423, "mean_env_wait_ms": 0.16418422389861187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 52000, "timesteps_this_iter": 40, "agent_timesteps_total": 52000, "timers": {"sample_time_ms": 3376.809, "sample_throughput": 11.846, "learn_time_ms": 2540.931, "learn_throughput": 15.742, "update_time_ms": 54.466}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.748425006866455, "grad_norm": 15.550341606140137, "td_error_abs": 1.8747728983561198, "q_taken_mean": 1.0464425404866537, "target_mean": 1.2142078399658203}}}, "num_steps_sampled": 52000, "num_agent_steps_sampled": 52000, "num_steps_trained": 52000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 52000, "num_target_updates": 100}, "done": false, "episodes_total": 5200, "training_iteration": 52, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-37-17", "timestamp": 1648899437, "time_this_iter_s": 83.83060622215271, "time_total_s": 4321.438524484634, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4321.438524484634, "timesteps_since_restore": 2080, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 23.079166666666666, "ram_util_percent": 73.01583333333332}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": 2.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 10.0, 10.0, 10.0, 0.0, -30.0, 10.0, -10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, 0.0, 20.0, 0.0, 0.0, 0.0, -10.0, 10.0, -10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, -10.0, 10.0, 0.0, 0.0, 10.0, -10.0, -10.0, 10.0, -10.0, -20.0, 10.0, 10.0, 0.0, -10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, -20.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, -10.0, 10.0, -10.0, -10.0, 0.0, 10.0, 0.0, 10.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7374344722395726, "mean_inference_ms": 54.93957788914915, "mean_action_processing_ms": 0.22907131942260786, "mean_env_wait_ms": 0.1641285571500712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 53000, "timesteps_this_iter": 40, "agent_timesteps_total": 53000, "timers": {"sample_time_ms": 3331.069, "sample_throughput": 12.008, "learn_time_ms": 2479.945, "learn_throughput": 16.129, "update_time_ms": 67.869}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.368810653686523, "grad_norm": 18.573272705078125, "td_error_abs": 1.5065048217773438, "q_taken_mean": 1.632983144124349, "target_mean": 1.515057118733724}}}, "num_steps_sampled": 53000, "num_agent_steps_sampled": 53000, "num_steps_trained": 53000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 52520, "num_target_updates": 101}, "done": false, "episodes_total": 5300, "training_iteration": 53, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-38-41", "timestamp": 1648899521, "time_this_iter_s": 83.8074278831482, "time_total_s": 4405.245952367783, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4405.245952367783, "timesteps_since_restore": 2120, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 23.14333333333333, "ram_util_percent": 73.34333333333333}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 2.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -10.0, -10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, -10.0, 0.0, 0.0, -10.0, 0.0, 10.0, 20.0, 10.0, 10.0, -10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, -10.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, 10.0, 20.0, 10.0, -10.0, 10.0, -10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, 10.0, -10.0, -10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, -10.0, -10.0, 0.0, -10.0, 10.0, 20.0, 0.0, -20.0, 10.0, -20.0, -10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, -10.0, -10.0, -20.0, -10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7371218078587286, "mean_inference_ms": 54.900690989356235, "mean_action_processing_ms": 0.22897796448615104, "mean_env_wait_ms": 0.16409804155081167, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 54000, "timesteps_this_iter": 40, "agent_timesteps_total": 54000, "timers": {"sample_time_ms": 3382.517, "sample_throughput": 11.826, "learn_time_ms": 2541.163, "learn_throughput": 15.741, "update_time_ms": 79.302}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.21471118927002, "grad_norm": 31.579090118408203, "td_error_abs": 1.719579823811849, "q_taken_mean": 1.1694257100423178, "target_mean": 1.6328877766927083}}}, "num_steps_sampled": 54000, "num_agent_steps_sampled": 54000, "num_steps_trained": 54000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 53560, "num_target_updates": 103}, "done": false, "episodes_total": 5400, "training_iteration": 54, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-40-06", "timestamp": 1648899606, "time_this_iter_s": 84.60081553459167, "time_total_s": 4489.846767902374, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4489.846767902374, "timesteps_since_restore": 2160, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 23.70743801652893, "ram_util_percent": 73.68925619834711}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 1.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -10.0, 0.0, 0.0, 10.0, -10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, -10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, -10.0, 0.0, -10.0, 10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -10.0, 10.0, -10.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, -20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, -20.0, 10.0, -10.0, -10.0, 0.0, 0.0, 10.0, 10.0, 20.0, -10.0, -10.0, -10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 10.0, 10.0, 20.0, 0.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7364293868546398, "mean_inference_ms": 54.83861541619743, "mean_action_processing_ms": 0.2287466667685176, "mean_env_wait_ms": 0.1639487067011693, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 55000, "timesteps_this_iter": 40, "agent_timesteps_total": 55000, "timers": {"sample_time_ms": 3388.722, "sample_throughput": 11.804, "learn_time_ms": 2554.268, "learn_throughput": 15.66, "update_time_ms": 64.091}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.185638427734375, "grad_norm": 21.157089233398438, "td_error_abs": 1.7168323516845703, "q_taken_mean": 1.8493542989095053, "target_mean": 1.5179400126139322}}}, "num_steps_sampled": 55000, "num_agent_steps_sampled": 55000, "num_steps_trained": 55000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 54600, "num_target_updates": 105}, "done": false, "episodes_total": 5500, "training_iteration": 55, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-41-30", "timestamp": 1648899690, "time_this_iter_s": 83.85814452171326, "time_total_s": 4573.7049124240875, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4573.7049124240875, "timesteps_since_restore": 2200, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 23.167500000000004, "ram_util_percent": 73.98083333333331}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 3.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, -10.0, 10.0, 0.0, -10.0, 10.0, -10.0, 10.0, 10.0, 10.0, 20.0, -10.0, 20.0, 0.0, 0.0, 0.0, -10.0, 0.0, 10.0, 0.0, 30.0, 0.0, -10.0, -10.0, -10.0, -10.0, 10.0, -10.0, 10.0, 0.0, -10.0, 10.0, 0.0, 10.0, -10.0, 0.0, 10.0, 20.0, 0.0, -10.0, 0.0, 20.0, 0.0, 0.0, 20.0, -10.0, 20.0, 0.0, 0.0, 20.0, 10.0, 20.0, -10.0, 30.0, 10.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, -20.0, 0.0, -10.0, 10.0, 0.0, 10.0, 0.0, 0.0, -10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7357843117529679, "mean_inference_ms": 54.788039306361085, "mean_action_processing_ms": 0.22855241608086702, "mean_env_wait_ms": 0.1638222656865757, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 56000, "timesteps_this_iter": 40, "agent_timesteps_total": 56000, "timers": {"sample_time_ms": 3326.953, "sample_throughput": 12.023, "learn_time_ms": 2493.712, "learn_throughput": 16.04, "update_time_ms": 84.159}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.791696548461914, "grad_norm": 20.453533172607422, "td_error_abs": 1.607624308268229, "q_taken_mean": 1.5096115112304687, "target_mean": 1.261768595377604}}}, "num_steps_sampled": 56000, "num_agent_steps_sampled": 56000, "num_steps_trained": 56000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 55640, "num_target_updates": 107}, "done": false, "episodes_total": 5600, "training_iteration": 56, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-42-54", "timestamp": 1648899774, "time_this_iter_s": 83.1076111793518, "time_total_s": 4656.812523603439, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4656.812523603439, "timesteps_since_restore": 2240, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 22.842016806722686, "ram_util_percent": 74.3361344537815}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 2.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, -10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, -10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 10.0, 0.0, -10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, -10.0, 10.0, 10.0, 20.0, 10.0, 10.0, -10.0, 0.0, -10.0, 0.0, -10.0, 10.0, -20.0, 20.0, 0.0, 20.0, 10.0, -10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -20.0, 0.0, -20.0, 20.0, 0.0, 10.0, -10.0, -10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, -20.0, 10.0, -10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7351983447600542, "mean_inference_ms": 54.74492738760695, "mean_action_processing_ms": 0.22835847277631593, "mean_env_wait_ms": 0.16369914834553395, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 57000, "timesteps_this_iter": 40, "agent_timesteps_total": 57000, "timers": {"sample_time_ms": 3322.165, "sample_throughput": 12.04, "learn_time_ms": 2525.952, "learn_throughput": 15.836, "update_time_ms": 57.87}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.35963773727417, "grad_norm": 15.940027236938477, "td_error_abs": 1.6937802632649739, "q_taken_mean": 0.7809135437011718, "target_mean": 0.809808858235677}}}, "num_steps_sampled": 57000, "num_agent_steps_sampled": 57000, "num_steps_trained": 57000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 56680, "num_target_updates": 109}, "done": false, "episodes_total": 5700, "training_iteration": 57, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-44-18", "timestamp": 1648899858, "time_this_iter_s": 83.66766166687012, "time_total_s": 4740.480185270309, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4740.480185270309, "timesteps_since_restore": 2280, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 23.5, "ram_util_percent": 74.62333333333332}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 2.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 10.0, 10.0, 10.0, 10.0, 10.0, -10.0, 10.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -10.0, 10.0, -10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 0.0, -10.0, 20.0, 10.0, 10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 10.0, 0.0, 0.0, 0.0, -10.0, 10.0, -20.0, 10.0, 0.0, 10.0, -10.0, -10.0, 0.0, 20.0, 0.0, 0.0, -10.0, 0.0, 10.0, -10.0, -10.0, -10.0, 10.0, 0.0, 10.0, 0.0, -10.0, 10.0, -10.0, 0.0, 0.0, -10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, -10.0, 10.0, 10.0, -10.0, -10.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7345615752885508, "mean_inference_ms": 54.69611424609271, "mean_action_processing_ms": 0.22817653554462994, "mean_env_wait_ms": 0.1635480301929798, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 58000, "timesteps_this_iter": 40, "agent_timesteps_total": 58000, "timers": {"sample_time_ms": 3334.914, "sample_throughput": 11.994, "learn_time_ms": 2498.652, "learn_throughput": 16.009, "update_time_ms": 61.939}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.839422225952148, "grad_norm": 19.09895896911621, "td_error_abs": 1.7800551096598307, "q_taken_mean": 0.9090043385823567, "target_mean": 1.122057596842448}}}, "num_steps_sampled": 58000, "num_agent_steps_sampled": 58000, "num_steps_trained": 58000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 57720, "num_target_updates": 111}, "done": false, "episodes_total": 5800, "training_iteration": 58, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-45-42", "timestamp": 1648899942, "time_this_iter_s": 83.4912121295929, "time_total_s": 4823.971397399902, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4823.971397399902, "timesteps_since_restore": 2320, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 23.600833333333338, "ram_util_percent": 74.87333333333332}}
{"episode_reward_max": 20.0, "episode_reward_min": -10.0, "episode_reward_mean": 4.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 10.0, -10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 0.0, 10.0, 20.0, -10.0, 20.0, 0.0, -10.0, 10.0, -10.0, -10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, -10.0, 10.0, -10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7338365347342898, "mean_inference_ms": 54.6436012255912, "mean_action_processing_ms": 0.2279899320912098, "mean_env_wait_ms": 0.16338469157678928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 59000, "timesteps_this_iter": 40, "agent_timesteps_total": 59000, "timers": {"sample_time_ms": 3328.206, "sample_throughput": 12.018, "learn_time_ms": 2486.698, "learn_throughput": 16.086, "update_time_ms": 73.123}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.289612770080566, "grad_norm": 11.696639060974121, "td_error_abs": 1.6278717041015625, "q_taken_mean": 2.6218231201171873, "target_mean": 2.6446690877278645}}}, "num_steps_sampled": 59000, "num_agent_steps_sampled": 59000, "num_steps_trained": 59000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 58760, "num_target_updates": 113}, "done": false, "episodes_total": 5900, "training_iteration": 59, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-47-05", "timestamp": 1648900025, "time_this_iter_s": 83.28718376159668, "time_total_s": 4907.258581161499, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4907.258581161499, "timesteps_since_restore": 2360, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 22.988235294117647, "ram_util_percent": 75.20084033613446}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 5.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, -10.0, 10.0, 20.0, 10.0, -10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, -10.0, 0.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 10.0, -10.0, 0.0, -20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, -10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, -20.0, 0.0, 0.0, 10.0, 20.0, -10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 20.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7330101534935817, "mean_inference_ms": 54.59288539635995, "mean_action_processing_ms": 0.22780213401473517, "mean_env_wait_ms": 0.16323758493971088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 60000, "timesteps_this_iter": 40, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 3341.352, "sample_throughput": 11.971, "learn_time_ms": 2496.809, "learn_throughput": 16.02, "update_time_ms": 57.947}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.46833610534668, "grad_norm": 26.753969192504883, "td_error_abs": 2.0417935689290365, "q_taken_mean": 2.2436434427897134, "target_mean": 2.187824249267578}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 59800, "num_target_updates": 115}, "done": false, "episodes_total": 6000, "training_iteration": 60, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-48-29", "timestamp": 1648900109, "time_this_iter_s": 83.3131194114685, "time_total_s": 4990.5717005729675, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 4990.5717005729675, "timesteps_since_restore": 2400, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 23.342857142857145, "ram_util_percent": 75.50924369747898}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 6.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 20.0, 0.0, 0.0, 0.0, -10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 30.0, 10.0, -20.0, 0.0, 0.0, -10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 10.0, -10.0, 10.0, 0.0, 10.0, 10.0, 10.0, -10.0, -10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -10.0, 20.0, 0.0, 0.0, -10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7323685938956647, "mean_inference_ms": 54.5427783201049, "mean_action_processing_ms": 0.22760351543215163, "mean_env_wait_ms": 0.16309825578804257, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 61000, "timesteps_this_iter": 40, "agent_timesteps_total": 61000, "timers": {"sample_time_ms": 3347.274, "sample_throughput": 11.95, "learn_time_ms": 2490.663, "learn_throughput": 16.06, "update_time_ms": 72.414}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.3697381019592285, "grad_norm": 14.043645858764648, "td_error_abs": 1.4651685078938803, "q_taken_mean": 1.943610636393229, "target_mean": 1.9069100697835286}}}, "num_steps_sampled": 61000, "num_agent_steps_sampled": 61000, "num_steps_trained": 61000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 60840, "num_target_updates": 117}, "done": false, "episodes_total": 6100, "training_iteration": 61, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-49-53", "timestamp": 1648900193, "time_this_iter_s": 83.62873888015747, "time_total_s": 5074.200439453125, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5074.200439453125, "timesteps_since_restore": 2440, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 23.14, "ram_util_percent": 75.74916666666668}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 4.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, -10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, -10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, -10.0, 20.0, 0.0, -10.0, -10.0, 0.0, 10.0, 20.0, -20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, -10.0, 0.0, -10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, -10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -10.0, -10.0, 20.0, 10.0, 10.0, 10.0, 10.0, -10.0, 20.0, 10.0, -10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7319135532387765, "mean_inference_ms": 54.493770919440756, "mean_action_processing_ms": 0.22743167157988656, "mean_env_wait_ms": 0.16299702415050413, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 62000, "timesteps_this_iter": 40, "agent_timesteps_total": 62000, "timers": {"sample_time_ms": 3370.677, "sample_throughput": 11.867, "learn_time_ms": 2534.529, "learn_throughput": 15.782, "update_time_ms": 74.198}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.308969974517822, "grad_norm": 18.9872989654541, "td_error_abs": 1.257546361287435, "q_taken_mean": 2.478401947021484, "target_mean": 2.2122205098470054}}}, "num_steps_sampled": 62000, "num_agent_steps_sampled": 62000, "num_steps_trained": 62000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 61880, "num_target_updates": 119}, "done": false, "episodes_total": 6200, "training_iteration": 62, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-51-17", "timestamp": 1648900277, "time_this_iter_s": 83.6196596622467, "time_total_s": 5157.820099115372, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5157.820099115372, "timesteps_since_restore": 2480, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 23.105833333333333, "ram_util_percent": 76.08583333333333}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 4.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 0.0, 0.0, 0.0, -10.0, 10.0, 10.0, 10.0, 20.0, 0.0, -10.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, 10.0, 10.0, 0.0, -10.0, 0.0, 0.0, -10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, -10.0, -10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, -10.0, 10.0, 10.0, -10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, -10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, -10.0, 0.0, -20.0, 0.0, 10.0, 0.0, -10.0, 0.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7316508328571797, "mean_inference_ms": 54.47946505413067, "mean_action_processing_ms": 0.22737199666348573, "mean_env_wait_ms": 0.16296876361578824, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 63000, "timesteps_this_iter": 40, "agent_timesteps_total": 63000, "timers": {"sample_time_ms": 3314.151, "sample_throughput": 12.069, "learn_time_ms": 2472.992, "learn_throughput": 16.175, "update_time_ms": 59.221}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.703080177307129, "grad_norm": 16.29378890991211, "td_error_abs": 1.834496307373047, "q_taken_mean": 1.0982667287190755, "target_mean": 1.2390944163004558}}}, "num_steps_sampled": 63000, "num_agent_steps_sampled": 63000, "num_steps_trained": 63000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 62920, "num_target_updates": 121}, "done": false, "episodes_total": 6300, "training_iteration": 63, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-52-41", "timestamp": 1648900361, "time_this_iter_s": 83.33078980445862, "time_total_s": 5241.15088891983, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5241.15088891983, "timesteps_since_restore": 2520, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 23.289075630252107, "ram_util_percent": 76.33781512605042}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 5.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, -10.0, -10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 10.0, -10.0, 10.0, 10.0, 10.0, -10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, -10.0, 0.0, -20.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, -10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, -10.0, 0.0, -10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7317593549014731, "mean_inference_ms": 54.47793165956928, "mean_action_processing_ms": 0.2273957391551387, "mean_env_wait_ms": 0.16297684871482146, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 64000, "timesteps_this_iter": 40, "agent_timesteps_total": 64000, "timers": {"sample_time_ms": 3395.841, "sample_throughput": 11.779, "learn_time_ms": 2500.497, "learn_throughput": 15.997, "update_time_ms": 90.641}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.844915866851807, "grad_norm": 17.965717315673828, "td_error_abs": 1.718450164794922, "q_taken_mean": 2.006712214152018, "target_mean": 2.266423543294271}}}, "num_steps_sampled": 64000, "num_agent_steps_sampled": 64000, "num_steps_trained": 64000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 63960, "num_target_updates": 123}, "done": false, "episodes_total": 6400, "training_iteration": 64, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-54-06", "timestamp": 1648900446, "time_this_iter_s": 84.21064901351929, "time_total_s": 5325.36153793335, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5325.36153793335, "timesteps_since_restore": 2560, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 23.420661157024796, "ram_util_percent": 76.65867768595042}}
{"episode_reward_max": 20.0, "episode_reward_min": -30.0, "episode_reward_mean": 5.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, -20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, -20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, -10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, -10.0, -30.0, 10.0, -10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.731337595687236, "mean_inference_ms": 54.44931071044172, "mean_action_processing_ms": 0.22727665875656516, "mean_env_wait_ms": 0.16288123243178276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 65000, "timesteps_this_iter": 40, "agent_timesteps_total": 65000, "timers": {"sample_time_ms": 3357.024, "sample_throughput": 11.915, "learn_time_ms": 2500.609, "learn_throughput": 15.996, "update_time_ms": 75.039}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.38623046875, "grad_norm": 19.83031463623047, "td_error_abs": 1.8523220062255858, "q_taken_mean": 2.322779337565104, "target_mean": 2.110905965169271}}}, "num_steps_sampled": 65000, "num_agent_steps_sampled": 65000, "num_steps_trained": 65000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 65000, "num_target_updates": 125}, "done": false, "episodes_total": 6500, "training_iteration": 65, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-55-30", "timestamp": 1648900530, "time_this_iter_s": 83.6026542186737, "time_total_s": 5408.964192152023, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5408.964192152023, "timesteps_since_restore": 2600, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 23.730833333333337, "ram_util_percent": 77.0}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 5.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -10.0, 20.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, -10.0, 0.0, 10.0, -20.0, 0.0, 10.0, 10.0, 0.0, -10.0, 0.0, -10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, -10.0, 10.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 20.0, 0.0, -10.0, 10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 10.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7306920543640831, "mean_inference_ms": 54.402631692081265, "mean_action_processing_ms": 0.22709181825866562, "mean_env_wait_ms": 0.1627561085354624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 66000, "timesteps_this_iter": 40, "agent_timesteps_total": 66000, "timers": {"sample_time_ms": 3307.192, "sample_throughput": 12.095, "learn_time_ms": 2459.927, "learn_throughput": 16.261, "update_time_ms": 79.948}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.853315830230713, "grad_norm": 9.018863677978516, "td_error_abs": 1.8101201375325522, "q_taken_mean": 2.1447298685709635, "target_mean": 2.1786092122395835}}}, "num_steps_sampled": 66000, "num_agent_steps_sampled": 66000, "num_steps_trained": 66000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 65520, "num_target_updates": 126}, "done": false, "episodes_total": 6600, "training_iteration": 66, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-56-53", "timestamp": 1648900613, "time_this_iter_s": 82.49142527580261, "time_total_s": 5491.455617427826, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5491.455617427826, "timesteps_since_restore": 2640, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 22.93983050847457, "ram_util_percent": 77.1}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 6.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, -10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, -10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, -20.0, -10.0, 30.0, -10.0, 0.0, 0.0, -10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, -10.0, -10.0, 20.0, 0.0, 10.0, -10.0, 10.0, 10.0, 10.0, 0.0, -10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 0.0, 30.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7304125782639425, "mean_inference_ms": 54.377928579909, "mean_action_processing_ms": 0.22704166751442778, "mean_env_wait_ms": 0.16274009773705753, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 67000, "timesteps_this_iter": 40, "agent_timesteps_total": 67000, "timers": {"sample_time_ms": 3338.561, "sample_throughput": 11.981, "learn_time_ms": 2517.302, "learn_throughput": 15.89, "update_time_ms": 61.536}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.35476016998291, "grad_norm": 19.424942016601562, "td_error_abs": 1.5028709411621093, "q_taken_mean": 1.7284772237141928, "target_mean": 1.6136819203694661}}}, "num_steps_sampled": 67000, "num_agent_steps_sampled": 67000, "num_steps_trained": 67000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 66560, "num_target_updates": 128}, "done": false, "episodes_total": 6700, "training_iteration": 67, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-58-17", "timestamp": 1648900697, "time_this_iter_s": 83.5394995212555, "time_total_s": 5574.995116949081, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5574.995116949081, "timesteps_since_restore": 2680, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 23.473949579831935, "ram_util_percent": 77.51512605042018}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 7.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, -10.0, 10.0, -10.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, -10.0, 10.0, 10.0, 10.0, -10.0, -10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, -10.0, 20.0, 0.0, -10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, -10.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7306496070894127, "mean_inference_ms": 54.37849135014893, "mean_action_processing_ms": 0.227053315069709, "mean_env_wait_ms": 0.16274893818851865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 68000, "timesteps_this_iter": 40, "agent_timesteps_total": 68000, "timers": {"sample_time_ms": 3407.593, "sample_throughput": 11.738, "learn_time_ms": 2520.091, "learn_throughput": 15.872, "update_time_ms": 71.034}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.8801445960998535, "grad_norm": 20.846811294555664, "td_error_abs": 1.8202901204427084, "q_taken_mean": 3.0691744486490884, "target_mean": 2.9477742513020835}}}, "num_steps_sampled": 68000, "num_agent_steps_sampled": 68000, "num_steps_trained": 68000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 67600, "num_target_updates": 130}, "done": false, "episodes_total": 6800, "training_iteration": 68, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_04-59-41", "timestamp": 1648900781, "time_this_iter_s": 84.35089254379272, "time_total_s": 5659.346009492874, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5659.346009492874, "timesteps_since_restore": 2720, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 23.578512396694215, "ram_util_percent": 77.81818181818181}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 6.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, -20.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, -10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, -10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, -10.0, 10.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7302885566626509, "mean_inference_ms": 54.342010181390066, "mean_action_processing_ms": 0.22691663441661614, "mean_env_wait_ms": 0.16264467058054058, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 69000, "timesteps_this_iter": 40, "agent_timesteps_total": 69000, "timers": {"sample_time_ms": 3304.13, "sample_throughput": 12.106, "learn_time_ms": 2483.899, "learn_throughput": 16.104, "update_time_ms": 63.396}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.841635704040527, "grad_norm": 21.924251556396484, "td_error_abs": 2.018783187866211, "q_taken_mean": 2.2209213256835936, "target_mean": 1.9507918039957681}}}, "num_steps_sampled": 69000, "num_agent_steps_sampled": 69000, "num_steps_trained": 69000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 68640, "num_target_updates": 132}, "done": false, "episodes_total": 6900, "training_iteration": 69, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-01-05", "timestamp": 1648900865, "time_this_iter_s": 82.77306270599365, "time_total_s": 5742.119072198868, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5742.119072198868, "timesteps_since_restore": 2760, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 22.994117647058825, "ram_util_percent": 78.30168067226894}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 8.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 10.0, 10.0, 0.0, 10.0, 0.0, -10.0, 20.0, -10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, -10.0, 20.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 10.0, -20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, -10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, -10.0, -10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7300342289313376, "mean_inference_ms": 54.31958096591783, "mean_action_processing_ms": 0.22683034426252824, "mean_env_wait_ms": 0.16261449466943123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 70000, "timesteps_this_iter": 40, "agent_timesteps_total": 70000, "timers": {"sample_time_ms": 3295.331, "sample_throughput": 12.138, "learn_time_ms": 2471.615, "learn_throughput": 16.184, "update_time_ms": 73.884}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.2104105949401855, "grad_norm": 21.13945198059082, "td_error_abs": 1.6506879170735678, "q_taken_mean": 2.011093521118164, "target_mean": 2.367083994547526}}}, "num_steps_sampled": 70000, "num_agent_steps_sampled": 70000, "num_steps_trained": 70000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 69680, "num_target_updates": 134}, "done": false, "episodes_total": 7000, "training_iteration": 70, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-02-28", "timestamp": 1648900948, "time_this_iter_s": 83.31006979942322, "time_total_s": 5825.429141998291, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5825.429141998291, "timesteps_since_restore": 2800, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 23.36974789915966, "ram_util_percent": 78.4831932773109}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 6.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, -10.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, -10.0, 20.0, 0.0, 30.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, -10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, -20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, -10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7296817100294528, "mean_inference_ms": 54.290635244227545, "mean_action_processing_ms": 0.22675355960467072, "mean_env_wait_ms": 0.16255202034709623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 71000, "timesteps_this_iter": 40, "agent_timesteps_total": 71000, "timers": {"sample_time_ms": 3343.151, "sample_throughput": 11.965, "learn_time_ms": 2491.988, "learn_throughput": 16.051, "update_time_ms": 83.073}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.5196380615234375, "grad_norm": 30.14352798461914, "td_error_abs": 1.7085453033447267, "q_taken_mean": 3.1582005818684897, "target_mean": 2.576916249593099}}}, "num_steps_sampled": 71000, "num_agent_steps_sampled": 71000, "num_steps_trained": 71000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 70720, "num_target_updates": 136}, "done": false, "episodes_total": 7100, "training_iteration": 71, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-03-53", "timestamp": 1648901033, "time_this_iter_s": 83.89391016960144, "time_total_s": 5909.3230521678925, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5909.3230521678925, "timesteps_since_restore": 2840, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 23.511666666666663, "ram_util_percent": 78.83333333333334}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 6.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, -10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, -20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, -10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, -10.0, 10.0, 0.0, 10.0, -10.0, 20.0, -10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7293545453457437, "mean_inference_ms": 54.26434927612905, "mean_action_processing_ms": 0.2266673218984748, "mean_env_wait_ms": 0.16247601014005827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 72000, "timesteps_this_iter": 40, "agent_timesteps_total": 72000, "timers": {"sample_time_ms": 3370.93, "sample_throughput": 11.866, "learn_time_ms": 2515.032, "learn_throughput": 15.904, "update_time_ms": 83.138}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.9618144035339355, "grad_norm": 21.35379981994629, "td_error_abs": 1.739733632405599, "q_taken_mean": 2.381348164876302, "target_mean": 2.7429629007975262}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 72000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 71760, "num_target_updates": 138}, "done": false, "episodes_total": 7200, "training_iteration": 72, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-05-17", "timestamp": 1648901117, "time_this_iter_s": 83.78998732566833, "time_total_s": 5993.113039493561, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 5993.113039493561, "timesteps_since_restore": 2880, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 23.364166666666666, "ram_util_percent": 79.14}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 6.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, -10.0, 10.0, 10.0, 20.0, 0.0, 0.0, 20.0, -10.0, 0.0, 0.0, 10.0, 10.0, 20.0, -10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, -10.0, 20.0, -10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 20.0, 0.0, -10.0, 20.0, 10.0, -10.0, 10.0, 10.0, 0.0, 10.0, 0.0, -10.0, 0.0, 0.0, 10.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7290079667988717, "mean_inference_ms": 54.23024221483202, "mean_action_processing_ms": 0.22656534424965158, "mean_env_wait_ms": 0.16242257863304388, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 73000, "timesteps_this_iter": 40, "agent_timesteps_total": 73000, "timers": {"sample_time_ms": 3341.688, "sample_throughput": 11.97, "learn_time_ms": 2511.799, "learn_throughput": 15.925, "update_time_ms": 65.314}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.955957412719727, "grad_norm": 12.817548751831055, "td_error_abs": 1.7761202494303385, "q_taken_mean": 2.049372355143229, "target_mean": 2.0348439534505207}}}, "num_steps_sampled": 73000, "num_agent_steps_sampled": 73000, "num_steps_trained": 73000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 72800, "num_target_updates": 140}, "done": false, "episodes_total": 7300, "training_iteration": 73, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-06-41", "timestamp": 1648901201, "time_this_iter_s": 83.42147469520569, "time_total_s": 6076.5345141887665, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6076.5345141887665, "timesteps_since_restore": 2920, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 23.017500000000002, "ram_util_percent": 79.37166666666668}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 9.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, -10.0, 10.0, 10.0, 20.0, -10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, -10.0, 20.0, 10.0, 20.0, -10.0, 0.0, 10.0, 10.0, -10.0, 0.0, 30.0, 0.0, -10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, -10.0, 10.0, -10.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, -10.0, 10.0, 20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7286760930879446, "mean_inference_ms": 54.19918317278298, "mean_action_processing_ms": 0.2264751691340395, "mean_env_wait_ms": 0.16236217606615988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 74000, "timesteps_this_iter": 40, "agent_timesteps_total": 74000, "timers": {"sample_time_ms": 3363.417, "sample_throughput": 11.893, "learn_time_ms": 2510.96, "learn_throughput": 15.93, "update_time_ms": 64.417}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.283690452575684, "grad_norm": 13.894373893737793, "td_error_abs": 1.4074942270914714, "q_taken_mean": 2.174341328938802, "target_mean": 2.132526143391927}}}, "num_steps_sampled": 74000, "num_agent_steps_sampled": 74000, "num_steps_trained": 74000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 73840, "num_target_updates": 142}, "done": false, "episodes_total": 7400, "training_iteration": 74, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-08-06", "timestamp": 1648901286, "time_this_iter_s": 84.72254180908203, "time_total_s": 6161.2570559978485, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6161.2570559978485, "timesteps_since_restore": 2960, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 23.331404958677684, "ram_util_percent": 79.69090909090909}}
{"episode_reward_max": 20.0, "episode_reward_min": -20.0, "episode_reward_mean": 9.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, -10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, -10.0, 10.0, 10.0, 10.0, 10.0, 10.0, -20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, -10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, -10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, -10.0, 10.0, 10.0, 20.0, -10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.728132552982591, "mean_inference_ms": 54.162881563939465, "mean_action_processing_ms": 0.22630531065280038, "mean_env_wait_ms": 0.16222410943055365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 75000, "timesteps_this_iter": 40, "agent_timesteps_total": 75000, "timers": {"sample_time_ms": 3329.39, "sample_throughput": 12.014, "learn_time_ms": 2497.758, "learn_throughput": 16.014, "update_time_ms": 64.274}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.80249547958374, "grad_norm": 17.732799530029297, "td_error_abs": 1.5761610666910808, "q_taken_mean": 1.7742220560709636, "target_mean": 1.5706265767415364}}}, "num_steps_sampled": 75000, "num_agent_steps_sampled": 75000, "num_steps_trained": 75000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 74880, "num_target_updates": 144}, "done": false, "episodes_total": 7500, "training_iteration": 75, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-09-29", "timestamp": 1648901369, "time_this_iter_s": 82.87959718704224, "time_total_s": 6244.136653184891, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6244.136653184891, "timesteps_since_restore": 3000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 23.19243697478992, "ram_util_percent": 79.98487394957981}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 9.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 10.0, -10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7277393139046708, "mean_inference_ms": 54.13316921223895, "mean_action_processing_ms": 0.22620365472976978, "mean_env_wait_ms": 0.162133536372183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 76000, "timesteps_this_iter": 40, "agent_timesteps_total": 76000, "timers": {"sample_time_ms": 3317.298, "sample_throughput": 12.058, "learn_time_ms": 2482.081, "learn_throughput": 16.116, "update_time_ms": 70.954}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.6836957931518555, "grad_norm": 11.615989685058594, "td_error_abs": 1.6415604909261068, "q_taken_mean": 1.8983556111653646, "target_mean": 1.9115127563476562}}}, "num_steps_sampled": 76000, "num_agent_steps_sampled": 76000, "num_steps_trained": 76000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 75920, "num_target_updates": 146}, "done": false, "episodes_total": 7600, "training_iteration": 76, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-10-53", "timestamp": 1648901453, "time_this_iter_s": 83.32842636108398, "time_total_s": 6327.465079545975, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6327.465079545975, "timesteps_since_restore": 3040, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 23.09747899159663, "ram_util_percent": 80.18823529411766}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 9.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 20.0, -10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, -10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, -10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, -10.0, 0.0, -10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7273463433540972, "mean_inference_ms": 54.1099113065864, "mean_action_processing_ms": 0.22608541797076967, "mean_env_wait_ms": 0.1620533255674729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 77000, "timesteps_this_iter": 40, "agent_timesteps_total": 77000, "timers": {"sample_time_ms": 3338.11, "sample_throughput": 11.983, "learn_time_ms": 2488.103, "learn_throughput": 16.077, "update_time_ms": 75.647}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.7713799476623535, "grad_norm": 12.392853736877441, "td_error_abs": 1.3483088175455729, "q_taken_mean": 2.8349990844726562, "target_mean": 2.8006909688313804}}}, "num_steps_sampled": 77000, "num_agent_steps_sampled": 77000, "num_steps_trained": 77000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 76960, "num_target_updates": 148}, "done": false, "episodes_total": 7700, "training_iteration": 77, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-12-17", "timestamp": 1648901537, "time_this_iter_s": 83.63076710700989, "time_total_s": 6411.095846652985, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6411.095846652985, "timesteps_since_restore": 3080, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 23.529166666666665, "ram_util_percent": 80.57999999999998}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 8.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 0.0, 0.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, -10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, -10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7269854154606841, "mean_inference_ms": 54.08049608143736, "mean_action_processing_ms": 0.22598199554360412, "mean_env_wait_ms": 0.16196518578619098, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 78000, "timesteps_this_iter": 40, "agent_timesteps_total": 78000, "timers": {"sample_time_ms": 3358.586, "sample_throughput": 11.91, "learn_time_ms": 2508.824, "learn_throughput": 15.944, "update_time_ms": 65.641}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.185059547424316, "grad_norm": 14.365335464477539, "td_error_abs": 1.3818124135335286, "q_taken_mean": 1.4145860036214193, "target_mean": 1.6328750610351563}}}, "num_steps_sampled": 78000, "num_agent_steps_sampled": 78000, "num_steps_trained": 78000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 78000, "num_target_updates": 150}, "done": false, "episodes_total": 7800, "training_iteration": 78, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-13-42", "timestamp": 1648901622, "time_this_iter_s": 83.85160303115845, "time_total_s": 6494.947449684143, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6494.947449684143, "timesteps_since_restore": 3120, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 23.259166666666662, "ram_util_percent": 80.8125}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 8.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, -10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, -10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, -10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7264972197835061, "mean_inference_ms": 54.04885262997804, "mean_action_processing_ms": 0.22585008676839974, "mean_env_wait_ms": 0.16187427074213542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 79000, "timesteps_this_iter": 40, "agent_timesteps_total": 79000, "timers": {"sample_time_ms": 3391.579, "sample_throughput": 11.794, "learn_time_ms": 2534.126, "learn_throughput": 15.785, "update_time_ms": 97.204}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.956383228302002, "grad_norm": 23.380475997924805, "td_error_abs": 1.9914483388264974, "q_taken_mean": 1.829505157470703, "target_mean": 2.2074155171712238}}}, "num_steps_sampled": 79000, "num_agent_steps_sampled": 79000, "num_steps_trained": 79000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 78520, "num_target_updates": 151}, "done": false, "episodes_total": 7900, "training_iteration": 79, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-15-06", "timestamp": 1648901706, "time_this_iter_s": 84.19114232063293, "time_total_s": 6579.138592004776, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6579.138592004776, "timesteps_since_restore": 3160, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 23.183333333333337, "ram_util_percent": 81.08416666666666}}
{"episode_reward_max": 30.0, "episode_reward_min": -30.0, "episode_reward_mean": 7.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 10.0, -20.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, -10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, -10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, -30.0, 10.0, 0.0, 10.0, 10.0, -10.0, 10.0, 10.0, -10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, -10.0, 10.0, 10.0, 20.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7262866465212506, "mean_inference_ms": 54.03086938689239, "mean_action_processing_ms": 0.22578752015234316, "mean_env_wait_ms": 0.16184628209461724, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 80000, "timesteps_this_iter": 40, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 3343.284, "sample_throughput": 11.964, "learn_time_ms": 2501.31, "learn_throughput": 15.992, "update_time_ms": 67.092}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.159285545349121, "grad_norm": 10.988720893859863, "td_error_abs": 1.2951980590820313, "q_taken_mean": 1.9271302541097006, "target_mean": 1.9952315012613933}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 80000, "num_steps_trained": 80000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 79560, "num_target_updates": 153}, "done": false, "episodes_total": 8000, "training_iteration": 80, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-16-30", "timestamp": 1648901790, "time_this_iter_s": 83.73328804969788, "time_total_s": 6662.871880054474, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6662.871880054474, "timesteps_since_restore": 3200, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 23.675, "ram_util_percent": 81.4475}}
{"episode_reward_max": 30.0, "episode_reward_min": -20.0, "episode_reward_mean": 11.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 10.0, 20.0, 0.0, 10.0, 20.0, -10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 20.0, 10.0, 10.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, -20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7258778642439014, "mean_inference_ms": 54.002543798664874, "mean_action_processing_ms": 0.22568193095848005, "mean_env_wait_ms": 0.16178811228096937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 81000, "timesteps_this_iter": 40, "agent_timesteps_total": 81000, "timers": {"sample_time_ms": 3359.738, "sample_throughput": 11.906, "learn_time_ms": 2521.74, "learn_throughput": 15.862, "update_time_ms": 67.715}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 3.7920405864715576, "grad_norm": 17.835159301757812, "td_error_abs": 1.201858139038086, "q_taken_mean": 2.466014099121094, "target_mean": 2.5730906168619794}}}, "num_steps_sampled": 81000, "num_agent_steps_sampled": 81000, "num_steps_trained": 81000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 80600, "num_target_updates": 155}, "done": false, "episodes_total": 8100, "training_iteration": 81, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-17-55", "timestamp": 1648901875, "time_this_iter_s": 84.1108889579773, "time_total_s": 6746.982769012451, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6746.982769012451, "timesteps_since_restore": 3240, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 23.535833333333336, "ram_util_percent": 81.8025}}
{"episode_reward_max": 40.0, "episode_reward_min": -10.0, "episode_reward_mean": 9.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, -10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 30.0, 10.0, 30.0, 20.0, 30.0, -10.0, 10.0, 40.0, 0.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, -10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, -10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7257265966930921, "mean_inference_ms": 53.98708666239093, "mean_action_processing_ms": 0.2256160677656837, "mean_env_wait_ms": 0.1617444561118702, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 82000, "timesteps_this_iter": 40, "agent_timesteps_total": 82000, "timers": {"sample_time_ms": 3446.733, "sample_throughput": 11.605, "learn_time_ms": 2627.313, "learn_throughput": 15.225, "update_time_ms": 69.491}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.837576866149902, "grad_norm": 13.129971504211426, "td_error_abs": 1.3995769500732422, "q_taken_mean": 1.3004069010416666, "target_mean": 1.386116663614909}}}, "num_steps_sampled": 82000, "num_agent_steps_sampled": 82000, "num_steps_trained": 82000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 81640, "num_target_updates": 157}, "done": false, "episodes_total": 8200, "training_iteration": 82, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-19-21", "timestamp": 1648901961, "time_this_iter_s": 85.53013968467712, "time_total_s": 6832.512908697128, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6832.512908697128, "timesteps_since_restore": 3280, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 23.381967213114756, "ram_util_percent": 82.01229508196721}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 10.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 10.0, 10.0, 10.0, 10.0, 20.0, -10.0, 0.0, 10.0, 10.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, -10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7253017524806376, "mean_inference_ms": 53.96374343567643, "mean_action_processing_ms": 0.2254854770495136, "mean_env_wait_ms": 0.16166631195736034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 83000, "timesteps_this_iter": 40, "agent_timesteps_total": 83000, "timers": {"sample_time_ms": 3773.96, "sample_throughput": 10.599, "learn_time_ms": 2949.721, "learn_throughput": 13.561, "update_time_ms": 68.641}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.821141719818115, "grad_norm": 19.83150291442871, "td_error_abs": 1.5045424143473307, "q_taken_mean": 1.6001856486002604, "target_mean": 1.8907639821370443}}}, "num_steps_sampled": 83000, "num_agent_steps_sampled": 83000, "num_steps_trained": 83000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 82680, "num_target_updates": 159}, "done": false, "episodes_total": 8300, "training_iteration": 83, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-20-56", "timestamp": 1648902056, "time_this_iter_s": 94.12935519218445, "time_total_s": 6926.642263889313, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 6926.642263889313, "timesteps_since_restore": 3320, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 22.225185185185182, "ram_util_percent": 82.48814814814814}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 12.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, -10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 10.0, 10.0, 30.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 20.0, 20.0, -10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 30.0, 10.0, 10.0, 20.0, -10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7250086022958229, "mean_inference_ms": 53.943851636560815, "mean_action_processing_ms": 0.22541408362624066, "mean_env_wait_ms": 0.16163951481792405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 84000, "timesteps_this_iter": 40, "agent_timesteps_total": 84000, "timers": {"sample_time_ms": 3719.285, "sample_throughput": 10.755, "learn_time_ms": 2875.283, "learn_throughput": 13.912, "update_time_ms": 82.902}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.26831340789795, "grad_norm": 16.16989517211914, "td_error_abs": 1.7796541849772136, "q_taken_mean": 1.9177186330159506, "target_mean": 2.0361676534016926}}}, "num_steps_sampled": 84000, "num_agent_steps_sampled": 84000, "num_steps_trained": 84000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 83720, "num_target_updates": 161}, "done": false, "episodes_total": 8400, "training_iteration": 84, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-22-29", "timestamp": 1648902149, "time_this_iter_s": 93.19137620925903, "time_total_s": 7019.833640098572, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7019.833640098572, "timesteps_since_restore": 3360, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 22.714285714285715, "ram_util_percent": 82.72030075187969}}
{"episode_reward_max": 40.0, "episode_reward_min": -20.0, "episode_reward_mean": 12.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 10.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 30.0, 10.0, 10.0, 20.0, 10.0, 30.0, 10.0, 40.0, 10.0, 0.0, 10.0, 10.0, -20.0, 30.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7246409403364001, "mean_inference_ms": 53.918945411251144, "mean_action_processing_ms": 0.22528851813672254, "mean_env_wait_ms": 0.16159528530624004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 85000, "timesteps_this_iter": 40, "agent_timesteps_total": 85000, "timers": {"sample_time_ms": 3683.455, "sample_throughput": 10.859, "learn_time_ms": 2837.34, "learn_throughput": 14.098, "update_time_ms": 85.655}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.632766246795654, "grad_norm": 13.032817840576172, "td_error_abs": 1.6665491739908853, "q_taken_mean": 3.059958902994792, "target_mean": 3.131355794270833}}}, "num_steps_sampled": 85000, "num_agent_steps_sampled": 85000, "num_steps_trained": 85000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 84760, "num_target_updates": 163}, "done": false, "episodes_total": 8500, "training_iteration": 85, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-24-02", "timestamp": 1648902242, "time_this_iter_s": 92.03298616409302, "time_total_s": 7111.866626262665, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7111.866626262665, "timesteps_since_restore": 3400, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 22.65227272727273, "ram_util_percent": 82.97954545454544}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 11.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 30.0, 10.0, 10.0, 20.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, -10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, -10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7242870676778622, "mean_inference_ms": 53.89628503872713, "mean_action_processing_ms": 0.22517779855793355, "mean_env_wait_ms": 0.16152644721825543, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 86000, "timesteps_this_iter": 40, "agent_timesteps_total": 86000, "timers": {"sample_time_ms": 3724.229, "sample_throughput": 10.74, "learn_time_ms": 2879.831, "learn_throughput": 13.89, "update_time_ms": 74.446}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.723774433135986, "grad_norm": 16.520437240600586, "td_error_abs": 1.4765668233235678, "q_taken_mean": 3.3922526041666665, "target_mean": 3.2648137410481772}}}, "num_steps_sampled": 86000, "num_agent_steps_sampled": 86000, "num_steps_trained": 86000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 85800, "num_target_updates": 165}, "done": false, "episodes_total": 8600, "training_iteration": 86, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-25-35", "timestamp": 1648902335, "time_this_iter_s": 92.66786980628967, "time_total_s": 7204.5344960689545, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7204.5344960689545, "timesteps_since_restore": 3440, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 22.618045112781957, "ram_util_percent": 83.30451127819549}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 12.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 20.0, 20.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 40.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7238657544341109, "mean_inference_ms": 53.8680410884966, "mean_action_processing_ms": 0.225047013780549, "mean_env_wait_ms": 0.1614257076034206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 87000, "timesteps_this_iter": 40, "agent_timesteps_total": 87000, "timers": {"sample_time_ms": 3813.044, "sample_throughput": 10.49, "learn_time_ms": 2967.46, "learn_throughput": 13.48, "update_time_ms": 88.786}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.445158004760742, "grad_norm": 13.011148452758789, "td_error_abs": 1.6043238321940103, "q_taken_mean": 1.3793067932128906, "target_mean": 1.435305404663086}}}, "num_steps_sampled": 87000, "num_agent_steps_sampled": 87000, "num_steps_trained": 87000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 86840, "num_target_updates": 167}, "done": false, "episodes_total": 8700, "training_iteration": 87, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-27-09", "timestamp": 1648902429, "time_this_iter_s": 93.67621302604675, "time_total_s": 7298.210709095001, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7298.210709095001, "timesteps_since_restore": 3480, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 22.073134328358208, "ram_util_percent": 83.56119402985074}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 13.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 30.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, -10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7235510290430315, "mean_inference_ms": 53.852245667420604, "mean_action_processing_ms": 0.22494358385938348, "mean_env_wait_ms": 0.16137666471665196, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 88000, "timesteps_this_iter": 40, "agent_timesteps_total": 88000, "timers": {"sample_time_ms": 3818.259, "sample_throughput": 10.476, "learn_time_ms": 2965.418, "learn_throughput": 13.489, "update_time_ms": 98.004}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.436688423156738, "grad_norm": 25.46554183959961, "td_error_abs": 1.9626083374023438, "q_taken_mean": 2.3892372131347654, "target_mean": 2.771292877197266}}}, "num_steps_sampled": 88000, "num_agent_steps_sampled": 88000, "num_steps_trained": 88000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 87880, "num_target_updates": 169}, "done": false, "episodes_total": 8800, "training_iteration": 88, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-28-45", "timestamp": 1648902525, "time_this_iter_s": 95.7675507068634, "time_total_s": 7393.978259801865, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7393.978259801865, "timesteps_since_restore": 3520, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 22.486029411764704, "ram_util_percent": 83.89632352941177}}
{"episode_reward_max": 40.0, "episode_reward_min": -10.0, "episode_reward_mean": 13.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 10.0, 20.0, 0.0, 20.0, -10.0, 20.0, 40.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 20.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, -10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7231647655093948, "mean_inference_ms": 53.827034281128505, "mean_action_processing_ms": 0.22482979962501215, "mean_env_wait_ms": 0.16129678792886198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 89000, "timesteps_this_iter": 40, "agent_timesteps_total": 89000, "timers": {"sample_time_ms": 3851.807, "sample_throughput": 10.385, "learn_time_ms": 2964.537, "learn_throughput": 13.493, "update_time_ms": 114.986}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.289951801300049, "grad_norm": 12.111725807189941, "td_error_abs": 1.562026596069336, "q_taken_mean": 1.6806631724039713, "target_mean": 1.741757074991862}}}, "num_steps_sampled": 89000, "num_agent_steps_sampled": 89000, "num_steps_trained": 89000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 88920, "num_target_updates": 171}, "done": false, "episodes_total": 8900, "training_iteration": 89, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-30-22", "timestamp": 1648902622, "time_this_iter_s": 95.95364618301392, "time_total_s": 7489.9319059848785, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7489.9319059848785, "timesteps_since_restore": 3560, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 22.616058394160586, "ram_util_percent": 84.17080291970804}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 14.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 30.0, 10.0, 10.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7227834349372411, "mean_inference_ms": 53.80137856179019, "mean_action_processing_ms": 0.22471231607049147, "mean_env_wait_ms": 0.1612239310775437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 90000, "timesteps_this_iter": 40, "agent_timesteps_total": 90000, "timers": {"sample_time_ms": 3823.523, "sample_throughput": 10.462, "learn_time_ms": 2973.813, "learn_throughput": 13.451, "update_time_ms": 85.625}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.57892370223999, "grad_norm": 13.371675491333008, "td_error_abs": 1.6237814585367838, "q_taken_mean": 2.481273396809896, "target_mean": 2.6124809265136717}}}, "num_steps_sampled": 90000, "num_agent_steps_sampled": 90000, "num_steps_trained": 90000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 89960, "num_target_updates": 173}, "done": false, "episodes_total": 9000, "training_iteration": 90, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-31-58", "timestamp": 1648902718, "time_this_iter_s": 95.53635263442993, "time_total_s": 7585.4682586193085, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7585.4682586193085, "timesteps_since_restore": 3600, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 22.173722627737227, "ram_util_percent": 84.52919708029196}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 14.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7225304198817345, "mean_inference_ms": 53.78006022661095, "mean_action_processing_ms": 0.2246202806772324, "mean_env_wait_ms": 0.16117504122891135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 91000, "timesteps_this_iter": 40, "agent_timesteps_total": 91000, "timers": {"sample_time_ms": 3852.388, "sample_throughput": 10.383, "learn_time_ms": 2987.605, "learn_throughput": 13.389, "update_time_ms": 102.511}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.396467208862305, "grad_norm": 14.233234405517578, "td_error_abs": 1.979317855834961, "q_taken_mean": 2.4591631571451824, "target_mean": 2.4938151041666665}}}, "num_steps_sampled": 91000, "num_agent_steps_sampled": 91000, "num_steps_trained": 91000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 91000, "num_target_updates": 175}, "done": false, "episodes_total": 9100, "training_iteration": 91, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-33-34", "timestamp": 1648902814, "time_this_iter_s": 96.04659152030945, "time_total_s": 7681.514850139618, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7681.514850139618, "timesteps_since_restore": 3640, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 22.435507246376815, "ram_util_percent": 84.8195652173913}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 15.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 30.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 30.0, 10.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7221269781685598, "mean_inference_ms": 53.75696457674654, "mean_action_processing_ms": 0.2244997556290106, "mean_env_wait_ms": 0.1611195410403432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 92000, "timesteps_this_iter": 40, "agent_timesteps_total": 92000, "timers": {"sample_time_ms": 3745.391, "sample_throughput": 10.68, "learn_time_ms": 2891.141, "learn_throughput": 13.835, "update_time_ms": 111.131}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.830416679382324, "grad_norm": 13.271161079406738, "td_error_abs": 1.832955551147461, "q_taken_mean": 1.9179359436035157, "target_mean": 1.8820936838785807}}}, "num_steps_sampled": 92000, "num_agent_steps_sampled": 92000, "num_steps_trained": 92000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 91520, "num_target_updates": 176}, "done": false, "episodes_total": 9200, "training_iteration": 92, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-35-09", "timestamp": 1648902909, "time_this_iter_s": 94.74338889122009, "time_total_s": 7776.258239030838, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7776.258239030838, "timesteps_since_restore": 3680, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 22.29703703703704, "ram_util_percent": 85.11111111111111}}
{"episode_reward_max": 40.0, "episode_reward_min": -10.0, "episode_reward_mean": 15.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 20.0, -10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 30.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7217948931293339, "mean_inference_ms": 53.736226565658086, "mean_action_processing_ms": 0.22440764741084235, "mean_env_wait_ms": 0.16106330145098036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 93000, "timesteps_this_iter": 40, "agent_timesteps_total": 93000, "timers": {"sample_time_ms": 3594.874, "sample_throughput": 11.127, "learn_time_ms": 2739.563, "learn_throughput": 14.601, "update_time_ms": 100.959}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.506272315979004, "grad_norm": 15.796259880065918, "td_error_abs": 1.6647814432779948, "q_taken_mean": 2.024329503377279, "target_mean": 1.9414217631022135}}}, "num_steps_sampled": 93000, "num_agent_steps_sampled": 93000, "num_steps_trained": 93000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 92560, "num_target_updates": 178}, "done": false, "episodes_total": 9300, "training_iteration": 93, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-36-41", "timestamp": 1648903001, "time_this_iter_s": 91.31447553634644, "time_total_s": 7867.572714567184, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7867.572714567184, "timesteps_since_restore": 3720, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 22.88692307692308, "ram_util_percent": 85.39153846153846}}
{"episode_reward_max": 40.0, "episode_reward_min": -10.0, "episode_reward_mean": 15.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 10.0, 30.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, -10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 40.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7215854736202487, "mean_inference_ms": 53.71747531108079, "mean_action_processing_ms": 0.2243161242057209, "mean_env_wait_ms": 0.1609983593751753, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 94000, "timesteps_this_iter": 40, "agent_timesteps_total": 94000, "timers": {"sample_time_ms": 3744.502, "sample_throughput": 10.682, "learn_time_ms": 2834.021, "learn_throughput": 14.114, "update_time_ms": 123.51}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.991064548492432, "grad_norm": 15.520429611206055, "td_error_abs": 1.7150681813557942, "q_taken_mean": 3.022070821126302, "target_mean": 2.9604212443033853}}}, "num_steps_sampled": 94000, "num_agent_steps_sampled": 94000, "num_steps_trained": 94000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 93600, "num_target_updates": 180}, "done": false, "episodes_total": 9400, "training_iteration": 94, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-38-15", "timestamp": 1648903095, "time_this_iter_s": 93.17276215553284, "time_total_s": 7960.745476722717, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 7960.745476722717, "timesteps_since_restore": 3760, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 22.69626865671642, "ram_util_percent": 85.69179104477612}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 14.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 30.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7213028821085515, "mean_inference_ms": 53.6955311009168, "mean_action_processing_ms": 0.22420510106987962, "mean_env_wait_ms": 0.1609348923546365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 95000, "timesteps_this_iter": 40, "agent_timesteps_total": 95000, "timers": {"sample_time_ms": 3837.995, "sample_throughput": 10.422, "learn_time_ms": 2960.854, "learn_throughput": 13.51, "update_time_ms": 117.246}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.24381160736084, "grad_norm": 26.216936111450195, "td_error_abs": 1.6436981201171874, "q_taken_mean": 2.825417327880859, "target_mean": 3.3153149922688803}}}, "num_steps_sampled": 95000, "num_agent_steps_sampled": 95000, "num_steps_trained": 95000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 94640, "num_target_updates": 182}, "done": false, "episodes_total": 9500, "training_iteration": 95, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-39-51", "timestamp": 1648903191, "time_this_iter_s": 95.38510966300964, "time_total_s": 8056.130586385727, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8056.130586385727, "timesteps_since_restore": 3800, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 22.552205882352943, "ram_util_percent": 86.00588235294119}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 13.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 40.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 30.0, 10.0, 40.0, 10.0, 10.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7210979784117617, "mean_inference_ms": 53.672968484497005, "mean_action_processing_ms": 0.22411535175724487, "mean_env_wait_ms": 0.16088211746505088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 96000, "timesteps_this_iter": 40, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 3873.107, "sample_throughput": 10.328, "learn_time_ms": 3007.484, "learn_throughput": 13.3, "update_time_ms": 114.291}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.708742618560791, "grad_norm": 16.40658950805664, "td_error_abs": 1.6535645802815755, "q_taken_mean": 3.473626963297526, "target_mean": 3.6263036092122394}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 96000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 95680, "num_target_updates": 184}, "done": false, "episodes_total": 9600, "training_iteration": 96, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-41-28", "timestamp": 1648903288, "time_this_iter_s": 96.80855083465576, "time_total_s": 8152.939137220383, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8152.939137220383, "timesteps_since_restore": 3840, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 22.59492753623188, "ram_util_percent": 86.22028985507248}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 15.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7207199822386086, "mean_inference_ms": 53.65066404741015, "mean_action_processing_ms": 0.22400570114363513, "mean_env_wait_ms": 0.16081478171906796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 97000, "timesteps_this_iter": 40, "agent_timesteps_total": 97000, "timers": {"sample_time_ms": 3870.863, "sample_throughput": 10.334, "learn_time_ms": 2985.102, "learn_throughput": 13.4, "update_time_ms": 119.695}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.006657123565674, "grad_norm": 19.172386169433594, "td_error_abs": 1.8033089955647787, "q_taken_mean": 3.1396169026692706, "target_mean": 3.3864097595214844}}}, "num_steps_sampled": 97000, "num_agent_steps_sampled": 97000, "num_steps_trained": 97000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 96720, "num_target_updates": 186}, "done": false, "episodes_total": 9700, "training_iteration": 97, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-43-05", "timestamp": 1648903385, "time_this_iter_s": 96.83091115951538, "time_total_s": 8249.770048379898, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8249.770048379898, "timesteps_since_restore": 3880, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 22.238848920863308, "ram_util_percent": 86.53597122302158}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 17.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 40.0, 20.0, 40.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 20.0, 30.0, 10.0, 30.0, 10.0, 20.0, 40.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7206303144706948, "mean_inference_ms": 53.63220499464991, "mean_action_processing_ms": 0.22391037164252714, "mean_env_wait_ms": 0.1607538923857762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 98000, "timesteps_this_iter": 40, "agent_timesteps_total": 98000, "timers": {"sample_time_ms": 3859.496, "sample_throughput": 10.364, "learn_time_ms": 2981.976, "learn_throughput": 13.414, "update_time_ms": 107.449}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.472140312194824, "grad_norm": 23.786212921142578, "td_error_abs": 1.7488182067871094, "q_taken_mean": 2.939251454671224, "target_mean": 3.258165486653646}}}, "num_steps_sampled": 98000, "num_agent_steps_sampled": 98000, "num_steps_trained": 98000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 97760, "num_target_updates": 188}, "done": false, "episodes_total": 9800, "training_iteration": 98, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-44-42", "timestamp": 1648903482, "time_this_iter_s": 96.45023131370544, "time_total_s": 8346.220279693604, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8346.220279693604, "timesteps_since_restore": 3920, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 22.4695652173913, "ram_util_percent": 86.8413043478261}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 17.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 30.0, 10.0, 30.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7204320940228309, "mean_inference_ms": 53.61220640710599, "mean_action_processing_ms": 0.2238386270036736, "mean_env_wait_ms": 0.16071261225274192, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 99000, "timesteps_this_iter": 40, "agent_timesteps_total": 99000, "timers": {"sample_time_ms": 3877.611, "sample_throughput": 10.316, "learn_time_ms": 2978.207, "learn_throughput": 13.431, "update_time_ms": 131.492}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.000977516174316, "grad_norm": 19.418010711669922, "td_error_abs": 1.9331708272298178, "q_taken_mean": 1.2235904693603517, "target_mean": 1.5687123616536458}}}, "num_steps_sampled": 99000, "num_agent_steps_sampled": 99000, "num_steps_trained": 99000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 98800, "num_target_updates": 190}, "done": false, "episodes_total": 9900, "training_iteration": 99, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-46-20", "timestamp": 1648903580, "time_this_iter_s": 97.20604205131531, "time_total_s": 8443.426321744919, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8443.426321744919, "timesteps_since_restore": 3960, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 22.39782608695652, "ram_util_percent": 87.10217391304347}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 18.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.720202155143927, "mean_inference_ms": 53.597597993663285, "mean_action_processing_ms": 0.22377659714625822, "mean_env_wait_ms": 0.16068576846159557, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 100000, "timesteps_this_iter": 40, "agent_timesteps_total": 100000, "timers": {"sample_time_ms": 3853.014, "sample_throughput": 10.381, "learn_time_ms": 2971.828, "learn_throughput": 13.46, "update_time_ms": 127.597}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.348581790924072, "grad_norm": 13.441587448120117, "td_error_abs": 1.414682133992513, "q_taken_mean": 2.5433316548665363, "target_mean": 2.5707244873046875}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 100000, "num_steps_trained": 100000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 99840, "num_target_updates": 192}, "done": false, "episodes_total": 10000, "training_iteration": 100, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-47-57", "timestamp": 1648903677, "time_this_iter_s": 96.90670561790466, "time_total_s": 8540.333027362823, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8540.333027362823, "timesteps_since_restore": 4000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 22.538405797101447, "ram_util_percent": 87.46956521739132}}
{"episode_reward_max": 20.0, "episode_reward_min": 10.0, "episode_reward_mean": 18.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.719912238349717, "mean_inference_ms": 53.57728022725734, "mean_action_processing_ms": 0.22368561437373483, "mean_env_wait_ms": 0.16063485757973467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 101000, "timesteps_this_iter": 40, "agent_timesteps_total": 101000, "timers": {"sample_time_ms": 3895.564, "sample_throughput": 10.268, "learn_time_ms": 3010.985, "learn_throughput": 13.285, "update_time_ms": 129.237}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.951703071594238, "grad_norm": 21.548852920532227, "td_error_abs": 1.9355379740397136, "q_taken_mean": 2.3578618367513022, "target_mean": 1.981729253133138}}}, "num_steps_sampled": 101000, "num_agent_steps_sampled": 101000, "num_steps_trained": 101000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 100880, "num_target_updates": 194}, "done": false, "episodes_total": 10100, "training_iteration": 101, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-49-35", "timestamp": 1648903775, "time_this_iter_s": 97.40425300598145, "time_total_s": 8637.737280368805, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8637.737280368805, "timesteps_since_restore": 4040, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 22.040287769784175, "ram_util_percent": 87.60000000000001}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 18.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7196511714057658, "mean_inference_ms": 53.558968940457525, "mean_action_processing_ms": 0.22357894151305494, "mean_env_wait_ms": 0.160558825076587, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 102000, "timesteps_this_iter": 40, "agent_timesteps_total": 102000, "timers": {"sample_time_ms": 3866.263, "sample_throughput": 10.346, "learn_time_ms": 2976.126, "learn_throughput": 13.44, "update_time_ms": 131.287}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.893596172332764, "grad_norm": 26.884323120117188, "td_error_abs": 1.7000338236490886, "q_taken_mean": 1.3409681955973307, "target_mean": 1.838702646891276}}}, "num_steps_sampled": 102000, "num_agent_steps_sampled": 102000, "num_steps_trained": 102000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 101920, "num_target_updates": 196}, "done": false, "episodes_total": 10200, "training_iteration": 102, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-51-13", "timestamp": 1648903873, "time_this_iter_s": 97.2181646823883, "time_total_s": 8734.955445051193, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8734.955445051193, "timesteps_since_restore": 4080, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 22.3136690647482, "ram_util_percent": 87.66187050359713}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 19.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7194448205310071, "mean_inference_ms": 53.5387935872115, "mean_action_processing_ms": 0.22350087739311092, "mean_env_wait_ms": 0.160501295467251, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 103000, "timesteps_this_iter": 40, "agent_timesteps_total": 103000, "timers": {"sample_time_ms": 3825.388, "sample_throughput": 10.456, "learn_time_ms": 2967.064, "learn_throughput": 13.481, "update_time_ms": 110.699}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.260659694671631, "grad_norm": 11.166997909545898, "td_error_abs": 1.5540592193603515, "q_taken_mean": 2.091786575317383, "target_mean": 2.0537784576416014}}}, "num_steps_sampled": 103000, "num_agent_steps_sampled": 103000, "num_steps_trained": 103000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 102960, "num_target_updates": 198}, "done": false, "episodes_total": 10300, "training_iteration": 103, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-52-48", "timestamp": 1648903968, "time_this_iter_s": 94.64645838737488, "time_total_s": 8829.601903438568, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8829.601903438568, "timesteps_since_restore": 4120, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 22.194814814814816, "ram_util_percent": 87.41851851851852}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 19.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 40.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.719252127756738, "mean_inference_ms": 53.51871753636654, "mean_action_processing_ms": 0.22342726247254974, "mean_env_wait_ms": 0.16046407098866605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 104000, "timesteps_this_iter": 40, "agent_timesteps_total": 104000, "timers": {"sample_time_ms": 3860.602, "sample_throughput": 10.361, "learn_time_ms": 2965.048, "learn_throughput": 13.491, "update_time_ms": 140.372}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.908786296844482, "grad_norm": 14.926685333251953, "td_error_abs": 1.706961949666341, "q_taken_mean": 2.5674975077311197, "target_mean": 2.6436203002929686}}}, "num_steps_sampled": 104000, "num_agent_steps_sampled": 104000, "num_steps_trained": 104000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 104000, "num_target_updates": 200}, "done": false, "episodes_total": 10400, "training_iteration": 104, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-54-26", "timestamp": 1648904066, "time_this_iter_s": 97.15778970718384, "time_total_s": 8926.759693145752, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 8926.759693145752, "timesteps_since_restore": 4160, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 22.310791366906475, "ram_util_percent": 87.69136690647481}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 18.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 30.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7190578919602123, "mean_inference_ms": 53.500695908111865, "mean_action_processing_ms": 0.22335881655758705, "mean_env_wait_ms": 0.16041893190867307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 105000, "timesteps_this_iter": 40, "agent_timesteps_total": 105000, "timers": {"sample_time_ms": 3893.505, "sample_throughput": 10.274, "learn_time_ms": 2985.972, "learn_throughput": 13.396, "update_time_ms": 138.883}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.181475639343262, "grad_norm": 20.03464126586914, "td_error_abs": 1.9001319885253907, "q_taken_mean": 2.725916544596354, "target_mean": 2.663871256510417}}}, "num_steps_sampled": 105000, "num_agent_steps_sampled": 105000, "num_steps_trained": 105000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 104520, "num_target_updates": 201}, "done": false, "episodes_total": 10500, "training_iteration": 105, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-56-03", "timestamp": 1648904163, "time_this_iter_s": 97.25825691223145, "time_total_s": 9024.017950057983, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9024.017950057983, "timesteps_since_restore": 4200, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 22.741726618705037, "ram_util_percent": 88.0}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 18.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7188632993769013, "mean_inference_ms": 53.48376517097733, "mean_action_processing_ms": 0.22328558483104338, "mean_env_wait_ms": 0.16038571252970782, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 106000, "timesteps_this_iter": 40, "agent_timesteps_total": 106000, "timers": {"sample_time_ms": 3900.362, "sample_throughput": 10.255, "learn_time_ms": 3012.286, "learn_throughput": 13.279, "update_time_ms": 133.636}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.897324085235596, "grad_norm": 15.142511367797852, "td_error_abs": 1.7122292836507162, "q_taken_mean": 1.5548727671305338, "target_mean": 1.419502894083659}}}, "num_steps_sampled": 106000, "num_agent_steps_sampled": 106000, "num_steps_trained": 106000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 105560, "num_target_updates": 203}, "done": false, "episodes_total": 10600, "training_iteration": 106, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-57-41", "timestamp": 1648904261, "time_this_iter_s": 97.17066025733948, "time_total_s": 9121.188610315323, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9121.188610315323, "timesteps_since_restore": 4240, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 22.164748201438847, "ram_util_percent": 88.24892086330935}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 18.4, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 40.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7186404705350631, "mean_inference_ms": 53.46614597427579, "mean_action_processing_ms": 0.2232100655130528, "mean_env_wait_ms": 0.16032579943272007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 107000, "timesteps_this_iter": 40, "agent_timesteps_total": 107000, "timers": {"sample_time_ms": 3936.805, "sample_throughput": 10.161, "learn_time_ms": 3040.964, "learn_throughput": 13.154, "update_time_ms": 139.983}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.267317771911621, "grad_norm": 17.921262741088867, "td_error_abs": 1.9155152638753254, "q_taken_mean": 2.5967305501302085, "target_mean": 2.412733968098958}}}, "num_steps_sampled": 107000, "num_agent_steps_sampled": 107000, "num_steps_trained": 107000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 106600, "num_target_updates": 205}, "done": false, "episodes_total": 10700, "training_iteration": 107, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_05-59-20", "timestamp": 1648904360, "time_this_iter_s": 98.31983399391174, "time_total_s": 9219.508444309235, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9219.508444309235, "timesteps_since_restore": 4280, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 22.64428571428571, "ram_util_percent": 88.55071428571428}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 18.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7184451233258554, "mean_inference_ms": 53.448924274030645, "mean_action_processing_ms": 0.22314159142821366, "mean_env_wait_ms": 0.16031670422912694, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 108000, "timesteps_this_iter": 40, "agent_timesteps_total": 108000, "timers": {"sample_time_ms": 3897.781, "sample_throughput": 10.262, "learn_time_ms": 3000.498, "learn_throughput": 13.331, "update_time_ms": 142.991}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.6549272537231445, "grad_norm": 14.575174331665039, "td_error_abs": 1.3353267669677735, "q_taken_mean": 1.6159311930338542, "target_mean": 1.837857437133789}}}, "num_steps_sampled": 108000, "num_agent_steps_sampled": 108000, "num_steps_trained": 108000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 107640, "num_target_updates": 207}, "done": false, "episodes_total": 10800, "training_iteration": 108, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-00-58", "timestamp": 1648904458, "time_this_iter_s": 97.74914455413818, "time_total_s": 9317.257588863373, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9317.257588863373, "timesteps_since_restore": 4320, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 22.17338129496403, "ram_util_percent": 88.73093525179857}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 18.9, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 20.0, 30.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7182574373643982, "mean_inference_ms": 53.42936356576587, "mean_action_processing_ms": 0.22306842001848173, "mean_env_wait_ms": 0.16026080260560785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 109000, "timesteps_this_iter": 40, "agent_timesteps_total": 109000, "timers": {"sample_time_ms": 3873.913, "sample_throughput": 10.325, "learn_time_ms": 2973.136, "learn_throughput": 13.454, "update_time_ms": 139.986}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.468227863311768, "grad_norm": 22.011201858520508, "td_error_abs": 1.7790388743082681, "q_taken_mean": 2.3081273396809894, "target_mean": 2.349199422200521}}}, "num_steps_sampled": 109000, "num_agent_steps_sampled": 109000, "num_steps_trained": 109000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 108680, "num_target_updates": 209}, "done": false, "episodes_total": 10900, "training_iteration": 109, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-02-36", "timestamp": 1648904556, "time_this_iter_s": 97.44817280769348, "time_total_s": 9414.705761671066, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9414.705761671066, "timesteps_since_restore": 4360, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 22.407194244604316, "ram_util_percent": 89.07697841726619}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 19.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7180220573357049, "mean_inference_ms": 53.41255017867639, "mean_action_processing_ms": 0.22299539773690738, "mean_env_wait_ms": 0.16019723921757406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 110000, "timesteps_this_iter": 40, "agent_timesteps_total": 110000, "timers": {"sample_time_ms": 3901.056, "sample_throughput": 10.254, "learn_time_ms": 2994.353, "learn_throughput": 13.358, "update_time_ms": 144.253}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.820125579833984, "grad_norm": 23.0523624420166, "td_error_abs": 2.1878738403320312, "q_taken_mean": 2.954184977213542, "target_mean": 3.3349291483561196}}}, "num_steps_sampled": 110000, "num_agent_steps_sampled": 110000, "num_steps_trained": 110000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 109720, "num_target_updates": 211}, "done": false, "episodes_total": 11000, "training_iteration": 110, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-04-15", "timestamp": 1648904655, "time_this_iter_s": 98.15309977531433, "time_total_s": 9512.85886144638, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9512.85886144638, "timesteps_since_restore": 4400, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 22.572142857142858, "ram_util_percent": 89.31642857142856}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 19.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 30.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7177627923007415, "mean_inference_ms": 53.3951795284591, "mean_action_processing_ms": 0.2229205166205454, "mean_env_wait_ms": 0.1601611127561631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 111000, "timesteps_this_iter": 40, "agent_timesteps_total": 111000, "timers": {"sample_time_ms": 3892.096, "sample_throughput": 10.277, "learn_time_ms": 2982.4, "learn_throughput": 13.412, "update_time_ms": 175.38}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.969388484954834, "grad_norm": 16.640758514404297, "td_error_abs": 1.5385147094726563, "q_taken_mean": 2.271418253580729, "target_mean": 2.049825159708659}}}, "num_steps_sampled": 111000, "num_agent_steps_sampled": 111000, "num_steps_trained": 111000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 110760, "num_target_updates": 213}, "done": false, "episodes_total": 11100, "training_iteration": 111, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-05-53", "timestamp": 1648904753, "time_this_iter_s": 98.20188736915588, "time_total_s": 9611.060748815536, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9611.060748815536, "timesteps_since_restore": 4440, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 22.222857142857144, "ram_util_percent": 89.57857142857142}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 19.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7175375621602614, "mean_inference_ms": 53.377690611045345, "mean_action_processing_ms": 0.22284751755651175, "mean_env_wait_ms": 0.16010245452297225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 112000, "timesteps_this_iter": 40, "agent_timesteps_total": 112000, "timers": {"sample_time_ms": 3960.978, "sample_throughput": 10.099, "learn_time_ms": 3001.374, "learn_throughput": 13.327, "update_time_ms": 195.712}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.00004768371582, "grad_norm": 25.552133560180664, "td_error_abs": 1.713675816853841, "q_taken_mean": 3.557940673828125, "target_mean": 3.8611686706542967}}}, "num_steps_sampled": 112000, "num_agent_steps_sampled": 112000, "num_steps_trained": 112000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 111800, "num_target_updates": 215}, "done": false, "episodes_total": 11200, "training_iteration": 112, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-07-32", "timestamp": 1648904852, "time_this_iter_s": 98.17549204826355, "time_total_s": 9709.2362408638, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9709.2362408638, "timesteps_since_restore": 4480, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 22.33642857142857, "ram_util_percent": 89.97785714285715}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 18.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7174941637778397, "mean_inference_ms": 53.37016069421953, "mean_action_processing_ms": 0.2228300477174703, "mean_env_wait_ms": 0.16009820878562675, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 113000, "timesteps_this_iter": 40, "agent_timesteps_total": 113000, "timers": {"sample_time_ms": 3940.88, "sample_throughput": 10.15, "learn_time_ms": 3005.47, "learn_throughput": 13.309, "update_time_ms": 185.553}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.140989303588867, "grad_norm": 12.662662506103516, "td_error_abs": 1.8367746988932292, "q_taken_mean": 1.630136744181315, "target_mean": 1.7184154510498046}}}, "num_steps_sampled": 113000, "num_agent_steps_sampled": 113000, "num_steps_trained": 113000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 112840, "num_target_updates": 217}, "done": false, "episodes_total": 11300, "training_iteration": 113, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-09-12", "timestamp": 1648904952, "time_this_iter_s": 99.67591643333435, "time_total_s": 9808.912157297134, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9808.912157297134, "timesteps_since_restore": 4520, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 22.655944055944058, "ram_util_percent": 90.22657342657344}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 19.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 40.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7172490474588099, "mean_inference_ms": 53.35445781284614, "mean_action_processing_ms": 0.22275434000936037, "mean_env_wait_ms": 0.16005127426867005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 114000, "timesteps_this_iter": 40, "agent_timesteps_total": 114000, "timers": {"sample_time_ms": 3914.587, "sample_throughput": 10.218, "learn_time_ms": 3014.034, "learn_throughput": 13.271, "update_time_ms": 155.429}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.686670303344727, "grad_norm": 11.714584350585938, "td_error_abs": 2.05016721089681, "q_taken_mean": 2.727881113688151, "target_mean": 2.7261421203613283}}}, "num_steps_sampled": 114000, "num_agent_steps_sampled": 114000, "num_steps_trained": 114000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 113880, "num_target_updates": 219}, "done": false, "episodes_total": 11400, "training_iteration": 114, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-10-51", "timestamp": 1648905051, "time_this_iter_s": 98.34327697753906, "time_total_s": 9907.255434274673, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 9907.255434274673, "timesteps_since_restore": 4560, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 22.205035971223023, "ram_util_percent": 90.4431654676259}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 19.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.717977431209302, "mean_inference_ms": 53.3962970895148, "mean_action_processing_ms": 0.2229393206448402, "mean_env_wait_ms": 0.16016143495520485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 115000, "timesteps_this_iter": 40, "agent_timesteps_total": 115000, "timers": {"sample_time_ms": 4209.003, "sample_throughput": 9.503, "learn_time_ms": 3203.553, "learn_throughput": 12.486, "update_time_ms": 139.462}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.093557357788086, "grad_norm": 11.934900283813477, "td_error_abs": 1.8050401051839193, "q_taken_mean": 3.7995262145996094, "target_mean": 3.8448778788248696}}}, "num_steps_sampled": 115000, "num_agent_steps_sampled": 115000, "num_steps_trained": 115000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 114920, "num_target_updates": 221}, "done": false, "episodes_total": 11500, "training_iteration": 115, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-12-37", "timestamp": 1648905157, "time_this_iter_s": 105.64357876777649, "time_total_s": 10012.89901304245, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10012.89901304245, "timesteps_since_restore": 4600, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 23.18476821192053, "ram_util_percent": 90.8450331125828}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 19.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7181263110550605, "mean_inference_ms": 53.39849396806876, "mean_action_processing_ms": 0.2229669325014899, "mean_env_wait_ms": 0.16020738907112902, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 116000, "timesteps_this_iter": 40, "agent_timesteps_total": 116000, "timers": {"sample_time_ms": 4040.228, "sample_throughput": 9.9, "learn_time_ms": 3073.548, "learn_throughput": 13.014, "update_time_ms": 175.822}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.566343307495117, "grad_norm": 13.024359703063965, "td_error_abs": 1.5011990865071614, "q_taken_mean": 3.002672068277995, "target_mean": 3.0113990783691404}}}, "num_steps_sampled": 116000, "num_agent_steps_sampled": 116000, "num_steps_trained": 116000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 115960, "num_target_updates": 223}, "done": false, "episodes_total": 11600, "training_iteration": 116, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-14-18", "timestamp": 1648905258, "time_this_iter_s": 100.32230067253113, "time_total_s": 10113.221313714981, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10113.221313714981, "timesteps_since_restore": 4640, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 22.469930069930072, "ram_util_percent": 91.03076923076922}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 18.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.71812090288981, "mean_inference_ms": 53.40188986615015, "mean_action_processing_ms": 0.2229666755544293, "mean_env_wait_ms": 0.16020906509071298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 117000, "timesteps_this_iter": 40, "agent_timesteps_total": 117000, "timers": {"sample_time_ms": 4039.336, "sample_throughput": 9.903, "learn_time_ms": 3072.945, "learn_throughput": 13.017, "update_time_ms": 175.464}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.430676460266113, "grad_norm": 28.18816566467285, "td_error_abs": 2.0653514862060547, "q_taken_mean": 1.4504439036051433, "target_mean": 2.009929911295573}}}, "num_steps_sampled": 117000, "num_agent_steps_sampled": 117000, "num_steps_trained": 117000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 117000, "num_target_updates": 225}, "done": false, "episodes_total": 11700, "training_iteration": 117, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-15-59", "timestamp": 1648905359, "time_this_iter_s": 100.5999960899353, "time_total_s": 10213.821309804916, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10213.821309804916, "timesteps_since_restore": 4680, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 22.588111888111886, "ram_util_percent": 91.16783216783217}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 19.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7187390722649323, "mean_inference_ms": 53.45075138584766, "mean_action_processing_ms": 0.22317476343055545, "mean_env_wait_ms": 0.16036068907043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 118000, "timesteps_this_iter": 40, "agent_timesteps_total": 118000, "timers": {"sample_time_ms": 4213.696, "sample_throughput": 9.493, "learn_time_ms": 3177.957, "learn_throughput": 12.587, "update_time_ms": 202.215}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.636157035827637, "grad_norm": 21.032556533813477, "td_error_abs": 2.1071434020996094, "q_taken_mean": 3.6180814107259116, "target_mean": 3.7561739603678386}}}, "num_steps_sampled": 118000, "num_agent_steps_sampled": 118000, "num_steps_trained": 118000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 117520, "num_target_updates": 226}, "done": false, "episodes_total": 11800, "training_iteration": 118, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-17-46", "timestamp": 1648905466, "time_this_iter_s": 105.67598104476929, "time_total_s": 10319.497290849686, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10319.497290849686, "timesteps_since_restore": 4720, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 23.246308724832215, "ram_util_percent": 91.54161073825505}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 20.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7189812409705882, "mean_inference_ms": 53.46626033302451, "mean_action_processing_ms": 0.22325114135457536, "mean_env_wait_ms": 0.16039160935883803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 119000, "timesteps_this_iter": 40, "agent_timesteps_total": 119000, "timers": {"sample_time_ms": 3968.689, "sample_throughput": 10.079, "learn_time_ms": 2962.213, "learn_throughput": 13.503, "update_time_ms": 200.337}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.98583459854126, "grad_norm": 10.622854232788086, "td_error_abs": 1.641164525349935, "q_taken_mean": 2.6247151692708335, "target_mean": 2.4717124938964843}}}, "num_steps_sampled": 119000, "num_agent_steps_sampled": 119000, "num_steps_trained": 119000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 118560, "num_target_updates": 228}, "done": false, "episodes_total": 11900, "training_iteration": 119, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-19-27", "timestamp": 1648905567, "time_this_iter_s": 101.2427031993866, "time_total_s": 10420.739994049072, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10420.739994049072, "timesteps_since_restore": 4760, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 22.30896551724138, "ram_util_percent": 91.91172413793105}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 19.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 30.0, 30.0, 20.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7189242789190706, "mean_inference_ms": 53.45951181495789, "mean_action_processing_ms": 0.2232202390548265, "mean_env_wait_ms": 0.1603615434562114, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 120000, "timesteps_this_iter": 40, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 4048.897, "sample_throughput": 9.879, "learn_time_ms": 3061.464, "learn_throughput": 13.066, "update_time_ms": 225.543}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.951309680938721, "grad_norm": 25.983306884765625, "td_error_abs": 1.7362656911214194, "q_taken_mean": 3.1558197021484373, "target_mean": 2.673786926269531}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 119600, "num_target_updates": 230}, "done": false, "episodes_total": 12000, "training_iteration": 120, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-21-08", "timestamp": 1648905668, "time_this_iter_s": 100.1822144985199, "time_total_s": 10520.922208547592, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10520.922208547592, "timesteps_since_restore": 4800, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 22.56830985915493, "ram_util_percent": 92.14577464788734}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 18.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7190427946920636, "mean_inference_ms": 53.468623579736544, "mean_action_processing_ms": 0.2232430032539247, "mean_env_wait_ms": 0.16040101902042983, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 121000, "timesteps_this_iter": 40, "agent_timesteps_total": 121000, "timers": {"sample_time_ms": 4002.327, "sample_throughput": 9.994, "learn_time_ms": 3027.526, "learn_throughput": 13.212, "update_time_ms": 218.619}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.23193073272705, "grad_norm": 28.55905532836914, "td_error_abs": 1.9084851582845053, "q_taken_mean": 3.6529271443684896, "target_mean": 3.1707305908203125}}}, "num_steps_sampled": 121000, "num_agent_steps_sampled": 121000, "num_steps_trained": 121000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 120640, "num_target_updates": 232}, "done": false, "episodes_total": 12100, "training_iteration": 121, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-22-51", "timestamp": 1648905771, "time_this_iter_s": 102.68251013755798, "time_total_s": 10623.60471868515, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10623.60471868515, "timesteps_since_restore": 4840, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 22.27310344827586, "ram_util_percent": 92.13034482758621}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 18.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7190354702640824, "mean_inference_ms": 53.46479061130523, "mean_action_processing_ms": 0.22322837807953086, "mean_env_wait_ms": 0.16040861956397293, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 122000, "timesteps_this_iter": 40, "agent_timesteps_total": 122000, "timers": {"sample_time_ms": 3978.828, "sample_throughput": 10.053, "learn_time_ms": 2959.23, "learn_throughput": 13.517, "update_time_ms": 246.679}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.134105205535889, "grad_norm": 24.787891387939453, "td_error_abs": 1.671127700805664, "q_taken_mean": 3.4176656087239583, "target_mean": 3.6109934488932294}}}, "num_steps_sampled": 122000, "num_agent_steps_sampled": 122000, "num_steps_trained": 122000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 121680, "num_target_updates": 234}, "done": false, "episodes_total": 12200, "training_iteration": 122, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-24-32", "timestamp": 1648905872, "time_this_iter_s": 100.14166116714478, "time_total_s": 10723.746379852295, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10723.746379852295, "timesteps_since_restore": 4880, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 22.342553191489362, "ram_util_percent": 91.74964539007092}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 20.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7192153340800789, "mean_inference_ms": 53.47702360041552, "mean_action_processing_ms": 0.22329143545754826, "mean_env_wait_ms": 0.1604531955759311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 123000, "timesteps_this_iter": 40, "agent_timesteps_total": 123000, "timers": {"sample_time_ms": 4154.765, "sample_throughput": 9.628, "learn_time_ms": 3060.244, "learn_throughput": 13.071, "update_time_ms": 270.826}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.112285614013672, "grad_norm": 12.638378143310547, "td_error_abs": 1.8275590260823569, "q_taken_mean": 3.2006991068522135, "target_mean": 3.0948974609375}}}, "num_steps_sampled": 123000, "num_agent_steps_sampled": 123000, "num_steps_trained": 123000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 122720, "num_target_updates": 236}, "done": false, "episodes_total": 12300, "training_iteration": 123, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-26-15", "timestamp": 1648905975, "time_this_iter_s": 102.84285616874695, "time_total_s": 10826.589236021042, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10826.589236021042, "timesteps_since_restore": 4920, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 22.29794520547945, "ram_util_percent": 91.44109589041096}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 20.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 40.0, 30.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 10.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.71906768707709, "mean_inference_ms": 53.46788543219922, "mean_action_processing_ms": 0.22325618686739396, "mean_env_wait_ms": 0.16046446149016438, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 124000, "timesteps_this_iter": 40, "agent_timesteps_total": 124000, "timers": {"sample_time_ms": 4052.429, "sample_throughput": 9.871, "learn_time_ms": 3070.502, "learn_throughput": 13.027, "update_time_ms": 262.092}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.263727188110352, "grad_norm": 19.616140365600586, "td_error_abs": 1.8577266693115235, "q_taken_mean": 2.015326182047526, "target_mean": 2.3652664184570313}}}, "num_steps_sampled": 124000, "num_agent_steps_sampled": 124000, "num_steps_trained": 124000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 123760, "num_target_updates": 238}, "done": false, "episodes_total": 12400, "training_iteration": 124, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-27-58", "timestamp": 1648906078, "time_this_iter_s": 101.73678302764893, "time_total_s": 10928.32601904869, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 10928.32601904869, "timesteps_since_restore": 4960, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 21.985416666666666, "ram_util_percent": 90.85347222222222}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 21.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 30.0, 10.0, 20.0, 20.0, 10.0, 20.0, 30.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7191902637283331, "mean_inference_ms": 53.46895057652833, "mean_action_processing_ms": 0.22331950630265382, "mean_env_wait_ms": 0.16050343742210704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 125000, "timesteps_this_iter": 40, "agent_timesteps_total": 125000, "timers": {"sample_time_ms": 4011.454, "sample_throughput": 9.971, "learn_time_ms": 3022.091, "learn_throughput": 13.236, "update_time_ms": 242.969}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.212952136993408, "grad_norm": 8.788182258605957, "td_error_abs": 1.7279524485270181, "q_taken_mean": 1.828259785970052, "target_mean": 1.7979390462239584}}}, "num_steps_sampled": 125000, "num_agent_steps_sampled": 125000, "num_steps_trained": 125000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 124800, "num_target_updates": 240}, "done": false, "episodes_total": 12500, "training_iteration": 125, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-29-39", "timestamp": 1648906179, "time_this_iter_s": 100.41968894004822, "time_total_s": 11028.745707988739, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11028.745707988739, "timesteps_since_restore": 5000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 22.35211267605634, "ram_util_percent": 91.75985915492959}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 20.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7195372149466047, "mean_inference_ms": 53.495166878909004, "mean_action_processing_ms": 0.22341004402189957, "mean_env_wait_ms": 0.16058719308409386, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 126000, "timesteps_this_iter": 40, "agent_timesteps_total": 126000, "timers": {"sample_time_ms": 4239.533, "sample_throughput": 9.435, "learn_time_ms": 3132.437, "learn_throughput": 12.77, "update_time_ms": 247.122}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.418618202209473, "grad_norm": 16.68646812438965, "td_error_abs": 1.9657450358072917, "q_taken_mean": 2.4509198506673178, "target_mean": 2.6618555704752604}}}, "num_steps_sampled": 126000, "num_agent_steps_sampled": 126000, "num_steps_trained": 126000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 125840, "num_target_updates": 242}, "done": false, "episodes_total": 12600, "training_iteration": 126, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-31-25", "timestamp": 1648906285, "time_this_iter_s": 105.5735924243927, "time_total_s": 11134.319300413132, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11134.319300413132, "timesteps_since_restore": 5040, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 22.262666666666668, "ram_util_percent": 91.32200000000002}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 19.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7199172631822677, "mean_inference_ms": 53.53103062174744, "mean_action_processing_ms": 0.2235387735323869, "mean_env_wait_ms": 0.16073943355853815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 127000, "timesteps_this_iter": 40, "agent_timesteps_total": 127000, "timers": {"sample_time_ms": 4222.675, "sample_throughput": 9.473, "learn_time_ms": 3140.701, "learn_throughput": 12.736, "update_time_ms": 243.698}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.24759292602539, "grad_norm": 13.616137504577637, "td_error_abs": 1.9470315297444662, "q_taken_mean": 2.5268163045247394, "target_mean": 2.5770769755045575}}}, "num_steps_sampled": 127000, "num_agent_steps_sampled": 127000, "num_steps_trained": 127000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 126880, "num_target_updates": 244}, "done": false, "episodes_total": 12700, "training_iteration": 127, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-33-12", "timestamp": 1648906392, "time_this_iter_s": 106.87919354438782, "time_total_s": 11241.19849395752, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11241.19849395752, "timesteps_since_restore": 5080, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 22.804635761589406, "ram_util_percent": 91.41655629139072}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 21.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 10.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7202755432233806, "mean_inference_ms": 53.55826794052529, "mean_action_processing_ms": 0.22366284497108072, "mean_env_wait_ms": 0.16082015239739064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 128000, "timesteps_this_iter": 40, "agent_timesteps_total": 128000, "timers": {"sample_time_ms": 4267.352, "sample_throughput": 9.373, "learn_time_ms": 3197.802, "learn_throughput": 12.509, "update_time_ms": 245.168}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.625072002410889, "grad_norm": 12.708794593811035, "td_error_abs": 1.4246097564697267, "q_taken_mean": 3.1524943033854167, "target_mean": 3.1678263346354165}}}, "num_steps_sampled": 128000, "num_agent_steps_sampled": 128000, "num_steps_trained": 128000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 127920, "num_target_updates": 246}, "done": false, "episodes_total": 12800, "training_iteration": 128, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-35-01", "timestamp": 1648906501, "time_this_iter_s": 108.40187525749207, "time_total_s": 11349.600369215012, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11349.600369215012, "timesteps_since_restore": 5120, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 22.369536423841062, "ram_util_percent": 91.76622516556291}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 21.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 30.0, 30.0, 40.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.72051999306576, "mean_inference_ms": 53.58515979190165, "mean_action_processing_ms": 0.223746895143248, "mean_env_wait_ms": 0.16086730863588847, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 129000, "timesteps_this_iter": 40, "agent_timesteps_total": 129000, "timers": {"sample_time_ms": 4159.136, "sample_throughput": 9.617, "learn_time_ms": 3079.717, "learn_throughput": 12.988, "update_time_ms": 267.481}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.820241451263428, "grad_norm": 15.93005657196045, "td_error_abs": 1.6241678873697916, "q_taken_mean": 1.7457785288492838, "target_mean": 1.673484166463216}}}, "num_steps_sampled": 129000, "num_agent_steps_sampled": 129000, "num_steps_trained": 129000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 128960, "num_target_updates": 248}, "done": false, "episodes_total": 12900, "training_iteration": 129, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-36-47", "timestamp": 1648906607, "time_this_iter_s": 105.83963298797607, "time_total_s": 11455.440002202988, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11455.440002202988, "timesteps_since_restore": 5160, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 22.35066666666667, "ram_util_percent": 91.86066666666666}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 19.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7206699007573687, "mean_inference_ms": 53.5958317227629, "mean_action_processing_ms": 0.2237803983466815, "mean_env_wait_ms": 0.16092811561409118, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 130000, "timesteps_this_iter": 40, "agent_timesteps_total": 130000, "timers": {"sample_time_ms": 3959.641, "sample_throughput": 10.102, "learn_time_ms": 2966.774, "learn_throughput": 13.483, "update_time_ms": 224.558}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.1917009353637695, "grad_norm": 13.198660850524902, "td_error_abs": 1.738711420694987, "q_taken_mean": 1.8276626586914062, "target_mean": 2.0172139485677083}}}, "num_steps_sampled": 130000, "num_agent_steps_sampled": 130000, "num_steps_trained": 130000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 130000, "num_target_updates": 250}, "done": false, "episodes_total": 13000, "training_iteration": 130, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-38-29", "timestamp": 1648906709, "time_this_iter_s": 100.62326407432556, "time_total_s": 11556.063266277313, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11556.063266277313, "timesteps_since_restore": 5200, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 22.38951048951049, "ram_util_percent": 91.3972027972028}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 20.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7206334135506244, "mean_inference_ms": 53.59216867077496, "mean_action_processing_ms": 0.22377364999672636, "mean_env_wait_ms": 0.16092319553460624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 131000, "timesteps_this_iter": 40, "agent_timesteps_total": 131000, "timers": {"sample_time_ms": 3969.486, "sample_throughput": 10.077, "learn_time_ms": 2974.513, "learn_throughput": 13.448, "update_time_ms": 231.365}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.664000511169434, "grad_norm": 11.349396705627441, "td_error_abs": 1.9822021484375, "q_taken_mean": 2.180516306559245, "target_mean": 2.1866541544596356}}}, "num_steps_sampled": 131000, "num_agent_steps_sampled": 131000, "num_steps_trained": 131000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 130520, "num_target_updates": 251}, "done": false, "episodes_total": 13100, "training_iteration": 131, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-40-08", "timestamp": 1648906808, "time_this_iter_s": 98.44536805152893, "time_total_s": 11654.508634328842, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11654.508634328842, "timesteps_since_restore": 5240, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 22.094285714285714, "ram_util_percent": 91.03428571428572}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 18.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7205965688656951, "mean_inference_ms": 53.59033754437529, "mean_action_processing_ms": 0.22375127777273462, "mean_env_wait_ms": 0.16091613385761214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 132000, "timesteps_this_iter": 40, "agent_timesteps_total": 132000, "timers": {"sample_time_ms": 3927.01, "sample_throughput": 10.186, "learn_time_ms": 2902.834, "learn_throughput": 13.78, "update_time_ms": 261.321}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 8.66994857788086, "grad_norm": 17.82267189025879, "td_error_abs": 2.0688500722249348, "q_taken_mean": 2.1282296498616535, "target_mean": 2.1196292877197265}}}, "num_steps_sampled": 132000, "num_agent_steps_sampled": 132000, "num_steps_trained": 132000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 131560, "num_target_updates": 253}, "done": false, "episodes_total": 13200, "training_iteration": 132, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-41-47", "timestamp": 1648906907, "time_this_iter_s": 98.81692004203796, "time_total_s": 11753.32555437088, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11753.32555437088, "timesteps_since_restore": 5280, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 22.132142857142856, "ram_util_percent": 91.11357142857142}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 19.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7205948048521887, "mean_inference_ms": 53.58876716405488, "mean_action_processing_ms": 0.22374602756028153, "mean_env_wait_ms": 0.16091830611913704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 133000, "timesteps_this_iter": 40, "agent_timesteps_total": 133000, "timers": {"sample_time_ms": 3991.3, "sample_throughput": 10.022, "learn_time_ms": 2976.052, "learn_throughput": 13.441, "update_time_ms": 230.243}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.108168601989746, "grad_norm": 13.901789665222168, "td_error_abs": 1.975344975789388, "q_taken_mean": 3.663434600830078, "target_mean": 3.716835784912109}}}, "num_steps_sampled": 133000, "num_agent_steps_sampled": 133000, "num_steps_trained": 133000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 132600, "num_target_updates": 255}, "done": false, "episodes_total": 13300, "training_iteration": 133, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-43-27", "timestamp": 1648907007, "time_this_iter_s": 99.03423881530762, "time_total_s": 11852.359793186188, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11852.359793186188, "timesteps_since_restore": 5320, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 21.90709219858156, "ram_util_percent": 90.5936170212766}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 19.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.720509731685228, "mean_inference_ms": 53.57906972538916, "mean_action_processing_ms": 0.2237100312398166, "mean_env_wait_ms": 0.16091333275812605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 134000, "timesteps_this_iter": 40, "agent_timesteps_total": 134000, "timers": {"sample_time_ms": 3913.183, "sample_throughput": 10.222, "learn_time_ms": 2954.53, "learn_throughput": 13.539, "update_time_ms": 189.508}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.21681022644043, "grad_norm": 12.322338104248047, "td_error_abs": 1.3422648111979167, "q_taken_mean": 2.2689997355143228, "target_mean": 2.353374989827474}}}, "num_steps_sampled": 134000, "num_agent_steps_sampled": 134000, "num_steps_trained": 134000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 133640, "num_target_updates": 257}, "done": false, "episodes_total": 13400, "training_iteration": 134, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-45-07", "timestamp": 1648907107, "time_this_iter_s": 99.56011438369751, "time_total_s": 11951.919907569885, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 11951.919907569885, "timesteps_since_restore": 5360, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 21.988652482269504, "ram_util_percent": 90.56312056737588}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 20.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.720433745785878, "mean_inference_ms": 53.579111245256975, "mean_action_processing_ms": 0.2236889064274895, "mean_env_wait_ms": 0.16092433953743676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 135000, "timesteps_this_iter": 40, "agent_timesteps_total": 135000, "timers": {"sample_time_ms": 4014.697, "sample_throughput": 9.963, "learn_time_ms": 3025.774, "learn_throughput": 13.22, "update_time_ms": 218.749}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.350732803344727, "grad_norm": 17.618223190307617, "td_error_abs": 1.2823979695638021, "q_taken_mean": 2.6586331685384113, "target_mean": 2.751133982340495}}}, "num_steps_sampled": 135000, "num_agent_steps_sampled": 135000, "num_steps_trained": 135000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 134680, "num_target_updates": 259}, "done": false, "episodes_total": 13500, "training_iteration": 135, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-46-48", "timestamp": 1648907208, "time_this_iter_s": 100.47264671325684, "time_total_s": 12052.392554283142, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12052.392554283142, "timesteps_since_restore": 5400, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 22.21398601398601, "ram_util_percent": 90.83286713286714}}
{"episode_reward_max": 30.0, "episode_reward_min": -10.0, "episode_reward_mean": 23.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, -10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 10.0, 10.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7204910133983147, "mean_inference_ms": 53.57586997582112, "mean_action_processing_ms": 0.2236745346364181, "mean_env_wait_ms": 0.16092792692852284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 136000, "timesteps_this_iter": 40, "agent_timesteps_total": 136000, "timers": {"sample_time_ms": 4053.875, "sample_throughput": 9.867, "learn_time_ms": 3034.897, "learn_throughput": 13.18, "update_time_ms": 222.772}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 5.476065158843994, "grad_norm": 14.263494491577148, "td_error_abs": 1.3653142293294271, "q_taken_mean": 2.383063252766927, "target_mean": 2.3649864196777344}}}, "num_steps_sampled": 136000, "num_agent_steps_sampled": 136000, "num_steps_trained": 136000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 135720, "num_target_updates": 261}, "done": false, "episodes_total": 13600, "training_iteration": 136, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-48-30", "timestamp": 1648907310, "time_this_iter_s": 101.69348073005676, "time_total_s": 12154.086035013199, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12154.086035013199, "timesteps_since_restore": 5440, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 21.945833333333333, "ram_util_percent": 90.75833333333334}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 21.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 0.0, 30.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 10.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7205385959380551, "mean_inference_ms": 53.58459927670912, "mean_action_processing_ms": 0.22370121064233012, "mean_env_wait_ms": 0.16096108589919683, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 137000, "timesteps_this_iter": 40, "agent_timesteps_total": 137000, "timers": {"sample_time_ms": 4034.226, "sample_throughput": 9.915, "learn_time_ms": 3010.741, "learn_throughput": 13.286, "update_time_ms": 207.921}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.19191312789917, "grad_norm": 16.573942184448242, "td_error_abs": 1.5987588246663411, "q_taken_mean": 2.3265103658040363, "target_mean": 2.587982432047526}}}, "num_steps_sampled": 137000, "num_agent_steps_sampled": 137000, "num_steps_trained": 137000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 136760, "num_target_updates": 263}, "done": false, "episodes_total": 13700, "training_iteration": 137, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-50-12", "timestamp": 1648907412, "time_this_iter_s": 101.45595526695251, "time_total_s": 12255.541990280151, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12255.541990280151, "timesteps_since_restore": 5480, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 22.725517241379308, "ram_util_percent": 90.89586206896553}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 21.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7205559206659876, "mean_inference_ms": 53.58849353940381, "mean_action_processing_ms": 0.22370061136073638, "mean_env_wait_ms": 0.16098561167651326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 138000, "timesteps_this_iter": 40, "agent_timesteps_total": 138000, "timers": {"sample_time_ms": 4024.428, "sample_throughput": 9.939, "learn_time_ms": 3020.9, "learn_throughput": 13.241, "update_time_ms": 220.646}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.658395290374756, "grad_norm": 15.597121238708496, "td_error_abs": 1.759088134765625, "q_taken_mean": 2.3692596435546873, "target_mean": 2.1819725036621094}}}, "num_steps_sampled": 138000, "num_agent_steps_sampled": 138000, "num_steps_trained": 138000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 137800, "num_target_updates": 265}, "done": false, "episodes_total": 13800, "training_iteration": 138, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-51-53", "timestamp": 1648907513, "time_this_iter_s": 100.74310207366943, "time_total_s": 12356.28509235382, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12356.28509235382, "timesteps_since_restore": 5520, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 22.546478873239437, "ram_util_percent": 90.79647887323944}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 21.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 10.0, 30.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 30.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7207421003556118, "mean_inference_ms": 53.608888881826914, "mean_action_processing_ms": 0.22375877804147065, "mean_env_wait_ms": 0.16106309446443678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 139000, "timesteps_this_iter": 40, "agent_timesteps_total": 139000, "timers": {"sample_time_ms": 4237.152, "sample_throughput": 9.44, "learn_time_ms": 3211.447, "learn_throughput": 12.455, "update_time_ms": 210.405}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.19177770614624, "grad_norm": 21.29824447631836, "td_error_abs": 1.7913116455078124, "q_taken_mean": 2.8680463155110676, "target_mean": 2.632008361816406}}}, "num_steps_sampled": 139000, "num_agent_steps_sampled": 139000, "num_steps_trained": 139000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 138840, "num_target_updates": 267}, "done": false, "episodes_total": 13900, "training_iteration": 139, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-53-38", "timestamp": 1648907618, "time_this_iter_s": 103.8682906627655, "time_total_s": 12460.153383016586, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12460.153383016586, "timesteps_since_restore": 5560, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 22.774324324324322, "ram_util_percent": 91.20878378378379}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 24.2, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 10.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 30.0, 10.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 10.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7209832547531855, "mean_inference_ms": 53.63171974940522, "mean_action_processing_ms": 0.22381741313749587, "mean_env_wait_ms": 0.16112100709857566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 140000, "timesteps_this_iter": 40, "agent_timesteps_total": 140000, "timers": {"sample_time_ms": 4181.031, "sample_throughput": 9.567, "learn_time_ms": 3160.591, "learn_throughput": 12.656, "update_time_ms": 206.107}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.99313497543335, "grad_norm": 13.306098937988281, "td_error_abs": 1.3781920115152995, "q_taken_mean": 2.823340098063151, "target_mean": 2.8946812947591147}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 140000, "num_steps_trained": 140000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 139880, "num_target_updates": 269}, "done": false, "episodes_total": 14000, "training_iteration": 140, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-55-24", "timestamp": 1648907724, "time_this_iter_s": 105.87746119499207, "time_total_s": 12566.030844211578, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12566.030844211578, "timesteps_since_restore": 5600, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 21.919999999999998, "ram_util_percent": 91.388}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 20.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7212645283645174, "mean_inference_ms": 53.65636829707524, "mean_action_processing_ms": 0.22388672626446982, "mean_env_wait_ms": 0.16120311463221754, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 141000, "timesteps_this_iter": 40, "agent_timesteps_total": 141000, "timers": {"sample_time_ms": 4167.401, "sample_throughput": 9.598, "learn_time_ms": 3143.698, "learn_throughput": 12.724, "update_time_ms": 236.302}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.43025016784668, "grad_norm": 26.808162689208984, "td_error_abs": 2.15228754679362, "q_taken_mean": 3.4121678670247397, "target_mean": 3.1726943969726564}}}, "num_steps_sampled": 141000, "num_agent_steps_sampled": 141000, "num_steps_trained": 141000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 140920, "num_target_updates": 271}, "done": false, "episodes_total": 14100, "training_iteration": 141, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-57-10", "timestamp": 1648907830, "time_this_iter_s": 105.73088002204895, "time_total_s": 12671.761724233627, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12671.761724233627, "timesteps_since_restore": 5640, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 22.669536423841063, "ram_util_percent": 91.69271523178807}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 27.3, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7214523638434107, "mean_inference_ms": 53.674975961588636, "mean_action_processing_ms": 0.22394428595412386, "mean_env_wait_ms": 0.16127508501446297, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 142000, "timesteps_this_iter": 40, "agent_timesteps_total": 142000, "timers": {"sample_time_ms": 4227.02, "sample_throughput": 9.463, "learn_time_ms": 3181.379, "learn_throughput": 12.573, "update_time_ms": 227.982}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.825727939605713, "grad_norm": 16.286937713623047, "td_error_abs": 1.8489163716634114, "q_taken_mean": 2.542846171061198, "target_mean": 2.662328084309896}}}, "num_steps_sampled": 142000, "num_agent_steps_sampled": 142000, "num_steps_trained": 142000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 141960, "num_target_updates": 273}, "done": false, "episodes_total": 14200, "training_iteration": 142, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_06-58-57", "timestamp": 1648907937, "time_this_iter_s": 106.16441750526428, "time_total_s": 12777.926141738892, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12777.926141738892, "timesteps_since_restore": 5680, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 22.428476821192053, "ram_util_percent": 91.63443708609272}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 26.6, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 40.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 30.0, 0.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 20.0, 30.0, 20.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7216639826972718, "mean_inference_ms": 53.69481946274249, "mean_action_processing_ms": 0.22403892979002082, "mean_env_wait_ms": 0.16133107391058232, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 143000, "timesteps_this_iter": 40, "agent_timesteps_total": 143000, "timers": {"sample_time_ms": 4220.934, "sample_throughput": 9.477, "learn_time_ms": 3182.391, "learn_throughput": 12.569, "update_time_ms": 216.568}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.570446014404297, "grad_norm": 20.72823715209961, "td_error_abs": 2.4652755737304686, "q_taken_mean": 4.494691975911459, "target_mean": 4.357184346516927}}}, "num_steps_sampled": 143000, "num_agent_steps_sampled": 143000, "num_steps_trained": 143000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 143000, "num_target_updates": 275}, "done": false, "episodes_total": 14300, "training_iteration": 143, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_07-00-44", "timestamp": 1648908044, "time_this_iter_s": 105.94070363044739, "time_total_s": 12883.866845369339, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12883.866845369339, "timesteps_since_restore": 5720, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 22.362913907284767, "ram_util_percent": 91.50596026490066}}
{"episode_reward_max": 40.0, "episode_reward_min": 0.0, "episode_reward_mean": 26.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 20.0, 30.0, 10.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 0.0, 30.0, 40.0, 30.0, 10.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 0.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7219094027579118, "mean_inference_ms": 53.713234551187796, "mean_action_processing_ms": 0.22412866642897591, "mean_env_wait_ms": 0.16140447073898553, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 144000, "timesteps_this_iter": 40, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 4205.857, "sample_throughput": 9.511, "learn_time_ms": 3151.647, "learn_throughput": 12.692, "update_time_ms": 237.517}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.280617713928223, "grad_norm": 26.143388748168945, "td_error_abs": 1.312384033203125, "q_taken_mean": 2.4974820454915365, "target_mean": 1.9614078521728515}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 144000, "num_steps_trained": 144000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 143520, "num_target_updates": 276}, "done": false, "episodes_total": 14400, "training_iteration": 144, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_07-02-30", "timestamp": 1648908150, "time_this_iter_s": 105.86229658126831, "time_total_s": 12989.729141950607, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 12989.729141950607, "timesteps_since_restore": 5760, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 22.486666666666668, "ram_util_percent": 91.37133333333334}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 27.1, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 20.0, 40.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7218664236579877, "mean_inference_ms": 53.72142146062576, "mean_action_processing_ms": 0.22417042838179196, "mean_env_wait_ms": 0.16142505569617957, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 145000, "timesteps_this_iter": 40, "agent_timesteps_total": 145000, "timers": {"sample_time_ms": 4113.665, "sample_throughput": 9.724, "learn_time_ms": 3106.414, "learn_throughput": 12.877, "update_time_ms": 233.72}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 6.52880334854126, "grad_norm": 18.18838119506836, "td_error_abs": 1.6283849080403645, "q_taken_mean": 3.5391387939453125, "target_mean": 3.327528381347656}}}, "num_steps_sampled": 145000, "num_agent_steps_sampled": 145000, "num_steps_trained": 145000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 144560, "num_target_updates": 278}, "done": false, "episodes_total": 14500, "training_iteration": 145, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_07-04-14", "timestamp": 1648908254, "time_this_iter_s": 103.43942451477051, "time_total_s": 13093.168566465378, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13093.168566465378, "timesteps_since_restore": 5800, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 22.612162162162157, "ram_util_percent": 91.40270270270271}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 26.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 30.0, 10.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 10.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 0.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7221240128057599, "mean_inference_ms": 53.741186219552944, "mean_action_processing_ms": 0.22426466168333362, "mean_env_wait_ms": 0.16150143939414574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 146000, "timesteps_this_iter": 40, "agent_timesteps_total": 146000, "timers": {"sample_time_ms": 4273.506, "sample_throughput": 9.36, "learn_time_ms": 3218.829, "learn_throughput": 12.427, "update_time_ms": 212.817}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 9.15517807006836, "grad_norm": 16.8292179107666, "td_error_abs": 2.017973454793294, "q_taken_mean": 3.1631459554036456, "target_mean": 3.3573628743489583}}}, "num_steps_sampled": 146000, "num_agent_steps_sampled": 146000, "num_steps_trained": 146000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 145600, "num_target_updates": 280}, "done": false, "episodes_total": 14600, "training_iteration": 146, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_07-06-00", "timestamp": 1648908360, "time_this_iter_s": 105.42067742347717, "time_total_s": 13198.589243888855, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13198.589243888855, "timesteps_since_restore": 5840, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 22.490666666666666, "ram_util_percent": 91.67333333333333}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 26.7, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 10.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 10.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 20.0, 30.0, 10.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.722216917885842, "mean_inference_ms": 53.74931531394763, "mean_action_processing_ms": 0.22430574938390127, "mean_env_wait_ms": 0.16153902395226147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 147000, "timesteps_this_iter": 40, "agent_timesteps_total": 147000, "timers": {"sample_time_ms": 4152.72, "sample_throughput": 9.632, "learn_time_ms": 3130.103, "learn_throughput": 12.779, "update_time_ms": 218.363}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 7.804481506347656, "grad_norm": 13.460000991821289, "td_error_abs": 1.851300557454427, "q_taken_mean": 2.80277837117513, "target_mean": 3.031218973795573}}}, "num_steps_sampled": 147000, "num_agent_steps_sampled": 147000, "num_steps_trained": 147000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 146640, "num_target_updates": 282}, "done": false, "episodes_total": 14700, "training_iteration": 147, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_07-07-45", "timestamp": 1648908465, "time_this_iter_s": 104.18943572044373, "time_total_s": 13302.778679609299, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13302.778679609299, "timesteps_since_restore": 5880, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 22.168456375838925, "ram_util_percent": 91.96241610738257}}
{"episode_reward_max": 40.0, "episode_reward_min": 10.0, "episode_reward_mean": 26.8, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 40.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 10.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7224354269452937, "mean_inference_ms": 53.76591069586024, "mean_action_processing_ms": 0.22440378267904662, "mean_env_wait_ms": 0.16161693836823626, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 148000, "timesteps_this_iter": 40, "agent_timesteps_total": 148000, "timers": {"sample_time_ms": 4297.038, "sample_throughput": 9.309, "learn_time_ms": 3211.897, "learn_throughput": 12.454, "update_time_ms": 229.089}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 4.087677001953125, "grad_norm": 12.374336242675781, "td_error_abs": 1.2124403635660808, "q_taken_mean": 2.9157869974772135, "target_mean": 2.827203877766927}}}, "num_steps_sampled": 148000, "num_agent_steps_sampled": 148000, "num_steps_trained": 148000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 147680, "num_target_updates": 284}, "done": false, "episodes_total": 14800, "training_iteration": 148, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_07-09-32", "timestamp": 1648908572, "time_this_iter_s": 106.17940473556519, "time_total_s": 13408.958084344864, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13408.958084344864, "timesteps_since_restore": 5920, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 22.372368421052634, "ram_util_percent": 92.09868421052632}}
{"episode_reward_max": 30.0, "episode_reward_min": 10.0, "episode_reward_mean": 27.0, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.722642681050859, "mean_inference_ms": 53.78073555828407, "mean_action_processing_ms": 0.22447095141692824, "mean_env_wait_ms": 0.16166432867536343, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 149000, "timesteps_this_iter": 40, "agent_timesteps_total": 149000, "timers": {"sample_time_ms": 4216.742, "sample_throughput": 9.486, "learn_time_ms": 3182.467, "learn_throughput": 12.569, "update_time_ms": 212.41}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 10.922913551330566, "grad_norm": 20.92270851135254, "td_error_abs": 2.237340799967448, "q_taken_mean": 3.176373291015625, "target_mean": 3.5587315877278645}}}, "num_steps_sampled": 149000, "num_agent_steps_sampled": 149000, "num_steps_trained": 149000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 148720, "num_target_updates": 286}, "done": false, "episodes_total": 14900, "training_iteration": 149, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_07-11-17", "timestamp": 1648908677, "time_this_iter_s": 105.19746017456055, "time_total_s": 13514.155544519424, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13514.155544519424, "timesteps_since_restore": 5960, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 22.019463087248326, "ram_util_percent": 92.4288590604027}}
{"episode_reward_max": 30.0, "episode_reward_min": 0.0, "episode_reward_mean": 26.5, "episode_len_mean": 10.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 10.0, 30.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 30.0, 30.0, 30.0, 10.0, 20.0, 0.0, 30.0, 30.0, 30.0, 30.0, 20.0], "episode_lengths": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7228387463541338, "mean_inference_ms": 53.799302318071305, "mean_action_processing_ms": 0.22453349582837617, "mean_env_wait_ms": 0.16171304051937926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 150000, "timesteps_this_iter": 40, "agent_timesteps_total": 150000, "timers": {"sample_time_ms": 4312.963, "sample_throughput": 9.274, "learn_time_ms": 3237.503, "learn_throughput": 12.355, "update_time_ms": 279.286}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 11.96719741821289, "grad_norm": 23.433490753173828, "td_error_abs": 2.500792948404948, "q_taken_mean": 3.920574188232422, "target_mean": 4.285862731933594}}}, "num_steps_sampled": 150000, "num_agent_steps_sampled": 150000, "num_steps_trained": 150000, "num_steps_trained_this_iter": 40, "last_target_update_ts": 149760, "num_target_updates": 288}, "done": true, "episodes_total": 15000, "training_iteration": 150, "trial_id": "1ae99_00000", "experiment_id": "8a8309fca8534f08b7a1b5813e397be5", "date": "2022-04-02_07-13-05", "timestamp": 1648908785, "time_this_iter_s": 107.1796224117279, "time_total_s": 13621.335166931152, "pid": 1253, "hostname": "1d29a0c222c3", "node_ip": "172.17.0.2", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 3000, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_foodenv", "observation_space": null, "action_space": null, "env_config": {"agents": [0, 1, 2], "food_loc": {"food1": [3, 3], "food2": [5, 5], "food3": [8, 6], "food4": [1, 5], "food5": [9, 2], "food6": [4, 9], "food7": [8, 3]}, "agent_loc": {"0": [4, 4], "1": [6, 8], "2": [9, 4]}, "board_size": [10, 10], "mode": "comp", "time_limit": 10, "trainer": "ppo"}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.025, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.qmix.qmix_policy.QMixTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": 1, "collect_metrics_timeout": -1, "mixer": "qmix", "mixing_embed_dim": 800, "double_q": true, "target_network_update_freq": 500, "buffer_size": 8000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 5, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 13621.335166931152, "timesteps_since_restore": 6000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 22.74473684210526, "ram_util_percent": 92.7375}}
